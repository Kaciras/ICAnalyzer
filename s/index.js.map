{"version":3,"file":"s/index.js","mappings":"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","sources":["webpack://ic-analyzer/./web/ui/CheckBoxBase.scss?74ff","webpack://ic-analyzer/./web/ui/CheckBoxBase.tsx","webpack://ic-analyzer/./web/ui/Slider.scss?d0e6","webpack://ic-analyzer/./web/ui/Slider.tsx","webpack://ic-analyzer/./web/ui/Button.scss?25b3","webpack://ic-analyzer/./web/ui/Button.tsx","webpack://ic-analyzer/./web/ui/DownloadButton.tsx","webpack://ic-analyzer/./web/ui/NumberInput.scss?cd3b","webpack://ic-analyzer/./web/ui/NumberInput.tsx","webpack://ic-analyzer/./web/ui/Dialog.scss?9f63","webpack://ic-analyzer/./web/ui/Dialog.tsx","webpack://ic-analyzer/./web/utils.ts","webpack://ic-analyzer/./web/ui/PinchZoom.tsx","webpack://ic-analyzer/./web/ui/SelectBox.scss?50dd","webpack://ic-analyzer/./web/ui/SelectBox.tsx","webpack://ic-analyzer/./web/ui/SwitchButton.scss?5dc0","webpack://ic-analyzer/./web/ui/SwitchButton.tsx","webpack://ic-analyzer/./web/ui/FileDrop.scss?15b9","webpack://ic-analyzer/./web/i18n.ts","webpack://ic-analyzer/./web/ui/FileDrop.tsx","webpack://ic-analyzer/./web/ui/ColorPicker.scss?a042","webpack://ic-analyzer/./web/ui/ColorPicker.tsx","webpack://ic-analyzer/./web/ui/TabList.tsx","webpack://ic-analyzer/./web/ui/TabSwitch.tsx","webpack://ic-analyzer/./web/ui/RadioGroup.tsx","webpack://ic-analyzer/./web/ui/ZoomControl.scss?1504","webpack://ic-analyzer/./web/ui/ZoomControl.tsx","webpack://ic-analyzer/./web/ui/index.ts","webpack://ic-analyzer/./web/form/control/SwitchControl.scss?c9ce","webpack://ic-analyzer/./web/form/control/SwitchControl.tsx","webpack://ic-analyzer/./web/form/option/BoolOption.scss?4365","webpack://ic-analyzer/./web/form/option/BoolOption.tsx","webpack://ic-analyzer/./web/form/control/EnumControl.scss?8ddf","webpack://ic-analyzer/./web/form/control/EnumControl.tsx","webpack://ic-analyzer/./web/form/option/EnumOption.scss?32be","webpack://ic-analyzer/./web/form/option/EnumOption.tsx","webpack://ic-analyzer/./web/form/NumberField.scss?ba08","webpack://ic-analyzer/./web/form/NumberField.tsx","webpack://ic-analyzer/./web/form/control/RangeControl.tsx","webpack://ic-analyzer/./web/form/option/NumberOption.scss?806f","webpack://ic-analyzer/./web/form/option/NumberOption.tsx","webpack://ic-analyzer/./deps/squoosh/src/features/worker-utils/index.ts","webpack://ic-analyzer/./web/codecs/common.ts","webpack://ic-analyzer/./web/codecs/mozjpeg/codec.ts","webpack://ic-analyzer/./web/codecs/mozjpeg/client.ts","webpack://ic-analyzer/./deps/squoosh/src/features/encoders/jxl/shared/meta.ts","webpack://ic-analyzer/./web/codecs/jxl/codec.ts","webpack://ic-analyzer/./web/codecs/jxl/client.ts","webpack://ic-analyzer/./deps/squoosh/src/features/encoders/webP/shared/meta.ts","webpack://ic-analyzer/./web/codecs/webp/codec.ts","webpack://ic-analyzer/./web/codecs/webp/client.ts","webpack://ic-analyzer/./web/codecs/avif/codec.ts","webpack://ic-analyzer/./web/codecs/avif/client.ts","webpack://ic-analyzer/./web/codecs/webp2/codec.ts","webpack://ic-analyzer/./web/codecs/webp2/client.ts","webpack://ic-analyzer/./web/codecs/index.ts","webpack://ic-analyzer/./deps/squoosh/src/client/lazy-app/util/index.ts","webpack://ic-analyzer/./web/features/WorkerPool.ts","webpack://ic-analyzer/./web/features/image-worker.ts","webpack://ic-analyzer/./web/features/decode.ts","webpack://ic-analyzer/./deps/squoosh/src/client/lazy-app/util/canvas.ts","webpack://ic-analyzer/./web/features/measurement.ts","webpack://ic-analyzer/./web/hooks.ts","webpack://ic-analyzer/./web/app/SelectFileDialog.scss?edff","webpack://ic-analyzer/./web/app/SelectFileDialog.tsx","webpack://ic-analyzer/./web/app/ImageInfoPanel.scss?95d8","webpack://ic-analyzer/./web/app/ImageInfoPanel.tsx","webpack://ic-analyzer/./lib/similarity.ts","webpack://ic-analyzer/./web/app/MeasurePanel.scss?2abf","webpack://ic-analyzer/./web/app/MeasurePanel.tsx","webpack://ic-analyzer/./web/app/EncoderPanel.scss?afa6","webpack://ic-analyzer/./web/form/OptionsForm.scss?c648","webpack://ic-analyzer/./web/form/OptionsForm.tsx","webpack://ic-analyzer/./web/app/EncoderPanel.tsx","webpack://ic-analyzer/./web/app/CompressConfigDialog.scss?19cc","webpack://ic-analyzer/./web/app/CompressConfigDialog.tsx","webpack://ic-analyzer/./web/app/ProgressDialog.scss?79fd","webpack://ic-analyzer/./web/app/ProgressDialog.tsx","webpack://ic-analyzer/./web/app/CompressSession.tsx","webpack://ic-analyzer/./web/app/IntroPage.scss?a4e0","webpack://ic-analyzer/./web/app/IntroPage.tsx","webpack://ic-analyzer/./web/theme.module.scss?1be7","webpack://ic-analyzer/./web/app/ImageView.scss?7664","webpack://ic-analyzer/./web/app/ImageView.tsx","webpack://ic-analyzer/./web/app/ChartPanel.scss?d499","webpack://ic-analyzer/./web/app/ChartPanel.tsx","webpack://ic-analyzer/./web/app/ControlPanel.scss?e496","webpack://ic-analyzer/./web/app/ControlPanel.tsx","webpack://ic-analyzer/./web/app/AnalyzePage.scss?cdab","webpack://ic-analyzer/./web/app/AnalyzePage.tsx","webpack://ic-analyzer/./web/app/CompareFileDialog.scss?8f4a","webpack://ic-analyzer/./web/app/CompareFileDialog.tsx","webpack://ic-analyzer/./web/app/CompareConfigDialog.tsx","webpack://ic-analyzer/./web/app/CompareSession.tsx","webpack://ic-analyzer/./web/app/index.tsx","webpack://ic-analyzer/./web/index.tsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"container\":\"FgknC\",\"disabled\":\"G1q09\",\"input\":\"XUHPc\",\"mark\":\"KpkgA\",\"label\":\"BwVxe\"};","import { noop } from \"@kaciras/utilities/browser\";\nimport { ChangeEvent, ChangeEventHandler, Dispatch, MouseEventHandler, ReactNode } from \"react\";\nimport clsx from \"clsx\";\nimport { SVGComponent } from \"../utils.ts\";\nimport styles from \"./CheckBoxBase.scss\";\n\nexport interface CheckBoxProps {\n\tchecked?: boolean;\n\tclassName?: string;\n\tname?: string;\n\tdisabled?: boolean;\n\n\t// The value of the component. The DOM API casts this to a string.\n\tvalue?: unknown;\n\n\t/**\n\t * If the checked state changed, this handler will be called with the value prop.\n\t */\n\tonSelected?: Dispatch<unknown>;\n\n\tonCheckedChange?: Dispatch<boolean>;\n\n\tonClick?: MouseEventHandler;\n\tonChange?: ChangeEventHandler<HTMLInputElement>;\n\n\tchildren?: ReactNode;\n}\n\ninterface InternalProps extends CheckBoxProps {\n\ttype: string;\n\tIcon: SVGComponent;\n\tIconChecked: SVGComponent;\n}\n\nexport default function CheckBoxBase(props: InternalProps) {\n\tconst {\n\t\tclassName, type, Icon, IconChecked, name, value, checked, disabled,\n\t\tonClick, onSelected = noop, onChange = noop, onCheckedChange = noop, children,\n\t} = props;\n\n\tfunction handleChange(e: ChangeEvent<HTMLInputElement>) {\n\t\tconst { checked } = e.currentTarget;\n\t\tif (checked) {\n\t\t\tonSelected(value);\n\t\t}\n\t\tonChange(e);\n\t\tonCheckedChange(checked);\n\t}\n\n\tconst CheckMark = checked ? IconChecked : Icon;\n\n\tconst clazz = clsx(\n\t\tstyles.container,\n\t\tclassName,\n\t\tdisabled && styles.disabled,\n\t);\n\n\treturn (\n\t\t<label className={clazz} onClick={onClick}>\n\t\t\t<input\n\t\t\t\ttype={type}\n\t\t\t\tclassName={styles.input}\n\t\t\t\tname={name}\n\t\t\t\tvalue={value as string}\n\t\t\t\tdisabled={disabled}\n\t\t\t\tchecked={checked}\n\t\t\t\tonChange={handleChange}\n\t\t\t/>\n\t\t\t<CheckMark className={styles.mark}/>\n\t\t\t{\n\t\t\t\tchildren &&\n\t\t\t\t<span className={styles.label}>{children}</span>\n\t\t\t}\n\t\t</label>\n\t);\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"aVfJx\",\"disabled\":\"l3iqk\",\"thumbRegion\":\"P2PLz\",\"thumb\":\"rdlcx\",\"input\":\"Niqmg\"};","import { noop } from \"@kaciras/utilities/browser\";\nimport { ChangeEvent, ChangeEventHandler, CSSProperties, Dispatch, MouseEventHandler } from \"react\";\nimport clsx from \"clsx\";\nimport styles from \"./Slider.scss\";\n\nexport interface SliderProps {\n\tvalue: number;\n\tmin: number;\n\tmax: number;\n\tstep: number;\n\n\tclassName?: string;\n\tname?: string;\n\tdisabled?: boolean;\n\n\tonClick?: MouseEventHandler<HTMLInputElement>;\n\tonValueChange?: Dispatch<number>;\n\tonChange?: ChangeEventHandler<HTMLInputElement>;\n}\n\ninterface RangeInputCSS extends CSSProperties {\n\t\"--value-percent\": string;\n}\n\nexport default function Slider(props: SliderProps) {\n\tconst {\n\t\tclassName, name, value, min, max, step, disabled,\n\t\tonClick, onChange = noop, onValueChange = noop,\n\t} = props;\n\n\tconst percent = (value - min) / (max - min);\n\tconst cssVariables: RangeInputCSS = {\n\t\t\"--value-percent\": `${percent * 100}%`,\n\t};\n\n\tfunction handleChange(e: ChangeEvent<HTMLInputElement>) {\n\t\tonChange(e);\n\t\tonValueChange(e.currentTarget.valueAsNumber);\n\t}\n\n\tconst clazz = clsx(\n\t\tstyles.container,\n\t\tclassName,\n\t\tdisabled && styles.disabled,\n\t);\n\n\treturn (\n\t\t<div className={clazz} style={cssVariables}>\n\t\t\t<input\n\t\t\t\ttype=\"range\"\n\t\t\t\tclassName={styles.input}\n\t\t\t\tname={name}\n\t\t\t\tdisabled={disabled}\n\t\t\t\tvalue={value}\n\t\t\t\tmin={min}\n\t\t\t\tmax={max}\n\t\t\t\tstep={step}\n\t\t\t\tonClick={onClick}\n\t\t\t\tonChange={handleChange}\n\t\t\t/>\n\t\t\t<div className={styles.thumbRegion}>\n\t\t\t\t<div className={styles.thumb}/>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"base\":\"IG6_k\",\"text\":\"qZ052 IG6_k\",\"active\":\"fGZHk\",\"button\":\"sNw0y IG6_k\",\"outline\":\"l9Gvg sNw0y IG6_k\",\"busy\":\"Jt9Fm\"};","import { ComponentProps } from \"react\";\nimport clsx from \"clsx\";\nimport styles from \"./Button.scss\";\n\nexport interface ButtonProps extends Omit<ComponentProps<\"button\">, \"type\"> {\n\t/**\n\t * The basic style of the button, default is \"button\".\n\t *\n\t * @default \"button\"\n\t */\n\ttype?: \"button\" | \"text\" | \"outline\";\n\n\t/**\n\t * Apply the active style to the button?\n\t *\n\t * @default false\n\t */\n\tactive?: boolean;\n\n\t/**\n\t * If set, will render an anchor element with href attribute.\n\t */\n\thref?: string;\n}\n\nexport default function Button(props: ButtonProps) {\n\tconst { type = \"button\", href, active, className, children, ...rest } = props;\n\tconst nativeProps = rest as any;\n\tconst ButtonTag = href ? \"a\" : \"button\";\n\n\tnativeProps.className = clsx(\n\t\tstyles[type],\n\t\tclassName,\n\t\tactive && styles.active,\n\t);\n\tnativeProps.type = href ? undefined : \"button\";\n\n\treturn <ButtonTag {...nativeProps} href={href}>{children}</ButtonTag>;\n}\n","import { useEffect, useRef } from \"react\";\nimport Button, { ButtonProps } from \"./Button.tsx\";\n\nexport interface DownloadButtonProps extends ButtonProps {\n\tfile: File;\n}\n\nexport default function DownloadButton(props: DownloadButtonProps) {\n\tconst { file, children, ...others } = props;\n\n\tconst url = useRef(\"\");\n\n\tuseEffect(() => () => URL.revokeObjectURL(url.current), []);\n\n\tfunction handleClick() {\n\t\tURL.revokeObjectURL(url.current);\n\t\tconst newUrl = URL.createObjectURL(file);\n\t\turl.current = newUrl;\n\n\t\tconst a = document.createElement(\"a\");\n\t\ta.href = newUrl;\n\t\ta.download = file.name;\n\n\t\ta.click(); // It seems no need to mount to document.\n\t}\n\n\treturn <Button {...others} onClick={handleClick}>{children}</Button>;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"T36jt\",\"input\":\"oeBOT no-spinner\",\"button\":\"toS6H\"};","import { noop } from \"@kaciras/utilities/browser\";\nimport React, { ChangeEvent, ChangeEventHandler, Dispatch, MouseEvent, useRef } from \"react\";\nimport clsx from \"clsx\";\nimport { TbArrowDown, TbArrowUp, TbMinus, TbPlus } from \"react-icons/tb\";\nimport styles from \"./NumberInput.scss\";\n\n/**\n * When click and hold on a button - the delay before auto changing the value.\n */\nconst UPDATE_DELAY = 400;\n\n/**\n * When click and hold on a button - the speed of auto changing the value.\n */\nconst UPDATE_SPEED = 50;\n\n/**\n * Get the number of decimal places.\n */\nfunction getPrecision(value: number) {\n\tconst s = value.toString();\n\tconst d = s.indexOf(\".\") + 1;\n\treturn d || s.length - d;\n}\n\nexport interface NumberInputProps {\n\tvalue?: number;\n\tmin?: number;\n\tmax?: number;\n\tstep?: number;\n\n\t/**\n\t * Set the stepping when using buttons to adjust the value,\n\t * The difference with the step is that it is not used for validation.\n\t *\n\t * @default same as step\n\t */\n\tincrement?: number;\n\n\t/**\n\t * Should add buttons to quickly set value to minimum / maximum.\n\t */\n\tminMaxButton?: boolean;\n\n\t/**\n\t * Set the id attribute for input element.\n\t */\n\tinputId?: string;\n\n\ttitle?: string;\n\tname?: string;\n\tclassName?: string;\n\tdisabled?: boolean;\n\n\t/**\n\t * Equivalent to onChange(e => onValueChange(e.currentTarget.valueAsNumber))\n\t */\n\tonValueChange?: Dispatch<number>;\n\n\tonChange?: ChangeEventHandler<HTMLInputElement>;\n}\n\nfunction NumberInput(props: NumberInputProps) {\n\tconst {\n\t\tinputId,\n\t\ttitle,\n\t\tname,\n\t\tclassName,\n\t\tdisabled,\n\t\tminMaxButton,\n\t\tvalue,\n\t\tmin = 0,\n\t\tmax = Number.MAX_SAFE_INTEGER,\n\t\tstep = 1,\n\t\tincrement = step,\n\t\tonChange = noop,\n\t\tonValueChange = noop,\n\t} = props;\n\n\t/**\n\t * NumberInput hides browser default spinners and use custom buttons to adjust value,\n\t * to support the onChange event, we dispatch input event from the native element.\n\t */\n\tconst inputRef = useRef<HTMLInputElement>(null);\n\n\tfunction updateValue(value: number) {\n\t\tconst input = inputRef.current!;\n\t\tinput.valueAsNumber = value;\n\t\tinput.dispatchEvent(new Event(\"input\", { bubbles: true, cancelable: true }));\n\t}\n\n\tfunction handlePointerDown(event: MouseEvent, diff: number) {\n\t\tif (event.button !== 0) {\n\t\t\treturn;\n\t\t}\n\t\tlet timer = 0;\n\t\tconst q = Math.pow(10, getPrecision(step));\n\n\t\t/** get the next value, resolve precision problem */\n\t\tfunction next(n: number) {\n\t\t\tn += diff;\n\t\t\tn = Math.min(Math.max(n, min), max);\n\t\t\treturn Math.round(n * q) / q;\n\t\t}\n\n\t\tfunction increment(current: number) {\n\t\t\tconst newValue = next(current);\n\t\t\tupdateValue(newValue);\n\t\t\ttimer = window.setTimeout(() => increment(newValue), UPDATE_SPEED);\n\t\t}\n\n\t\tfunction onPointerUp() {\n\t\t\tclearTimeout(timer);\n\t\t\tdocument.removeEventListener(\"mouseup\", onPointerUp);\n\t\t}\n\n\t\tconst newValue = next(inputRef.current!.valueAsNumber);\n\t\tupdateValue(newValue);\n\t\ttimer = window.setTimeout(() => increment(newValue), UPDATE_DELAY);\n\t\tdocument.addEventListener(\"mouseup\", onPointerUp);\n\t}\n\n\tfunction handleChange(event: ChangeEvent<HTMLInputElement>) {\n\t\tonChange(event);\n\t\tonValueChange(event.currentTarget.valueAsNumber);\n\t}\n\n\treturn (\n\t\t<div title={title} className={clsx(styles.container, className)}>\n\t\t\t{\n\t\t\t\tminMaxButton &&\n\t\t\t\t<button\n\t\t\t\t\ttitle=\"Min\"\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tclassName={styles.button}\n\t\t\t\t\ttabIndex={-1}\n\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\tonClick={() => updateValue(min)}\n\t\t\t\t>\n\t\t\t\t\t<TbArrowDown/>\n\t\t\t\t</button>\n\t\t\t}\n\t\t\t<button\n\t\t\t\ttitle=\"Decrease\"\n\t\t\t\ttype=\"button\"\n\t\t\t\tclassName={styles.button}\n\t\t\t\ttabIndex={-1}\n\t\t\t\tdisabled={disabled}\n\t\t\t\tonPointerDown={e => handlePointerDown(e, -increment)}\n\t\t\t>\n\t\t\t\t<TbMinus shapeRendering=\"crispEdges\"/>\n\t\t\t</button>\n\t\t\t<input\n\t\t\t\ttype=\"number\"\n\t\t\t\tid={inputId}\n\t\t\t\tref={inputRef}\n\t\t\t\tclassName={styles.input}\n\t\t\t\tdisabled={disabled}\n\t\t\t\tname={name}\n\t\t\t\tmin={min}\n\t\t\t\tmax={max}\n\t\t\t\tstep={step}\n\t\t\t\tvalue={value}\n\t\t\t\tonChange={handleChange}\n\t\t\t/>\n\t\t\t<button\n\t\t\t\ttitle=\"Increase\"\n\t\t\t\ttype=\"button\"\n\t\t\t\tclassName={styles.button}\n\t\t\t\ttabIndex={-1}\n\t\t\t\tdisabled={disabled}\n\t\t\t\tonPointerDown={e => handlePointerDown(e, increment)}\n\t\t\t>\n\t\t\t\t<TbPlus shapeRendering=\"crispEdges\"/>\n\t\t\t</button>\n\t\t\t{\n\t\t\t\tminMaxButton &&\n\t\t\t\t<button\n\t\t\t\t\ttitle=\"Max\"\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tclassName={styles.button}\n\t\t\t\t\ttabIndex={-1}\n\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\tonClick={() => updateValue(max)}\n\t\t\t\t>\n\t\t\t\t\t<TbArrowUp/>\n\t\t\t\t</button>\n\t\t\t}\n\t\t</div>\n\t);\n}\n\nexport default React.memo(NumberInput);\n","// extracted by mini-css-extract-plugin\nexport default {\"dimmer\":\"XhhBO\",\"dialog\":\"eGPu3\"};","import { ReactNode, useEffect } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport clsx from \"clsx\";\nimport styles from \"./Dialog.scss\";\n\ninterface DialogProps {\n\tclassName?: string;\n\tname?: string;\n\tchildren: ReactNode;\n\tonClose?: () => void;\n}\n\nexport default function Dialog(props: DialogProps) {\n\tconst { className, name, onClose, children } = props;\n\n\tfunction handleKeyUp(event: KeyboardEvent) {\n\t\tif (event.key === \"Escape\") {\n\t\t\tonClose?.();\n\t\t\tevent.stopImmediatePropagation();\n\t\t}\n\t}\n\n\tfunction listenKeyboardClose() {\n\t\twindow.addEventListener(\"keydown\", handleKeyUp);\n\t\treturn () => window.removeEventListener(\"keydown\", handleKeyUp);\n\t}\n\n\tuseEffect(listenKeyboardClose, [onClose]);\n\n\tconst reactNode = (\n\t\t<div className={styles.dimmer}>\n\t\t\t<div\n\t\t\t\trole=\"dialog\"\n\t\t\t\taria-label={name}\n\t\t\t\tclassName={clsx(styles.dialog, className)}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</div>\n\t\t</div>\n\t);\n\n\treturn createPortal(reactNode, document.body);\n}\n","import React, { ComponentType, SVGProps } from \"react\";\n\nexport type SVGComponent = ComponentType<SVGProps<SVGSVGElement>>;\n\nexport const stopPropagation = (e: MouseEvent | React.MouseEvent) => e.stopPropagation();\n\nexport function drawImage(data: ImageData, el: HTMLCanvasElement | null) {\n\tif (el === null) {\n\t\treturn;\n\t}\n\tconst ctx = el.getContext(\"2d\");\n\tif (ctx) {\n\t\tctx.putImageData(data, 0, 0);\n\t} else {\n\t\tthrow new Error(\"Canvas not initialized\");\n\t}\n}\n\ntype PointerMoveHandler = (e: PointerEvent, init: PointerEvent) => void;\n\nexport function dragHandler(listener: PointerMoveHandler) {\n\treturn function (initEvent: React.PointerEvent) {\n\t\tif (initEvent.button !== 0) {\n\t\t\treturn;\n\t\t}\n\t\tconst { nativeEvent } = initEvent;\n\n\t\t// Avoid dragging underlying elements.\n\t\tinitEvent.preventDefault();\n\n\t\tfunction handleMove(event: PointerEvent) {\n\t\t\tlistener(event, nativeEvent);\n\t\t}\n\n\t\tfunction handleEnd(event: Event) {\n\t\t\tevent.preventDefault();\n\t\t\tdocument.removeEventListener(\"pointerup\", handleEnd);\n\t\t\tdocument.removeEventListener(\"pointermove\", handleMove);\n\t\t}\n\n\t\tdocument.addEventListener(\"pointerup\", handleEnd);\n\t\tdocument.addEventListener(\"pointermove\", handleMove);\n\t};\n}\n","import React, { Dispatch, ReactNode } from \"react\";\nimport { dragHandler } from \"../utils.ts\";\n\nexport interface PinchZoomState {\n\tx: number;\n\ty: number;\n\tscale: number;\n}\n\nexport interface PinchZoomProps {\n\tstate: PinchZoomState;\n\tclassName?: string;\n\tchildren: ReactNode;\n\tonChange: Dispatch<PinchZoomState>;\n}\n\nexport default function PinchZoom(props: PinchZoomProps) {\n\tconst { state, className, children, onChange } = props;\n\n\tfunction handleWheel(event: React.WheelEvent) {\n\t\tconst { ctrlKey, deltaMode, clientX, clientY } = event;\n\t\tlet { deltaY } = event;\n\n\t\tevent.preventDefault();\n\n\t\t// 1 is \"lines\", 0 is \"pixels\"\n\t\tif (deltaMode === 1) {\n\t\t\tdeltaY *= 15;\n\t\t}\n\n\t\t// ctrlKey is true when pinch-zooming on a trackpad.\n\t\tconst divisor = ctrlKey ? 100 : 300;\n\t\tconst scaleDiff = 1 - deltaY / divisor;\n\n\t\tconst rect = event.currentTarget.firstElementChild!.getBoundingClientRect();\n\t\tconst dx = ((rect.left + rect.width / 2) - clientX) * (scaleDiff - 1);\n\t\tconst dy = ((rect.top + rect.height / 2) - clientY) * (scaleDiff - 1);\n\n\t\tonChange({\n\t\t\tx: state.x + dx,\n\t\t\ty: state.y + dy,\n\t\t\tscale: state.scale * scaleDiff,\n\t\t});\n\t}\n\n\tconst handlePointerDown = dragHandler((event, init) => {\n\t\tconst { pageX, pageY } = event;\n\t\tconst { pageX: initX, pageY: initY } = init;\n\n\t\tconst x = state.x + pageX - initX;\n\t\tconst y = state.y + pageY - initY;\n\t\tonChange({ scale: state.scale, x, y });\n\t});\n\n\treturn (\n\t\t<div\n\t\t\tstyle={{ touchAction: \"none\" }}\n\t\t\tclassName={className}\n\t\t\tonWheel={handleWheel}\n\t\t\tonPointerDown={handlePointerDown}\n\t\t>\n\t\t\t{children}\n\t\t</div>\n\t);\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"nY79E\",\"select\":\"epIiv\",\"icon\":\"DyuSV\"};","import { noop } from \"@kaciras/utilities/browser\";\nimport { ChangeEvent, ComponentProps, Dispatch } from \"react\";\nimport { BsFillCaretDownFill } from \"react-icons/bs\";\nimport styles from \"./SelectBox.scss\";\n\ninterface SelectBoxProps extends ComponentProps<\"select\"> {\n\tonValueChange: Dispatch<string>;\n}\n\nexport default function SelectBox(props: SelectBoxProps) {\n\tconst { onChange = noop, onValueChange, ...others } = props;\n\n\tfunction handleChange(e: ChangeEvent<HTMLSelectElement>) {\n\t\tonChange(e);\n\t\tonValueChange(e.currentTarget.value);\n\t}\n\n\treturn (\n\t\t<div className={styles.container}>\n\t\t\t<select\n\t\t\t\t{...others}\n\t\t\t\tclassName={styles.select}\n\t\t\t\tonChange={handleChange}\n\t\t\t/>\n\t\t\t<BsFillCaretDownFill className={styles.icon}/>\n\t\t</div>\n\t);\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"nHZES\",\"checked\":\"lQRCF\",\"disabled\":\"dHMC5\",\"input\":\"NEV5M\"};","import { noop } from \"@kaciras/utilities/browser\";\nimport { ChangeEvent } from \"react\";\nimport clsx from \"clsx\";\nimport { CheckBoxProps } from \"./CheckBoxBase.tsx\";\nimport styles from \"./SwitchButton.scss\";\n\nexport type SwitchButtonProps = Omit<CheckBoxProps, \"children\">;\n\nexport default function SwitchButton(props: SwitchButtonProps) {\n\tconst {\n\t\tclassName, name, value, checked, disabled,\n\t\tonClick, onChange = noop, onCheckedChange = noop, onSelected = noop,\n\t} = props;\n\n\tconst clazz = clsx(\n\t\tstyles.container,\n\t\tclassName,\n\t\tdisabled && styles.disabled,\n\t\tchecked && styles.checked,\n\t);\n\n\tfunction handleChange(e: ChangeEvent<HTMLInputElement>) {\n\t\tconst { checked } = e.currentTarget;\n\t\tif (checked) {\n\t\t\tonSelected(value);\n\t\t}\n\t\tonChange(e);\n\t\tonCheckedChange(checked);\n\t}\n\n\treturn (\n\t\t<label className={clazz}>\n\t\t\t<input\n\t\t\t\ttype=\"checkbox\"\n\t\t\t\tclassName={styles.input}\n\t\t\t\tdisabled={disabled}\n\t\t\t\tchecked={checked}\n\t\t\t\tname={name}\n\t\t\t\tvalue={value as string}\n\t\t\t\tonClick={onClick}\n\t\t\t\tonChange={handleChange}\n\t\t\t/>\n\t\t</label>\n\t);\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"fileDropBox\":\"wAUIr\",\"dragging\":\"xeCOC\",\"text\":\"F7KIv\",\"icon\":\"xYmpo F7KIv\",\"fileInput\":\"IvOsd\"};","const translations = {\n\ten: {\n\t\tICAnalyzerIntro: \"Online Image Compression & Analysis Tool\",\n\t\tSourceCode: \"Source Code\",\n\t\tBack: \"Back\",\n\t\tSelectFile: \"Select a file\",\n\t\tShowMetrics: \"Show metrics\",\n\t\tDownloadOutput: \"Download output image\",\n\t\tLockYAxis: \"Lock Y axis\",\n\t\tDownloadSVG: \"Download SVG image\",\n\t\tDownloadFullAxis: \"Download with full Axis\",\n\t\tMeasureOptions: \"Measure Options\",\n\t\tRemove: \"Remove\",\n\t\tAddAtLeast2Images: \"Add at least two images\",\n\t\tFirstIsTheOriginal: \"The first will be the original\",\n\t\tDndToReorder: \"Use drag & drop to change the order\",\n\t\tAnalysisConfig: \"Analysis config\",\n\t\tEncodeTimeSecond: \"Encode Time (s)\",\n\t\tCodec: \"Codec\",\n\t\tPreview: \"Preview\",\n\t\tFileName: \"File name\",\n\t\tFileType: \"File type\",\n\t\tResolution: \"Resolution\",\n\t\tRawSize: \"Raw size\",\n\t\tFileSizeAndRatio: \"File size (Ratio %)\",\n\t\tSplitView: \"Split\",\n\t\tInputView: \"Input\",\n\t\tOutputView: \"Output\",\n\t\tDiffView: \"Diff\",\n\t\tHeatMapView: \"HeatMap\",\n\t\tRequireButteraugli: \"Require enable butteraugli\",\n\t\tPickColor: \"Pick color\",\n\t\tBrightness: \"Brightness\",\n\t\tThreadCount: \"Thread count (more threads require more RAM)\",\n\t\tMeasureEncodeTime: \"Encode time (Not very accurate)\",\n\t\tMeasurePSNR: \"Peak signal-to-noise ratio (PSNR)\",\n\t\tMeasureSSIM: \"Structural similarity index measure (SSIM)\",\n\t\tEncoding: \"Encoding\",\n\t\tElapsedTime: \"Elapsed time\",\n\t\tCancel: \"Cancel\",\n\t\tError: \"Error\",\n\t\tOrTryOneOfThese: \"Or try one of these\",\n\t\tDropAFile: \"Drag & drop\",\n\t\tOrSelectFile: \"Or select a file\",\n\t\tZoomScale: \"Zoom scale\",\n\t\tResetPinchZoom: \"Reset pinch zoom\",\n\t\tInformation: \"Information\",\n\t\tEncoders: \"Encoders\",\n\t\tAnalysis: \"Analysis\",\n\t\tStart: \"Start\",\n\t},\n\tzh: {\n\t\tICAnalyzerIntro: \"在线的图片转码与分析工具\",\n\t\tSourceCode: \"开源仓库\",\n\t\tBack: \"返回\",\n\t\tSelectFile: \"选择文件\",\n\t\tShowMetrics: \"显示指标\",\n\t\tDownloadOutput: \"下载当前的输出图片\",\n\t\tLockYAxis: \"锁定 Y 轴\",\n\t\tDownloadSVG: \"保存为 SVG 图\",\n\t\tDownloadFullAxis: \"保存并显示所有 Y 轴\",\n\t\tMeasureOptions: \"测量选项\",\n\t\tRemove: \"移除\",\n\t\tAddAtLeast2Images: \"选择至少两张图片\",\n\t\tFirstIsTheOriginal: \"第一个将被视为原图\",\n\t\tDndToReorder: \"拖拽可以调整顺序\",\n\t\tAnalysisConfig: \"分析设置\",\n\t\tEncodeTimeSecond: \"转换用时 (秒)\",\n\t\tCodec: \"编码\",\n\t\tPreview: \"预览\",\n\t\tFileName: \"文件名\",\n\t\tFileType: \"文件类型\",\n\t\tResolution: \"分辨率\",\n\t\tRawSize: \"原始大小\",\n\t\tFileSizeAndRatio: \"大小（压缩率）\",\n\t\tSplitView: \"分割\",\n\t\tInputView: \"原图\",\n\t\tOutputView: \"输出\",\n\t\tDiffView: \"差分\",\n\t\tHeatMapView: \"HeatMap\",\n\t\tRequireButteraugli: \"需要启用 butteraugli\",\n\t\tPickColor: \"取色\",\n\t\tBrightness: \"亮度\",\n\t\tThreadCount: \"线程数（增加将占用更多内存）\",\n\t\tMeasureEncodeTime: \"转换时间（不是太准）\",\n\t\tMeasurePSNR: \"峰值信噪比 (PSNR)\",\n\t\tMeasureSSIM: \"结构相似度 (SSIM)\",\n\t\tEncoding: \"转码中\",\n\t\tElapsedTime: \"已经过时间\",\n\t\tCancel: \"取消\",\n\t\tError: \"错误\",\n\t\tOrTryOneOfThese: \"或者尝试以下的\",\n\t\tDropAFile: \"拖放文件\",\n\t\tOrSelectFile: \"或者点击选择\",\n\t\tZoomScale: \"缩放率\",\n\t\tResetPinchZoom: \"重置位置和缩放\",\n\t\tInformation: \"信息\",\n\t\tEncoders: \"转码器\",\n\t\tAnalysis: \"分析\",\n\t\tStart: \"开始\",\n\t},\n};\n\ntype LangCode = keyof typeof translations;\ntype Keys = keyof typeof translations.en;\n\nconst userLang = (localStorage.getItem(\"lang\") ?? navigator.language.split(\"-\", 2)[0]) as LangCode;\nconst resources = translations[userLang] ?? translations.en;\n\nexport function setLocale(code: string) {\n\tlocalStorage.setItem(\"lang\", code);\n}\n\nexport default function i18n(key: Keys) {\n\treturn resources[key];\n}\n","import { noop } from \"@kaciras/utilities/browser\";\nimport { ChangeEvent, Dispatch, DragEvent, useRef, useState } from \"react\";\nimport clsx from \"clsx\";\nimport { TbPhoto } from \"react-icons/tb\";\nimport styles from \"./FileDrop.scss\";\nimport i18n from \"../i18n.ts\";\n\n/**\n * Since dragenter & dragleave can be triggered on crossing children element boundary,\n * we count the number of entries and leaves to determine whether it is within the drag area.\n */\nfunction useBoundaryCounter() {\n\tconst [isInArea, setInArea] = useState(false);\n\tconst counter = useRef(0);\n\n\tfunction enter() {\n\t\tsetInArea(++counter.current > 0);\n\t}\n\n\tfunction leave() {\n\t\tsetInArea(--counter.current > 0);\n\t}\n\n\tfunction reset() {\n\t\tcounter.current = 0;\n\t\tsetInArea(false);\n\t}\n\n\treturn { isInArea, enter, leave, reset };\n}\n\nexport interface FileDropProps {\n\tclassName?: string;\n\taccept?: string;\n\tmultiple?: boolean;\n\n\tonSelectStart?: () => void;\n\tonChange: Dispatch<File[]>;\n\tonError: Dispatch<Error>;\n}\n\nexport default function FileDrop(props: FileDropProps) {\n\tconst { className, accept = \"*/*\", multiple, onSelectStart = noop, onChange, onError } = props;\n\n\tconst boundary = useBoundaryCounter();\n\tconst dragStarted = useRef(false);\n\n\tfunction handleFileChange(event: ChangeEvent<HTMLInputElement>) {\n\t\tconst { files } = event.currentTarget;\n\t\tif (files?.length) {\n\t\t\tonChange(Array.from(files));\n\t\t}\n\t}\n\n\tfunction handleDragEnter() {\n\t\tboundary.enter();\n\n\t\tfunction handleDragEnd() {\n\t\t\tdocument.removeEventListener(\"dragend\", handleDragEnd);\n\t\t\tdragStarted.current = false;\n\t\t}\n\n\t\tif (!dragStarted.current) {\n\t\t\tdragStarted.current = true;\n\t\t\tonSelectStart();\n\t\t\tdocument.addEventListener(\"dragend\", handleDragEnd);\n\t\t}\n\t}\n\n\tfunction handleDrop(event: DragEvent) {\n\t\tevent.preventDefault();\n\t\tboundary.reset();\n\n\t\tconst { items } = event.dataTransfer;\n\n\t\tconst files = Array.from(items).map(e => e.getAsFile()).filter(Boolean);\n\n\t\tif (files.length === items.length) {\n\t\t\tonChange(files as File[]);\n\t\t} else {\n\t\t\tonError(new Error(\"Non-file item in the dropped list\"));\n\t\t}\n\t}\n\n\tconst classes = clsx(\n\t\tstyles.fileDropBox,\n\t\tclassName,\n\t\t{ [styles.dragging]: boundary.isInArea },\n\t);\n\n\treturn (\n\t\t<label\n\t\t\tclassName={classes}\n\t\t\tonDragEnter={handleDragEnter}\n\t\t\tonDragOver={e => e.preventDefault()}\n\t\t\tonDrop={handleDrop}\n\t\t\tonDragLeave={boundary.leave}\n\t\t>\n\t\t\t<span>\n\t\t\t\t<TbPhoto className={styles.icon}/>\n\t\t\t\t<span className={styles.text}>\n\t\t\t\t\t{i18n(\"DropAFile\")}\n\t\t\t\t</span>\n\t\t\t</span>\n\t\t\t<span className={styles.text}>\n\t\t\t\t{i18n(\"OrSelectFile\")}\n\t\t\t</span>\n\t\t\t<input\n\t\t\t\tclassName={styles.fileInput}\n\t\t\t\tname=\"file\"\n\t\t\t\ttype=\"file\"\n\t\t\t\taccept={accept}\n\t\t\t\tmultiple={multiple}\n\t\t\t\tonClick={onSelectStart}\n\t\t\t\tonChange={handleFileChange}\n\t\t\t/>\n\t\t</label>\n\t);\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"CwtYo\",\"color\":\"l2eAF\"};","import { CSSProperties } from \"react\";\nimport styles from \"./ColorPicker.scss\";\n\n/**\n * Get the RGBA data at position in the image.\n *\n * @return the Uint8ClampedArray slice contains [R, G, B, A] values\n */\nfunction getPixel(image: ImageData, x: number, y: number) {\n\tconst { width, data } = image;\n\tconst i = (x + y * width) * 4;\n\treturn data.slice(i, i + 4);\n}\n\nfunction pad(n: string) {\n\treturn n.length < 2 ? \"0\" + n : n;\n}\n\n/**\n * Convert the pixel data to hex color string.\n *\n * @example\n * pixelToHex([50, 186, 52, 0.5]); // \"#32BA347F\"\n */\nfunction pixelToHex(pixel: Uint8ClampedArray) {\n\treturn pixel\n\t\t.reduce((s, n) => s + pad(n.toString(16)), \"#\")\n\t\t.toUpperCase();\n}\n\ninterface ColorItemProps {\n\tname: string;\n\tvalue: Uint8ClampedArray;\n}\n\nfunction ColorItem(props: ColorItemProps) {\n\tconst { name, value } = props;\n\tconst color = pixelToHex(value);\n\n\t// Remove the alpha channel for color tile\n\tconst style: any = {\n\t\t\"--color\": color.substring(0, 7),\n\t};\n\n\treturn <div className={styles.color} style={style}>{name}: {color}</div>;\n}\n\nexport interface ColorPickerProps {\n\tx: number;\n\ty: number;\n\timageA: ImageData;\n\timageB: ImageData;\n\tstyle?: CSSProperties;\n}\n\nexport default function ColorPicker(props: ColorPickerProps) {\n\tconst { style, x, y, imageA, imageB } = props;\n\n\tconst pixelA = getPixel(imageA, x, y);\n\tconst pixelB = getPixel(imageB, x, y);\n\tconst pixelDiff = pixelA.map((n, i) => Math.abs(n - pixelB[i]));\n\n\treturn (\n\t\t<div className={styles.container} style={style}>\n\t\t\t<div>x: {x}, y: {y}</div>\n\t\t\t<ColorItem name=\"Origin\" value={pixelA}/>\n\t\t\t<ColorItem name=\"Output\" value={pixelB}/>\n\t\t\t<ColorItem name=\"Diff\" value={pixelDiff}/>\n\t\t</div>\n\t);\n}\n","import { noop } from \"@kaciras/utilities/browser\";\nimport { Children, cloneElement, Dispatch, isValidElement, KeyboardEvent, ReactNode, useRef } from \"react\";\n\nexport interface TabListProps {\n\tclassName?: string;\n\tindex: number;\n\tonChange: Dispatch<number>;\n\tchildren: ReactNode;\n}\n\nexport default function TabList(props: TabListProps) {\n\tconst { className, index, onChange, children } = props;\n\n\t/**\n\t * To handle focus changing, we need to track elements.\n\t */\n\tconst localRef = useRef<HTMLElement[]>([]);\n\n\tconst tabButtons = Children.map(children, (child, i) => {\n\t\tif (!isValidElement(child)) {\n\t\t\treturn child;\n\t\t}\n\t\tconst { onClick = noop, ref = noop } = child.props;\n\t\tconst selected = i === index;\n\n\t\tfunction handleClick(event: MouseEvent) {\n\t\t\tonChange(i);\n\t\t\tonClick(event);\n\t\t}\n\n\t\tfunction callback(el: HTMLElement) {\n\t\t\tif (typeof ref !== \"object\") {\n\t\t\t\tref();\n\t\t\t} else if (ref) {\n\t\t\t\tref.current = el;\n\t\t\t}\n\t\t\tlocalRef.current[i] = el;\n\t\t}\n\n\t\tconst propsAddon = {\n\t\t\t\"aria-selected\": selected,\n\t\t\trole: \"tab\",\n\t\t\ttabIndex: selected ? 0 : -1,\n\t\t\tref: callback,\n\t\t\tonClick: handleClick,\n\t\t};\n\t\treturn cloneElement(child, propsAddon);\n\t});\n\n\tconst count = tabButtons!.length;\n\tlocalRef.current.length = count;\n\n\tfunction handleKeyDown(event: KeyboardEvent) {\n\t\tlet i = index;\n\n\t\tswitch (event.key) {\n\t\t\tcase \"Home\":\n\t\t\t\ti = 0;\n\t\t\t\tbreak;\n\t\t\tcase \"End\":\n\t\t\t\ti = count - 1;\n\t\t\t\tbreak;\n\t\t\tcase \"ArrowLeft\":\n\t\t\tcase \"ArrowUp\":\n\t\t\t\ti -= 1;\n\t\t\t\tbreak;\n\t\t\tcase \"ArrowRight\":\n\t\t\tcase \"ArrowDown\":\n\t\t\t\ti += 1;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn;\n\t\t}\n\n\t\tevent.preventDefault();\n\t\ti = (i + count) % count;\n\t\tonChange(i);\n\t\tlocalRef.current[i].focus();\n\t}\n\n\treturn (\n\t\t<div\n\t\t\tclassName={className}\n\t\t\trole=\"tablist\"\n\t\t\tonKeyDown={handleKeyDown}\n\t\t>\n\t\t\t{tabButtons}\n\t\t</div>\n\t);\n}\n","import { Children, cloneElement, Fragment, isValidElement, ReactNode } from \"react\";\n\nexport interface TabPanelBase {\n\t/**\n\t * Is this component the current tab panel.\n\t * If undefined, means the component is not controlled by TabList.\n\t */\n\tisActive?: boolean;\n}\n\nexport interface TabSwitchProps {\n\tindex: number;\n\tchildren: ReactNode;\n}\n\nexport default function TabSwitch(props: TabSwitchProps) {\n\tconst { index, children } = props;\n\n\tconst tabPanels = Children.map(children, (node, i) => {\n\t\tif (!isValidElement(node)) {\n\t\t\treturn node;\n\t\t}\n\t\treturn cloneElement<any>(node, { isActive: i === index });\n\t});\n\n\treturn <Fragment>{tabPanels}</Fragment>;\n}\n","import { Children, cloneElement, Dispatch, isValidElement, ReactNode } from \"react\";\n\nexport interface RadioGroupProps<T> {\n\tvalue: T;\n\n\tclassName?: string;\n\tname?: string;\n\tdisabled?: boolean;\n\n\tonChange: Dispatch<T>;\n\n\tchildren: ReactNode;\n}\n\nexport default function RadioGroup<T>(props: RadioGroupProps<T>) {\n\tconst { className, name, value, disabled, onChange, children } = props;\n\n\tconst radioBoxes = Children.map(children, child => {\n\t\tif (!isValidElement(child)) {\n\t\t\treturn child;\n\t\t}\n\t\tconst radioValue = child.props.value;\n\n\t\tconst propsAddon = {\n\t\t\tchecked: value === radioValue,\n\t\t\tname,\n\t\t\tdisabled,\n\t\t\tonSelected: onChange,\n\t\t};\n\t\treturn cloneElement(child, propsAddon);\n\t});\n\n\treturn <div className={className}>{radioBoxes}</div>;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"zoomInput\":\"YUkjD uy3Os\",\"button\":\"hGGMO\"};","import React from \"react\";\nimport { BsArrowCounterclockwise } from \"react-icons/bs\";\nimport i18n from \"../i18n.ts\";\nimport { PinchZoomState } from \"./PinchZoom.tsx\";\nimport { Button, NumberInput } from \"./index.ts\";\nimport styles from \"./ZoomControl.scss\";\nimport { Mutator } from \"../hooks.ts\";\n\nexport interface ZoomControlProps extends Omit<React.ComponentProps<\"div\">, \"onChange\" | \"defaultValue\"> {\n\tdefaultValue?: PinchZoomState;\n\tvalue: PinchZoomState;\n\tonChange: Mutator<PinchZoomState>;\n}\n\nfunction ZoomControl(props: ZoomControlProps) {\n\tconst { defaultValue, value, onChange, ...otherProps } = props;\n\n\tfunction setZoom(value: number) {\n\t\tonChange(prev => ({ ...prev, scale: value / 100 }));\n\t}\n\n\treturn (\n\t\t<div {...otherProps}>\n\t\t\t<NumberInput\n\t\t\t\ttitle={i18n(\"ZoomScale\")}\n\t\t\t\tmin={25}\n\t\t\t\tstep={1}\n\t\t\t\tincrement={25}\n\t\t\t\tclassName={styles.zoomInput}\n\t\t\t\tvalue={Math.round(value.scale * 100)}\n\t\t\t\tonValueChange={setZoom}\n\t\t\t/>\n\t\t\t{\n\t\t\t\tdefaultValue &&\n\t\t\t\t<Button\n\t\t\t\t\ttitle={i18n(\"ResetPinchZoom\")}\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tclassName={styles.button}\n\t\t\t\t\tonClick={() => onChange(defaultValue)}\n\t\t\t\t>\n\t\t\t\t\t<BsArrowCounterclockwise/>\n\t\t\t\t</Button>\n\t\t\t}\n\t\t</div>\n\t);\n}\n\nexport default React.memo(ZoomControl);\n","import { memo } from \"react\";\nimport {\n\tMdCheckBox,\n\tMdCheckBoxOutlineBlank,\n\tMdOutlineRadioButtonChecked,\n\tMdOutlineRadioButtonUnchecked,\n} from \"react-icons/md\";\nimport CheckBoxBase, { CheckBoxProps } from \"./CheckBoxBase.tsx\";\n\nexport const CheckBox = memo((props: CheckBoxProps) => {\n\treturn CheckBoxBase({\n\t\t...props,\n\t\ttype: \"checkbox\",\n\t\tIcon: MdCheckBoxOutlineBlank,\n\t\tIconChecked: MdCheckBox,\n\t});\n});\n\nexport const RadioBox = memo((props: CheckBoxProps) => {\n\treturn CheckBoxBase({\n\t\t...props,\n\t\ttype: \"radio\",\n\t\tIcon: MdOutlineRadioButtonUnchecked,\n\t\tIconChecked: MdOutlineRadioButtonChecked,\n\t});\n});\n\nCheckBox.displayName = \"CheckBox\";\nRadioBox.displayName = \"RadioBox\";\n\nexport { default as Slider } from \"./Slider.tsx\";\nexport { default as Button } from \"./Button.tsx\";\nexport { default as DownloadButton } from \"./DownloadButton.tsx\";\nexport { default as NumberInput } from \"./NumberInput.tsx\";\nexport { default as Dialog } from \"./Dialog.tsx\";\nexport { default as PinchZoom } from \"./PinchZoom.tsx\";\nexport { default as SelectBox } from \"./SelectBox.tsx\";\nexport { default as SwitchButton } from \"./SwitchButton.tsx\";\nexport { default as FileDrop } from \"./FileDrop.tsx\";\nexport { default as ColorPicker } from \"./ColorPicker.tsx\";\nexport { default as TabList } from \"./TabList.tsx\";\nexport { default as TabSwitch } from \"./TabSwitch.tsx\";\nexport { default as RadioGroup } from \"./RadioGroup.tsx\";\nexport { default as ZoomControl } from \"./ZoomControl.tsx\";\n","// extracted by mini-css-extract-plugin\nexport default {\"control\":\"oD1zK\"};","import type { ControlType, FieldProps } from \"../index.ts\";\nimport { SwitchButton } from \"../../ui/index.ts\";\nimport styles from \"./SwitchControl.scss\";\n\nexport interface SwitchControlConfig {\n\tid: string;\n\tlabel: string;\n}\n\nexport default class SwitchControl implements ControlType<boolean> {\n\n\treadonly id: string;\n\treadonly label: string;\n\n\tprivate readonly data: SwitchControlConfig;\n\n\tconstructor(data: SwitchControlConfig) {\n\t\tthis.data = data;\n\t\tthis.id = data.id;\n\t\tthis.label = data.label;\n\t\tthis.Input = this.Input.bind(this);\n\t}\n\n\tcreateState() {\n\t\treturn [false, true];\n\t}\n\n\tindexOf(value: boolean) {\n\t\treturn value ? 1 : 0;\n\t}\n\n\tInput(props: FieldProps<boolean>) {\n\t\tconst { value, onChange } = props;\n\t\tconst { label } = this.data;\n\n\t\treturn (\n\t\t\t<div className={styles.control}>\n\t\t\t\t{label}\n\t\t\t\t<SwitchButton\n\t\t\t\t\tchecked={value}\n\t\t\t\t\tonCheckedChange={onChange}\n\t\t\t\t\tonClick={e => e.stopPropagation()}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"label\":\"iXJnm\",\"container\":\"keW4D\"};","import { OptionFieldProps, OptionType } from \"../index.ts\";\nimport { SwitchButton } from \"../../ui/index.ts\";\nimport SwitchControl from \"../control/SwitchControl.tsx\";\nimport styles from \"./BoolOption.scss\";\n\nexport interface BoolVariableConfig {\n\tid: string;\n\tlabel: string;\n\tdefaultValue: boolean | number;\n}\n\nexport class BoolOption implements OptionType<boolean> {\n\n\tprivate readonly data: BoolVariableConfig;\n\n\tconstructor(data: BoolVariableConfig) {\n\t\tthis.data = data;\n\t\tthis.OptionField = this.OptionField.bind(this);\n\t}\n\n\tget id() {\n\t\treturn this.data.id;\n\t}\n\n\tcreateControl() {\n\t\treturn new SwitchControl(this.data);\n\t}\n\n\tcreateState() {\n\t\treturn [Boolean(this.data.defaultValue), undefined] as [boolean, never];\n\t}\n\n\tpopulate(value: boolean, options: any) {\n\t\toptions[this.data.id] = value;\n\t}\n\n\tOptionField(props: OptionFieldProps<boolean, any>) {\n\t\tconst { id, label } = this.data;\n\t\tconst { isVariable, value, onValueChange } = props;\n\n\t\treturn (\n\t\t\t<div className={styles.container}>\n\t\t\t\t<span className={styles.label}>\n\t\t\t\t\t{label}\n\t\t\t\t</span>\n\t\t\t\t{\n\t\t\t\t\tisVariable\n\t\t\t\t\t\t? <strong>OFF & ON</strong>\n\t\t\t\t\t\t: <SwitchButton\n\t\t\t\t\t\t\tname={id}\n\t\t\t\t\t\t\tchecked={value}\n\t\t\t\t\t\t\tonCheckedChange={onValueChange}\n\t\t\t\t\t\t/>\n\t\t\t\t}\n\t\t\t</div>\n\t\t);\n\t}\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"item\":\"we0Sh\"};","import type { ControlType, FieldProps } from \"../index.ts\";\nimport { RadioBox, RadioGroup } from \"../../ui/index.ts\";\nimport styles from \"./EnumControl.scss\";\n\ninterface ControlData {\n\tid: string;\n\tlabel: string;\n\tnames: string[];\n}\n\nexport default class EnumControl implements ControlType<string> {\n\n\treadonly id: string;\n\treadonly label: string;\n\n\tprivate readonly data: ControlData;\n\n\tconstructor(data: ControlData) {\n\t\tthis.data = data;\n\t\tthis.id = data.id;\n\t\tthis.label = data.label;\n\t\tthis.Input = this.Input.bind(this);\n\t}\n\n\tcreateState() {\n\t\treturn this.data.names;\n\t}\n\n\tindexOf(value: string): number {\n\t\treturn this.data.names.indexOf(value);\n\t}\n\n\tInput(props: FieldProps<string>) {\n\t\tconst { id, label, names } = this.data;\n\t\tconst { value, onChange } = props;\n\n\t\tconst radios = names.map(name =>\n\t\t\t<RadioBox\n\t\t\t\tkey={name}\n\t\t\t\tclassName={styles.item}\n\t\t\t\tvalue={name}\n\t\t\t>\n\t\t\t\t{name}\n\t\t\t</RadioBox>,\n\t\t);\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{label}\n\t\t\t\t<RadioGroup\n\t\t\t\t\tvalue={value}\n\t\t\t\t\tname={id}\n\t\t\t\t\tonChange={onChange}\n\t\t\t\t>\n\t\t\t\t\t{radios}\n\t\t\t\t</RadioGroup>\n\t\t\t</>\n\t\t);\n\t}\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"item\":\"CSeuH\",\"label\":\"QbADJ\"};","import { ChangeEvent } from \"react\";\nimport { OptionFieldProps, OptionType } from \"../index.ts\";\nimport { CheckBox, RadioBox } from \"../../ui/index.ts\";\nimport EnumControl from \"../control/EnumControl.tsx\";\nimport styles from \"./EnumOption.scss\";\n\nexport interface EnumOptionConfig<T extends Record<string, any>> {\n\tid: string;\n\tlabel: string;\n\tenumObject: T;\n\tdefaultValue: keyof T;\n}\n\nexport class EnumOption<T> implements OptionType<keyof T, Array<keyof T>> {\n\n\tprotected readonly data: EnumOptionConfig<T>;\n\n\tconstructor(data: EnumOptionConfig<T>) {\n\t\tthis.data = data;\n\t\tthis.OptionField = this.OptionField.bind(this);\n\t}\n\n\tget id() {\n\t\treturn this.data.id;\n\t}\n\n\tcreateControl(names: Array<keyof T>) {\n\t\tconst { id, label } = this.data;\n\t\treturn new EnumControl({ id, label, names: (names as string[]) });\n\t}\n\n\tcreateState() {\n\t\tconst { defaultValue } = this.data;\n\t\treturn [defaultValue, [defaultValue]] as [keyof T, Array<keyof T>];\n\t}\n\n\tpopulate(value: keyof T, options: any) {\n\t\toptions[this.data.id] = value;\n\t}\n\n\tOptionField(props: OptionFieldProps<keyof T, Array<keyof T>>) {\n\t\tconst { id, label, enumObject } = this.data;\n\t\tconst { isVariable, value, range, onValueChange, onRangeChange } = props;\n\n\t\tfunction handleChangeV(e: ChangeEvent<HTMLInputElement>) {\n\t\t\tconst { checked, name } = e.currentTarget;\n\t\t\tlet newVariables = [...range];\n\n\t\t\tif (checked) {\n\t\t\t\tnewVariables.push(name as any);\n\t\t\t} else {\n\t\t\t\tnewVariables = range.filter(v => v !== name);\n\t\t\t}\n\n\t\t\tif (newVariables.length > 0) {\n\t\t\t\tonRangeChange(newVariables);\n\t\t\t}\n\t\t}\n\n\t\tfunction handleChangeC(e: ChangeEvent<HTMLInputElement>) {\n\t\t\tonValueChange(e.currentTarget.value as keyof T);\n\t\t}\n\n\t\tlet items: any[];\n\t\tif (isVariable) {\n\t\t\titems = Object.keys(enumObject).map(name =>\n\t\t\t\t<CheckBox\n\t\t\t\t\tclassName={styles.item}\n\t\t\t\t\tkey={name}\n\t\t\t\t\tname={name}\n\t\t\t\t\tchecked={range.includes(name as any)}\n\t\t\t\t\tonChange={handleChangeV}\n\t\t\t\t>\n\t\t\t\t\t{name}\n\t\t\t\t</CheckBox>,\n\t\t\t);\n\t\t} else {\n\t\t\titems = Object.keys(enumObject).map(name =>\n\t\t\t\t<RadioBox\n\t\t\t\t\tclassName={styles.item}\n\t\t\t\t\tkey={name}\n\t\t\t\t\tname={id}\n\t\t\t\t\tvalue={name}\n\t\t\t\t\tchecked={value === name}\n\t\t\t\t\tonChange={handleChangeC}\n\t\t\t\t>\n\t\t\t\t\t{name}\n\t\t\t\t</RadioBox>,\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<div className={styles.fieldset}>\n\t\t\t\t<span className={styles.label}>\n\t\t\t\t\t{label}\n\t\t\t\t</span>\n\t\t\t\t<div className={styles.body}>{items}</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"header\":\"CO7Uq\",\"input\":\"N2Ak0 no-spinner\"};","import React, { ChangeEvent, Dispatch, ReactNode, useState } from \"react\";\nimport { Slider } from \"../ui/index.ts\";\nimport styles from \"./NumberField.scss\";\n\ninterface NumberFieldProps {\n\tvalue: number;\n\tmin: number;\n\tmax: number;\n\tstep: number;\n\n\tclassName?: string;\n\tname?: string;\n\tdisabled?: boolean;\n\n\tchildren?: ReactNode;\n\tonChange: Dispatch<number>;\n}\n\nfunction NumberField(props: NumberFieldProps) {\n\tconst {\n\t\tname, className, disabled,\n\t\tvalue, min, max, step, onChange, children,\n\t} = props;\n\n\tconst [tempValue, setTempValue] = useState(value);\n\n\tfunction handleRangeInput(newValue: number) {\n\t\tonChange(newValue);\n\t\tsetTempValue(newValue);\n\t}\n\n\tfunction handleNumberInput(event: ChangeEvent<HTMLInputElement>) {\n\t\tconst { target } = event;\n\t\tif (target.checkValidity()) {\n\t\t\tonChange(target.valueAsNumber);\n\t\t}\n\t\tsetTempValue(target.valueAsNumber);\n\t}\n\n\treturn (\n\t\t<div className={className}>\n\t\t\t<div className={styles.header}>\n\t\t\t\t{children}\n\t\t\t\t<input\n\t\t\t\t\tclassName={styles.input}\n\t\t\t\t\ttype=\"number\"\n\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\tmin={min}\n\t\t\t\t\tmax={max}\n\t\t\t\t\tstep={step}\n\t\t\t\t\tvalue={tempValue}\n\t\t\t\t\trequired={true}\n\t\t\t\t\tonChange={handleNumberInput}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<Slider\n\t\t\t\tname={name}\n\t\t\t\tdisabled={disabled}\n\t\t\t\tvalue={value}\n\t\t\t\tmin={min}\n\t\t\t\tmax={max}\n\t\t\t\tstep={step}\n\t\t\t\tonClick={e => e.stopPropagation()}\n\t\t\t\tonValueChange={handleRangeInput}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n\nexport default React.memo(NumberField);\n","import type { ControlType, FieldProps } from \"../index.ts\";\nimport NumberField from \"../NumberField.tsx\";\n\nexport interface NumberRange {\n\tmin: number;\n\tmax: number;\n\tstep: number;\n}\n\nexport function sequence(range: NumberRange) {\n\tconst { min, max, step } = range;\n\tconst length = Math.ceil((max + 1 - min) / step);\n\treturn Array.from({ length }, (_, i) => min + i * step);\n}\n\ninterface Metadata extends NumberRange {\n\tid: string;\n\tlabel: string;\n}\n\nexport default class RangeControl implements ControlType<number> {\n\n\treadonly id: string;\n\treadonly label: string;\n\n\tprivate readonly data: Metadata;\n\n\tconstructor(data: Metadata) {\n\t\tthis.data = data;\n\t\tthis.id = data.id;\n\t\tthis.label = data.label;\n\t\tthis.Input = this.Input.bind(this);\n\t}\n\n\tcreateState() {\n\t\treturn sequence(this.data);\n\t}\n\n\tInput(props: FieldProps<number>) {\n\t\tconst { id, label, min, max, step } = this.data;\n\t\tconst { value, onChange } = props;\n\n\t\treturn (\n\t\t\t<NumberField\n\t\t\t\tname={id}\n\t\t\t\tvalue={value}\n\t\t\t\tmin={min}\n\t\t\t\tmax={max}\n\t\t\t\tstep={step}\n\t\t\t\tonChange={onChange}\n\t\t\t>\n\t\t\t\t{label}\n\t\t\t</NumberField>\n\t\t);\n\t}\n\n\tindexOf(value: number): number {\n\t\tconst { min, step } = this.data;\n\t\treturn (value - min) / step;\n\t}\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"spinner\":\"I1I0s\",\"numberInput\":\"NfnaI\",\"controls\":\"aigYG\",\"legend\":\"mOTK3\"};","import { Dispatch } from \"react\";\nimport { OptionFieldProps, OptionType } from \"../index.ts\";\nimport { NumberInput } from \"../../ui/index.ts\";\nimport RangeControl, { NumberRange } from \"../control/RangeControl.tsx\";\nimport NumberField from \"../NumberField.tsx\";\nimport styles from \"./NumberOption.scss\";\n\ninterface RangePartProps {\n\tname: keyof NumberRange;\n\trange: NumberRange;\n\tonRangeChange: Dispatch<NumberRange>;\n\n\tmin?: number;\n\tmax?: number;\n\tstep?: number;\n}\n\nfunction RangePart(props: RangePartProps) {\n\tconst { name, min, max, step, range, onRangeChange } = props;\n\n\tfunction handleChange(valueAsNumber: number) {\n\t\tonRangeChange({ ...range, [name]: valueAsNumber });\n\t}\n\n\treturn (\n\t\t<label className={styles.spinner}>\n\t\t\t<span>{name}</span>\n\t\t\t<NumberInput\n\t\t\t\tclassName={styles.numberInput}\n\t\t\t\tname={name}\n\t\t\t\tvalue={range[name]}\n\t\t\t\tmin={min}\n\t\t\t\tmax={max}\n\t\t\t\tstep={step}\n\t\t\t\tonValueChange={handleChange}\n\t\t\t/>\n\t\t</label>\n\t);\n}\n\ninterface Metadata extends NumberRange {\n\tid: string;\n\tlabel: string;\n\tdefaultValue: number;\n}\n\nexport class NumberOption implements OptionType<number, NumberRange> {\n\n\tprivate readonly data: Metadata;\n\n\tconstructor(data: Metadata) {\n\t\tthis.data = data;\n\t\tthis.VariableMode = this.VariableMode.bind(this);\n\t\tthis.ConstMode = this.ConstMode.bind(this);\n\t\tthis.OptionField = this.OptionField.bind(this);\n\t}\n\n\tget id() {\n\t\treturn this.data.id;\n\t}\n\n\tcreateControl(range: NumberRange) {\n\t\tconst { min, max, step } = range;\n\t\tconst reachableMax = Math.floor((max - min) / step) * step + min;\n\t\treturn new RangeControl({ ...this.data, ...range, max: reachableMax });\n\t}\n\n\tcreateState() {\n\t\tconst { min, max, step, defaultValue } = this.data;\n\t\treturn [defaultValue, { min, max, step }] as [number, NumberRange];\n\t}\n\n\tConstMode(props: OptionFieldProps<number, NumberRange>) {\n\t\tconst { id, label, min, max, step } = this.data;\n\t\tconst { value, onValueChange } = props;\n\n\t\treturn (\n\t\t\t<NumberField\n\t\t\t\tname={id}\n\t\t\t\tvalue={value}\n\t\t\t\tmin={min}\n\t\t\t\tmax={max}\n\t\t\t\tstep={step}\n\t\t\t\tonChange={onValueChange}\n\t\t\t>\n\t\t\t\t{label}\n\t\t\t</NumberField>\n\t\t);\n\t}\n\n\tVariableMode(props: OptionFieldProps<number, NumberRange>) {\n\t\tconst { data } = this;\n\t\tconst { range, onRangeChange } = props;\n\n\t\tconst base = {\n\t\t\t...data,\n\t\t\trange,\n\t\t\tonRangeChange,\n\t\t};\n\n\t\treturn (\n\t\t\t<fieldset className={styles.body}>\n\t\t\t\t<legend className={styles.legend}>\n\t\t\t\t\t{data.label}\n\t\t\t\t</legend>\n\t\t\t\t<RangePart {...base} name=\"min\" max={range.max}/>\n\t\t\t\t<RangePart {...base} name=\"max\" min={range.min}/>\n\t\t\t\t<RangePart {...base} name=\"step\" min={data.step}/>\n\t\t\t</fieldset>\n\t\t);\n\t}\n\n\tpopulate(value: number, options: any) {\n\t\toptions[this.data.id] = value;\n\t}\n\n\tOptionField(props: OptionFieldProps<number, NumberRange>) {\n\t\treturn props.isVariable ? this.VariableMode(props) : this.ConstMode(props);\n\t}\n}\n","/**\n * Copyright 2020 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport function initEmscriptenModule<T extends EmscriptenWasm.Module>(\n  moduleFactory: EmscriptenWasm.ModuleFactory<T>,\n): Promise<T> {\n  return moduleFactory({\n    // Just to be safe, don't automatically invoke any wasm functions\n    noInitialRun: true,\n  });\n}\n\nexport function blobToArrayBuffer(blob: Blob): Promise<ArrayBuffer> {\n  return new Response(blob).arrayBuffer();\n}\n","import { RPC } from \"@kaciras/utilities/browser\";\n\nexport type EncodeModuleLoader<T> = () => Promise<EncodeModule<T>>;\n\nexport interface EncodeModule<T> {\n\tencode(data: BufferSource, width: number, height: number, options: T): Uint8Array | null;\n}\n\nexport interface EncodeResult {\n\n\t/** Time used for encoding (in seconds) */\n\ttime: number;\n\n\tbuffer: ArrayBufferLike;\n}\n\nexport function wasmEncodeFn<T>(loader: EncodeModuleLoader<T>) {\n\tlet loadModuleTask: Promise<EncodeModule<T>> | undefined;\n\n\treturn async (image: ImageData, options: T) => {\n\t\tconst { data, width, height } = image;\n\t\tconst module = await (loadModuleTask ??= loader());\n\n\t\tconst start = performance.now();\n\t\tconst output = module.encode(data, width, height, options);\n\t\tconst end = performance.now();\n\n\t\tif (!output) {\n\t\t\tthrow new Error(\"Encoding error\");\n\t\t}\n\n\t\tconst result: EncodeResult = {\n\t\t\ttime: (end - start) / 1000,\n\t\t\tbuffer: output.buffer,\n\t\t};\n\t\treturn RPC.transfer(result, [result.buffer]);\n\t};\n}\n\n// = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =\n\nexport interface DecodeModule {\n\tdecode(data: BufferSource): ImageData | null;\n}\n\nexport type DecodeModuleLoader = () => Promise<DecodeModule>;\n\nexport function wasmDecodeFn(loader: DecodeModuleLoader) {\n\tlet loadModuleTask: Promise<DecodeModule> | undefined;\n\n\treturn async (data: ArrayBuffer) => {\n\t\tconst module = await (loadModuleTask ??= loader());\n\n\t\tconst output = module.decode(data);\n\t\tif (!output) {\n\t\t\tthrow new Error(\"Decoding error\");\n\t\t}\n\t\treturn RPC.transfer(output, [output.data.buffer]);\n\t};\n}\n","import type { EncodeOptions } from \"squoosh/codecs/mozjpeg/enc/mozjpeg_enc.js\";\nimport { initEmscriptenModule } from \"squoosh/src/features/worker-utils/index.ts\";\nimport { wasmEncodeFn } from \"../common.ts\";\n\nexport { EncodeOptions };\n\nexport const ColorSpace = {\n\tGRAYSCALE: 1,\n\tRGB: 2,\n\tYCbCr: 3,\n};\n\nexport const Quantization = {\n\t\"JPEG Annex K\": 0,\n\t\"Flat\": 1,\n\t\"MSSIM-tuned Kodak\": 2,\n\t\"ImageMagick\": 3,\n\t\"PSNR-HVS-M-tuned Kodak\": 4,\n\t\"Klein et al\": 5,\n\t\"Watson et al\": 6,\n\t\"Ahumada et al\": 7,\n\t\"Peterson et al\": 8,\n};\n\nexport const defaultOptions: EncodeOptions = {\n\tquality: 75,\n\tbaseline: false,\n\tarithmetic: false,\n\tprogressive: true,\n\toptimize_coding: true,\n\tsmoothing: 0,\n\tcolor_space: ColorSpace.YCbCr,\n\tquant_table: Quantization.ImageMagick,\n\ttrellis_multipass: false,\n\ttrellis_opt_zero: false,\n\ttrellis_opt_table: false,\n\ttrellis_loops: 1,\n\tauto_subsample: true,\n\tchroma_subsample: 2,\n\tseparate_chroma_quality: false,\n\tchroma_quality: 75,\n};\n\nexport const encode = wasmEncodeFn<EncodeOptions>(async () => {\n\tconst module = await import(\"squoosh/codecs/mozjpeg/enc/mozjpeg_enc\");\n\treturn initEmscriptenModule(module.default);\n});\n","import { ImageWorker } from \"../../features/image-worker.ts\";\nimport { BoolOption, EnumOption, NumberOption, OptionType } from \"../../form/index.ts\";\nimport { ColorSpace, defaultOptions, EncodeOptions, Quantization } from \"./codec.ts\";\n\nexport const name = \"MozJPEG\";\nexport const mimeType = \"image/jpeg\";\nexport const extension = \"jpg\";\n\nexport { defaultOptions };\n\nexport const templates: OptionType[] = [\n\tnew NumberOption({\n\t\tid: \"quality\",\n\t\tlabel: \"Quality (-q)\",\n\t\tmin: 0,\n\t\tmax: 100,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.quality,\n\t}),\n\tnew EnumOption({\n\t\tid: \"color_space\",\n\t\tlabel: \"Channels\",\n\t\tenumObject: ColorSpace,\n\t\tdefaultValue: \"YCbCr\",\n\t}),\n\tnew BoolOption({\n\t\tid: \"auto_subsample\",\n\t\tlabel: \"Auto subsample chroma\",\n\t\tdefaultValue: defaultOptions.auto_subsample,\n\t}),\n\tnew BoolOption({\n\t\tid: \"separate_chroma_quality\",\n\t\tlabel: \"Separate chroma quality\",\n\t\tdefaultValue: defaultOptions.separate_chroma_quality,\n\t}),\n\tnew NumberOption({\n\t\tid: \"chroma_quality\",\n\t\tlabel: \"Chroma quality\",\n\t\tmin: 0,\n\t\tmax: 100,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.chroma_quality,\n\t}),\n\tnew BoolOption({\n\t\tid: \"baseline\",\n\t\tlabel: \"Pointless spec compliance\",\n\t\tdefaultValue: defaultOptions.baseline,\n\t}),\n\tnew BoolOption({\n\t\tid: \"progressive\",\n\t\tlabel: \"Progressive\",\n\t\tdefaultValue: defaultOptions.progressive,\n\t}),\n\tnew BoolOption({  // Visible when baseline enabled in Squoosh\n\t\tid: \"optimize_coding\",\n\t\tlabel: \"Optimize Huffman table\",\n\t\tdefaultValue: defaultOptions.optimize_coding,\n\t}),\n\tnew NumberOption({\n\t\tid: \"smoothing\",\n\t\tlabel: \"Smoothing\",\n\t\tmin: 0,\n\t\tmax: 100,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.smoothing,\n\t}),\n\tnew EnumOption({\n\t\tid: \"quant_table\",\n\t\tlabel: \"Quantization\",\n\t\tenumObject: Quantization,\n\t\tdefaultValue: \"ImageMagick\",\n\t}),\n\tnew BoolOption({\n\t\tid: \"trellis_multipass\",\n\t\tlabel: \"Trellis multipass\",\n\t\tdefaultValue: defaultOptions.trellis_multipass,\n\t}),\n\tnew BoolOption({ // Visible when trellis_multipass enabled in Squoosh\n\t\tid: \"trellis_opt_zero\",\n\t\tlabel: \"Optimize zero block runs\",\n\t\tdefaultValue: defaultOptions.trellis_opt_zero,\n\t}),\n\tnew BoolOption({\n\t\tid: \"trellis_opt_table\",\n\t\tlabel: \"Optimize after trellis quantization\",\n\t\tdefaultValue: defaultOptions.trellis_opt_table,\n\t}),\n\tnew NumberOption({\n\t\tid: \"trellis_loops\",\n\t\tlabel: \"Trellis quantization passes\",\n\t\tmin: 0,\n\t\tmax: 50,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.trellis_loops,\n\t}),\n];\n\nexport function encode(options: EncodeOptions, worker: ImageWorker) {\n\toptions.color_space = ColorSpace[options.color_space];\n\toptions.quant_table = Quantization[options.quant_table];\n\treturn worker.mozjpegEncode(options);\n}\n","/**\n * Copyright 2020 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport type { EncodeOptions } from 'codecs/jxl/enc/jxl_enc';\n\nexport { EncodeOptions };\n\nexport const label = 'JPEG XL (beta)';\nexport const mimeType = 'image/jxl';\nexport const extension = 'jxl';\nexport const defaultOptions: EncodeOptions = {\n  effort: 7,\n  quality: 75,\n  progressive: false,\n  epf: -1,\n  lossyPalette: false,\n  decodingSpeedTier: 0,\n  photonNoiseIso: 0,\n  lossyModular: false,\n};\n","import type { EncodeOptions } from \"squoosh/codecs/jxl/enc/jxl_enc.js\";\nimport { initEmscriptenModule } from \"squoosh/src/features/worker-utils/index.ts\";\nimport { wasmDecodeFn, wasmEncodeFn } from \"../common.ts\";\n\nexport { defaultOptions } from \"squoosh/src/features/encoders/jxl/shared/meta\";\n\nexport { EncodeOptions };\n\nexport const encode = wasmEncodeFn<EncodeOptions>(async () => {\n\tconst module = await import(\"squoosh/codecs/jxl/enc/jxl_enc\");\n\treturn initEmscriptenModule(module.default);\n});\n\nexport const decode = wasmDecodeFn(async () => {\n\tconst module = await import(\"squoosh/codecs/jxl/dec/jxl_dec\");\n\treturn initEmscriptenModule(module.default);\n});\n","import { ImageWorker } from \"../../features/image-worker.ts\";\nimport { BoolOption, NumberOption, OptionType } from \"../../form/index.ts\";\nimport { defaultOptions, EncodeOptions } from \"./codec.ts\";\n\nexport const name = \"JPEG XL\";\nexport const mimeType = \"image/jxl\";\nexport const extension = \"jxl\";\n\nexport { defaultOptions };\n\nexport const templates: OptionType[] = [\n\tnew NumberOption({\n\t\tid: \"quality\",\n\t\tlabel: \"Quality (100 = lossless)\",\n\t\tmin: 0,\n\t\tmax: 100,\n\t\tstep: 0.1,\n\t\tdefaultValue: defaultOptions.quality,\n\t}),\n\tnew BoolOption({\n\t\tid: \"lossyPalette\",\n\t\tlabel: \"Slight loss\",\n\t\tdefaultValue: defaultOptions.lossyPalette,\n\t}),\n\tnew NumberOption({\n\t\tid: \"epf\",\n\t\tlabel: \"Edge preserving filter (-1 = auto)\",\n\t\tmin: -1,\n\t\tmax: 6,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.epf,\n\t}),\n\tnew NumberOption({\n\t\tid: \"decodingSpeedTier\",\n\t\tlabel: \"Optimise for decoding speed\",\n\t\tmin: 0,\n\t\tmax: 4,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.decodingSpeedTier,\n\t}),\n\tnew NumberOption({\n\t\tid: \"photonNoiseIso\",\n\t\tlabel: \"Noise equivalent to ISO\",\n\t\tmin: 0,\n\t\tmax: 50000,\n\t\tstep: 100,\n\t\tdefaultValue: defaultOptions.photonNoiseIso,\n\t}),\n\tnew BoolOption({\n\t\tid: \"progressive\",\n\t\tlabel: \"Progressive\",\n\t\tdefaultValue: defaultOptions.progressive,\n\t}),\n\tnew NumberOption({\n\t\tid: \"effort\",\n\t\tlabel: \"Effort\",\n\t\tmin: 3,\n\t\tmax: 9,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.effort,\n\t}),\n];\n\nexport function encode(options: EncodeOptions, worker: ImageWorker) {\n\treturn worker.jxlEncode(options);\n}\n","/**\n * Copyright 2020 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport type { EncodeOptions } from 'codecs/webp/enc/webp_enc';\n\nexport { EncodeOptions };\n\nexport const label = 'WebP';\nexport const mimeType = 'image/webp';\nexport const extension = 'webp';\n// These come from struct WebPConfig in encode.h.\nexport const defaultOptions: EncodeOptions = {\n  quality: 75,\n  target_size: 0,\n  target_PSNR: 0,\n  method: 4,\n  sns_strength: 50,\n  filter_strength: 60,\n  filter_sharpness: 0,\n  filter_type: 1,\n  partitions: 0,\n  segments: 4,\n  pass: 1,\n  show_compressed: 0,\n  preprocessing: 0,\n  autofilter: 0,\n  partition_limit: 0,\n  alpha_compression: 1,\n  alpha_filtering: 1,\n  alpha_quality: 100,\n  lossless: 0,\n  exact: 0,\n  image_hint: 0,\n  emulate_jpeg_size: 0,\n  thread_level: 0,\n  low_memory: 0,\n  near_lossless: 100,\n  use_delta_palette: 0,\n  use_sharp_yuv: 0,\n};\n","import type { EncodeOptions } from \"squoosh/codecs/webp/enc/webp_enc.js\";\nimport { initEmscriptenModule } from \"squoosh/src/features/worker-utils/index.ts\";\nimport { wasmEncodeFn } from \"../common.ts\";\n\nexport { defaultOptions } from \"squoosh/src/features/encoders/webP/shared/meta\";\n\nexport { EncodeOptions };\n\nexport const encode = wasmEncodeFn<EncodeOptions>(async () => {\n\tconst webpEncoder = await import(\"squoosh/codecs/webp/enc/webp_enc_simd\");\n\treturn initEmscriptenModule(webpEncoder.default);\n});\n","import { ImageWorker } from \"../../features/image-worker.ts\";\nimport { BoolOption, EnumOption, NumberOption, OptionType } from \"../../form/index.ts\";\nimport { defaultOptions, EncodeOptions } from \"./codec.ts\";\n\nexport const name = \"WebP\";\nexport const mimeType = \"image/webp\";\nexport const extension = \"webp\";\n\nexport { defaultOptions };\n\nconst Preprocess = {\n\t\"None\": 0,\n\t\"Segment smooth\": 1,\n\t\"Dithering\": 2,\n};\n\n// https://github.com/webmproject/libwebp/blob/df0e808fed22aa8b09f20c613fcfdc6c8c9c8c8b/src/enc/config_enc.c#L144\nconst losslessPresets = [\n\t{ method: 0, quality: 0 },\n\t{ method: 1, quality: 20 },\n\t{ method: 2, quality: 25 },\n\t{ method: 3, quality: 30 },\n\t{ method: 3, quality: 50 },\n\t{ method: 4, quality: 50 },\n\t{ method: 4, quality: 75 },\n\t{ method: 4, quality: 90 },\n\t{ method: 5, quality: 90 },\n\t{ method: 6, quality: 100 },\n];\n\nclass LosslessPresetOption extends NumberOption {\n\n\tpopulate(value: number, options: EncodeOptions) {\n\t\tif (!options.lossless) {\n\t\t\treturn;\n\t\t}\n\t\tObject.assign(options, losslessPresets[value]);\n\t}\n}\n\nexport const templates: OptionType[] = [\n\tnew BoolOption({\n\t\tid: \"lossless\",\n\t\tlabel: \"Lossless Mode (-lossless)\",\n\t\tdefaultValue: defaultOptions.lossless,\n\t}),\n\tnew NumberOption({\n\t\tid: \"method\",\n\t\tlabel: \"Method (-m)\",\n\t\tmin: 0,\n\t\tmax: 6,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.method,\n\t}),\n\tnew NumberOption({\n\t\tid: \"quality\",\n\t\tlabel: \"Quality (-q)\",\n\t\tmin: 0,\n\t\tmax: 100,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.quality,\n\t}),\n\tnew NumberOption({\n\t\tid: \"near_lossless\",\n\t\tlabel: \"Near lossless (-near_lossless)\",\n\t\tmin: 0,\n\t\tmax: 100,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.near_lossless,\n\t}),\n\tnew BoolOption({\n\t\tid: \"autofilter\",\n\t\tlabel: \"Auto adjust filter strength (-af)\",\n\t\tdefaultValue: defaultOptions.autofilter,\n\t}),\n\tnew NumberOption({\n\t\tid: \"filter_strength\",\n\t\tlabel: \"Filter strength (-f)\",\n\t\tmin: 0,\n\t\tmax: 100,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.filter_strength,\n\t}),\n\tnew BoolOption({\n\t\tid: \"filter_type\",\n\t\tlabel: \"User strong filter (-strong)\",\n\t\tdefaultValue: defaultOptions.filter_type,\n\t}),\n\tnew NumberOption({\n\t\tid: \"filter_sharpness\",\n\t\tlabel: \"Filter sharpness (-sharpness)\",\n\t\tmin: 0,\n\t\tmax: 7,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.filter_sharpness,\n\t}),\n\tnew BoolOption({\n\t\tid: \"use_sharp_yuv\",\n\t\tlabel: \"Sharp YUV (-sharp_yuv)\",\n\t\tdefaultValue: defaultOptions.use_sharp_yuv,\n\t}),\n\tnew NumberOption({\n\t\tid: \"pass\",\n\t\tlabel: \"Passes (-pass)\",\n\t\tmin: 1,\n\t\tmax: 10,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.pass,\n\t}),\n\tnew NumberOption({\n\t\tid: \"sns_strength\",\n\t\tlabel: \"Spatial noise shaping (-sns)\",\n\t\tmin: 0,\n\t\tmax: 100,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.sns_strength,\n\t}),\n\tnew EnumOption({\n\t\tid: \"preprocessing\",\n\t\tlabel: \"Preprocess (-pre)\",\n\t\tenumObject: Preprocess,\n\t\tdefaultValue: \"None\",\n\t}),\n\tnew NumberOption({\n\t\tid: \"segments\",\n\t\tlabel: \"Segments (-segments)\",\n\t\tmin: 1,\n\t\tmax: 4,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.segments,\n\t}),\n\tnew LosslessPresetOption({\n\t\tid: \"losslessPreset\",\n\t\tlabel: \"Lossless Preset (-z)\",\n\t\tmin: 0,\n\t\tmax: 9,\n\t\tstep: 1,\n\t\tdefaultValue: 6,\n\t}),\n\n\t// There is no image_hint option since it have no effect.\n];\n\nexport function encode(options: EncodeOptions, worker: ImageWorker) {\n\toptions.preprocessing = Preprocess[options.preprocessing];\n\treturn worker.webpEncode(options);\n}\n","import type { EncodeOptions } from \"squoosh/codecs/avif/enc/avif_enc.js\";\nimport { initEmscriptenModule } from \"squoosh/src/features/worker-utils/index.ts\";\nimport { wasmDecodeFn, wasmEncodeFn } from \"../common.ts\";\n\nexport { EncodeOptions };\n\nexport const Subsampling = {\n\tYUV400: 0,\n\tYUV420: 1,\n\tYUV422: 2,\n\tYUV444: 3,\n};\n\nexport const AVIFTune = {\n\tauto: 0,\n\tpsnr: 1,\n\tssim: 3,\n};\n\nexport const defaultOptions: EncodeOptions = {\n\tcqLevel: 33,\n\tcqAlphaLevel: -1,\n\tdenoiseLevel: 0,\n\ttileColsLog2: 0,\n\ttileRowsLog2: 0,\n\tspeed: 6,\n\tsubsample: Subsampling.YUV420,\n\tchromaDeltaQ: false,\n\tsharpness: 0,\n\ttune: AVIFTune.auto,\n};\n\nexport const encode = wasmEncodeFn<EncodeOptions>(async () => {\n\tconst module = await import(\"squoosh/codecs/avif/enc/avif_enc\");\n\treturn initEmscriptenModule(module.default);\n});\n\nexport const decode = wasmDecodeFn(async () => {\n\tconst module = await import(\"squoosh/codecs/avif/dec/avif_dec\");\n\treturn initEmscriptenModule(module.default);\n});\n","import { ImageWorker } from \"../../features/image-worker\";\nimport { BoolOption, EnumOption, NumberOption, OptionType } from \"../../form/index.ts\";\nimport { defaultOptions, EncodeOptions, Subsampling } from \"./codec.ts\";\n\nexport const name = \"AVIF\";\nexport const mimeType = \"image/avif\";\nexport const extension = \"avif\";\n\nconst AVIFTune = {\n\tAuto: 0,\n\tPSNR: 1,\n\tSSIM: 3,\n};\n\nexport { defaultOptions };\n\nexport const templates: OptionType[] = [\n\tnew NumberOption({\n\t\tid: \"cqLevel\",\n\t\tlabel: \"Quality (63 = lossless)\",\n\t\tmin: 0,\n\t\tmax: 63,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.cqLevel,\n\t}),\n\tnew EnumOption({\n\t\tid: \"subsample\",\n\t\tlabel: \"Subsample\",\n\t\tenumObject: Subsampling,\n\t\tdefaultValue: \"YUV420\",\n\t}),\n\tnew NumberOption({\n\t\tid: \"cqAlphaLevel\",\n\t\tlabel: \"Alpha quality (-1 to same with the quality)\",\n\t\tmin: -1,\n\t\tmax: 63,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.cqAlphaLevel,\n\t}),\n\tnew BoolOption({\n\t\tid: \"chromaDeltaQ\",\n\t\tlabel: \"Extra chroma compression\",\n\t\tdefaultValue: defaultOptions.chromaDeltaQ,\n\t}),\n\tnew NumberOption({\n\t\tid: \"sharpness\",\n\t\tlabel: \"Sharpness\",\n\t\tmin: 0,\n\t\tmax: 7,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.sharpness,\n\t}),\n\tnew NumberOption({\n\t\tid: \"denoiseLevel\",\n\t\tlabel: \"Noise synthesis\",\n\t\tmin: 0,\n\t\tmax: 50,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.denoiseLevel,\n\t}),\n\tnew EnumOption({\n\t\tid: \"tune\",\n\t\tlabel: \"Tuning\",\n\t\tenumObject: AVIFTune,\n\t\tdefaultValue: \"Auto\",\n\t}),\n\tnew NumberOption({\n\t\tid: \"tileRowsLog2\",\n\t\tlabel: \"Log2 of tile rows\",\n\t\tmin: 0,\n\t\tmax: 6,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.tileRowsLog2,\n\t}),\n\tnew NumberOption({\n\t\tid: \"tileColsLog2\",\n\t\tlabel: \"Log2 of tile cols\",\n\t\tmin: 0,\n\t\tmax: 6,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.tileColsLog2,\n\t}),\n\tnew NumberOption({\n\t\tid: \"speed\",\n\t\tlabel: \"Speed\",\n\t\tmin: 0,\n\t\tmax: 10,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.speed,\n\t}),\n];\n\nexport function encode(options: EncodeOptions, worker: ImageWorker) {\n\tconst { cqLevel, cqAlphaLevel } = options;\n\toptions.subsample = Subsampling[options.subsample];\n\toptions.tune = AVIFTune[options.tune];\n\toptions.cqLevel = 63 - cqLevel;\n\toptions.cqAlphaLevel = (cqAlphaLevel === -1) ? -1 : 63 - cqAlphaLevel;\n\treturn worker.avifEncode(options);\n}\n","import type { EncodeOptions } from \"squoosh/codecs/wp2/enc/wp2_enc.js\";\nimport { initEmscriptenModule } from \"squoosh/src/features/worker-utils/index.ts\";\nimport { wasmDecodeFn, wasmEncodeFn } from \"../common.ts\";\n\nexport { EncodeOptions };\n\nexport const Subsample = {\n\t\"Auto\": 3,\n\t\"Vary\": 0, // Adapt\n\t\"Half\": 1, // YUV420\n\t\"Off\": 2,  // YUV444\n};\n\nexport const Csp = {\n\tYCoCg: 0,\n\tYCbCr: 1,\n\t// Custom: 2,\n\tYIQ: 3,\n};\n\nexport const defaultOptions: EncodeOptions = {\n\tquality: 75,\n\talpha_quality: 75,\n\teffort: 5,\n\tpass: 1,\n\tsns: 50,\n\tuv_mode: Subsample.Auto,\n\tcsp_type: Csp.YCoCg,\n\terror_diffusion: 0,\n\tuse_random_matrix: false,\n};\n\nexport const encode = wasmEncodeFn<EncodeOptions>(async () => {\n\tconst module = await import(\"squoosh/codecs/wp2/enc/wp2_enc\");\n\treturn initEmscriptenModule(module.default);\n});\n\nexport const decode = wasmDecodeFn(async () => {\n\tconst module = await import(\"squoosh/codecs/wp2/dec/wp2_dec\");\n\treturn initEmscriptenModule(module.default);\n});\n","import { ImageWorker } from \"../../features/image-worker.ts\";\nimport { BoolOption, EnumOption, NumberOption, OptionType } from \"../../form/index.ts\";\nimport { Csp, defaultOptions, EncodeOptions, Subsample } from \"./codec.ts\";\n\nexport const name = \"WebP v2\";\nexport const mimeType = \"image/webp2\";\nexport const extension = \"wp2\";\n\nexport { defaultOptions };\n\nexport const templates: OptionType[] = [\n\tnew NumberOption({\n\t\tid: \"quality\",\n\t\tlabel: \"Quality (100 = lossless)\",\n\t\tmin: 0,\n\t\tmax: 100,\n\t\tstep: 0.1,\n\t\tdefaultValue: defaultOptions.quality,\n\t}),\n\tnew NumberOption({\n\t\tid: \"alpha_quality\",\n\t\tlabel: \"Alpha Quality\",\n\t\tmin: 0,\n\t\tmax: 95,\n\t\tstep: 0.1,\n\t\tdefaultValue: defaultOptions.alpha_quality,\n\t}),\n\tnew NumberOption({\n\t\tid: \"effort\",\n\t\tlabel: \"Effort\",\n\t\tmin: 0,\n\t\tmax: 9,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.effort,\n\t}),\n\tnew NumberOption({\n\t\tid: \"pass\",\n\t\tlabel: \"Passes\",\n\t\tmin: 0,\n\t\tmax: 9,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.pass,\n\t}),\n\tnew NumberOption({\n\t\tid: \"sns\",\n\t\tlabel: \"Spatial noise shaping\",\n\t\tmin: 0,\n\t\tmax: 100,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.sns,\n\t}),\n\tnew NumberOption({\n\t\tid: \"error_diffusion\",\n\t\tlabel: \"Error diffusion\",\n\t\tmin: 0,\n\t\tmax: 100,\n\t\tstep: 1,\n\t\tdefaultValue: defaultOptions.error_diffusion,\n\t}),\n\tnew EnumOption({\n\t\tid: \"uv_mode\",\n\t\tlabel: \"Subsample chroma\",\n\t\tenumObject: Subsample,\n\t\tdefaultValue: \"Auto\",\n\t}),\n\tnew EnumOption({\n\t\tid: \"csp_type\",\n\t\tlabel: \"Color space\",\n\t\tenumObject: Csp,\n\t\tdefaultValue: \"YCoCg\",\n\t}),\n\tnew BoolOption({\n\t\tid: \"use_random_matrix\",\n\t\tlabel: \"Random matrix\",\n\t\tdefaultValue: defaultOptions.use_random_matrix,\n\t}),\n];\n\nexport function encode(options: EncodeOptions, worker: ImageWorker) {\n\toptions.uv_mode = Subsample[options.uv_mode];\n\toptions.csp_type = Csp[options.csp_type];\n\treturn worker.webp2Encode(options);\n}\n","import { ImageWorker } from \"../features/image-worker.ts\";\nimport { EncodeResult } from \"./common.ts\";\nimport * as MozJPEG from \"./mozjpeg/client.ts\";\nimport * as JXL from \"./jxl/client.ts\";\nimport * as WebP from \"./webp/client.ts\";\nimport * as AVIF from \"./avif/client.ts\";\nimport * as WebP2 from \"./webp2/client.ts\";\nimport { ControlType, OptionStateMap, OptionType } from \"../form/index.ts\";\n\nexport interface ImageEncoder {\n\tname: string;\n\textension: string;\n\tmimeType: string;\n\n\ttemplates: OptionType[];\n\tdefaultOptions: Record<string, any>;\n\n\t/**\n\t * Convert options generated by form and invoke the encode worker.\n\t *\n\t * @param options Form options.\n\t * @param worker The encode worker, input image is already set.\n\t */\n\tencode(options: any, worker: ImageWorker): Promise<EncodeResult>;\n}\n\nexport const ENCODERS: ImageEncoder[] = [MozJPEG, JXL, WebP, AVIF, WebP2];\n\nexport const ENCODER_MAP = Object.fromEntries(ENCODERS.map(e => [e.name, e]));\n\nconst names = ENCODERS.map(e => e.name);\n\nexport function getEncoderNames(object: Record<string, unknown>) {\n\treturn names.filter(name => name in object);\n}\n\nexport function buildProfiles(encoder: ImageEncoder, state: OptionStateMap) {\n\tconst { defaultOptions, templates } = encoder;\n\n\tconst variables: Record<string, unknown[]> = {};\n\tconst constants = { ...defaultOptions };\n\tconst controls: ControlType[] = [];\n\tconst weights: number[] = [];\n\n\tlet size = 1;\n\n\tfor (const template of templates) {\n\t\tconst { isVariable, value, range } = state[template.id];\n\n\t\tif (!isVariable) {\n\t\t\ttemplate.populate(value, constants);\n\t\t} else {\n\t\t\tconst control = template.createControl(range);\n\t\t\tconst values = control.createState();\n\t\t\tsize *= values.length;\n\t\t\tcontrols.push(control);\n\t\t\tvariables[template.id] = values;\n\t\t}\n\t}\n\n\tlet weight = 1;\n\tfor (let i = controls.length - 1; i >= 0; i--) {\n\t\tweights.push(weight);\n\t\tweight *= variables[controls[i].id].length;\n\t}\n\n\treturn { size, variables, constants, controls, weights };\n}\n","/**\n * Copyright 2020 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { drawableToImageData } from './canvas';\n\n/** If render engine is Safari */\nexport const isSafari =\n  /Safari\\//.test(navigator.userAgent) &&\n  !/Chrom(e|ium)\\//.test(navigator.userAgent);\n\n/**\n * Compare two objects, returning a boolean indicating if\n * they have the same properties and strictly equal values.\n */\nexport function shallowEqual(one: any, two: any) {\n  for (const i in one) if (one[i] !== two[i]) return false;\n  for (const i in two) if (!(i in one)) return false;\n  return true;\n}\n\nasync function decodeImage(url: string): Promise<HTMLImageElement> {\n  const img = new Image();\n  img.decoding = 'async';\n  img.src = url;\n  const loaded = new Promise<void>((resolve, reject) => {\n    img.onload = () => resolve();\n    img.onerror = () => reject(Error('Image loading error'));\n  });\n\n  if (img.decode) {\n    // Nice off-thread way supported in Safari/Chrome.\n    // Safari throws on decode if the source is SVG.\n    // https://bugs.webkit.org/show_bug.cgi?id=188347\n    await img.decode().catch(() => null);\n  }\n\n  // Always await loaded, as we may have bailed due to the Safari bug above.\n  await loaded;\n  return img;\n}\n\n/** Caches results from canDecodeImageType */\nconst canDecodeCache = new Map<string, Promise<boolean>>();\n\n/**\n * Tests whether the browser supports a particular image mime type.\n *\n * @param type Mimetype\n * @example await canDecodeImageType('image/avif')\n */\nexport function canDecodeImageType(type: string): Promise<boolean> {\n  if (!canDecodeCache.has(type)) {\n    const resultPromise = (async () => {\n      const picture = document.createElement('picture');\n      const img = document.createElement('img');\n      const source = document.createElement('source');\n      source.srcset = 'data:,x';\n      source.type = type;\n      picture.append(source, img);\n\n      // Wait a single microtick just for the `img.currentSrc` to get populated.\n      await 0;\n      // At this point `img.currentSrc` will contain \"data:,x\" if format is supported and \"\"\n      // otherwise.\n      return !!img.currentSrc;\n    })();\n\n    canDecodeCache.set(type, resultPromise);\n  }\n\n  return canDecodeCache.get(type)!;\n}\n\nexport function blobToArrayBuffer(blob: Blob): Promise<ArrayBuffer> {\n  return new Response(blob).arrayBuffer();\n}\n\nexport function blobToText(blob: Blob): Promise<string> {\n  return new Response(blob).text();\n}\n\nconst magicNumberMapInput = [\n  [/^%PDF-/, 'application/pdf'],\n  [/^GIF87a/, 'image/gif'],\n  [/^GIF89a/, 'image/gif'],\n  [/^\\x89PNG\\x0D\\x0A\\x1A\\x0A/, 'image/png'],\n  [/^\\xFF\\xD8\\xFF/, 'image/jpeg'],\n  [/^BM/, 'image/bmp'],\n  [/^I I/, 'image/tiff'],\n  [/^II*/, 'image/tiff'],\n  [/^MM\\x00*/, 'image/tiff'],\n  [/^RIFF....WEBPVP8[LX ]/s, 'image/webp'],\n  [/^\\xF4\\xFF\\x6F/, 'image/webp2'],\n  [/^\\x00\\x00\\x00 ftypavif\\x00\\x00\\x00\\x00/, 'image/avif'],\n  [/^\\xff\\x0a/, 'image/jxl'],\n  [/^\\x00\\x00\\x00\\x0cJXL \\x0d\\x0a\\x87\\x0a/, 'image/jxl'],\n  [/^qoif/, 'image/qoi'],\n] as const;\n\nexport type ImageMimeTypes = typeof magicNumberMapInput[number][1];\n\nconst magicNumberToMimeType = new Map<RegExp, ImageMimeTypes>(\n  magicNumberMapInput,\n);\n\nexport async function sniffMimeType(blob: Blob): Promise<ImageMimeTypes | ''> {\n  const firstChunk = await blobToArrayBuffer(blob.slice(0, 16));\n  const firstChunkString = Array.from(new Uint8Array(firstChunk))\n    .map((v) => String.fromCodePoint(v))\n    .join('');\n  for (const [detector, mimeType] of magicNumberToMimeType) {\n    if (detector.test(firstChunkString)) {\n      return mimeType;\n    }\n  }\n  return '';\n}\n\nexport async function blobToImg(blob: Blob): Promise<HTMLImageElement> {\n  const url = URL.createObjectURL(blob);\n\n  try {\n    return await decodeImage(url);\n  } finally {\n    URL.revokeObjectURL(url);\n  }\n}\n\nexport async function builtinDecode(\n  signal: AbortSignal,\n  blob: Blob,\n): Promise<ImageData> {\n  assertSignal(signal);\n\n  // Prefer createImageBitmap as it's the off-thread option for Firefox.\n  const drawable = await abortable<HTMLImageElement | ImageBitmap>(\n    signal,\n    'createImageBitmap' in self ? createImageBitmap(blob) : blobToImg(blob),\n  );\n  return drawableToImageData(drawable);\n}\n\n/**\n * @param field An HTMLInputElement, but the casting is done here to tidy up onChange.\n * @param defaultVal Value to return if 'field' doesn't exist.\n */\nexport function inputFieldValueAsNumber(\n  field: any,\n  defaultVal: number = 0,\n): number {\n  if (!field) return defaultVal;\n  return Number(inputFieldValue(field));\n}\n\n/**\n * @param field An HTMLInputElement, but the casting is done here to tidy up onChange.\n * @param defaultVal Value to return if 'field' doesn't exist.\n */\nexport function inputFieldCheckedAsNumber(\n  field: any,\n  defaultVal: number = 0,\n): number {\n  if (!field) return defaultVal;\n  return Number(inputFieldChecked(field));\n}\n\n/**\n * @param field An HTMLInputElement, but the casting is done here to tidy up onChange.\n * @param defaultVal Value to return if 'field' doesn't exist.\n */\nexport function inputFieldChecked(\n  field: any,\n  defaultVal: boolean = false,\n): boolean {\n  if (!field) return defaultVal;\n  return (field as HTMLInputElement).checked;\n}\n\n/**\n * @param field An HTMLInputElement, but the casting is done here to tidy up onChange.\n * @param defaultVal Value to return if 'field' doesn't exist.\n */\nexport function inputFieldValue(field: any, defaultVal: string = ''): string {\n  if (!field) return defaultVal;\n  return (field as HTMLInputElement).value;\n}\n\n/**\n * Creates a promise that resolves when the user types the konami code.\n */\nexport function konami(): Promise<void> {\n  return new Promise((resolve) => {\n    // Keycodes for: ↑ ↑ ↓ ↓ ← → ← → B A\n    const expectedPattern = '38384040373937396665';\n    let rollingPattern = '';\n\n    const listener = (event: KeyboardEvent) => {\n      rollingPattern += event.keyCode;\n      rollingPattern = rollingPattern.slice(-expectedPattern.length);\n      if (rollingPattern === expectedPattern) {\n        window.removeEventListener('keydown', listener);\n        resolve();\n      }\n    };\n\n    window.addEventListener('keydown', listener);\n  });\n}\n\ninterface TransitionOptions {\n  from?: number;\n  to?: number;\n  duration?: number;\n  easing?: string;\n}\n\nexport async function transitionHeight(\n  el: HTMLElement,\n  opts: TransitionOptions,\n): Promise<void> {\n  const {\n    from = el.getBoundingClientRect().height,\n    to = el.getBoundingClientRect().height,\n    duration = 1000,\n    easing = 'ease-in-out',\n  } = opts;\n\n  if (from === to || duration === 0) {\n    el.style.height = to + 'px';\n    return;\n  }\n\n  el.style.height = from + 'px';\n  // Force a style calc so the browser picks up the start value.\n  getComputedStyle(el).transform;\n  el.style.transition = `height ${duration}ms ${easing}`;\n  el.style.height = to + 'px';\n\n  return new Promise<void>((resolve) => {\n    const listener = (event: Event) => {\n      if (event.target !== el) return;\n      el.style.transition = '';\n      el.removeEventListener('transitionend', listener);\n      el.removeEventListener('transitioncancel', listener);\n      resolve();\n    };\n\n    el.addEventListener('transitionend', listener);\n    el.addEventListener('transitioncancel', listener);\n  });\n}\n\n/**\n * Simple event listener that prevents the default.\n */\nexport function preventDefault(event: Event) {\n  event.preventDefault();\n}\n\n/**\n * Throw an abort error if a signal is aborted.\n */\nexport function assertSignal(signal: AbortSignal) {\n  if (signal.aborted) throw new DOMException('AbortError', 'AbortError');\n}\n\n/**\n * Take a signal and promise, and returns a promise that rejects with an AbortError if the abort is\n * signalled, otherwise resolves with the promise.\n */\nexport async function abortable<T>(\n  signal: AbortSignal,\n  promise: Promise<T>,\n): Promise<T> {\n  assertSignal(signal);\n  return Promise.race([\n    promise,\n    new Promise<T>((_, reject) => {\n      signal.addEventListener('abort', () =>\n        reject(new DOMException('AbortError', 'AbortError')),\n      );\n    }),\n  ]);\n}\n","import { RPC } from \"@kaciras/utilities/browser\";\n\nexport type WorkerFactory = () => Worker;\n\nexport type TaskFn<T, R> = (remote: RPC.Remote<T>) => Promise<R>;\n\ninterface PromiseController {\n\tresolve: () => void;\n\treject: (reason: any) => void;\n}\n\ninterface WorkerJob<T> {\n\ttask: TaskFn<T, any>;\n\tresolve: (value: any) => void;\n\treject: (reason: any) => void;\n}\n\n/**\n * Executes each submitted task using one of possibly several pooled workers.\n *\n * The pool uses single task queue that may cause dead lock if schedule and wait a new task inside another.\n */\nexport default class WorkerPool<T> {\n\n\tprivate readonly factory: WorkerFactory;\n\tprivate readonly workers: Array<Worker | undefined>;\n\n\tprivate readonly remotes: Array<RPC.Remote<T>> = [];\n\tprivate readonly queue: Array<WorkerJob<T>> = [];\n\n\tprivate readonly waiters: PromiseController[] = [];\n\n\tprivate size = 0;\n\n\tterminated = false;\n\n\tconstructor(factory: WorkerFactory, maxSize: number) {\n\t\tif (maxSize < 1) {\n\t\t\tthrow new Error(\"Worker count must be at least 1\");\n\t\t}\n\t\tthis.factory = factory;\n\t\tthis.workers = new Array(maxSize);\n\t}\n\n\t/**\n\t * Execute a function with each worker, call this method will start all workers.\n\t *\n\t * @param action the Function to execute.\n\t */\n\trunOnEach<R>(action: TaskFn<T, R>) {\n\t\tconst { workers, remotes } = this;\n\t\tconst max = workers.length;\n\n\t\twhile (this.size < max) {\n\t\t\tthis.startWorker();\n\t\t}\n\t\treturn Promise.all(remotes.map(action));\n\t}\n\n\trun<R>(task: TaskFn<T, R>) {\n\t\treturn new Promise<R>((resolve, reject) => this.addJob({ task, resolve, reject }));\n\t}\n\n\t/**\n\t * Wait task queue for empty or an error occurred in tasks.\n\t */\n\tjoin() {\n\t\tconst { queue, waiters } = this;\n\t\tif (queue.length === 0 && this.allWorkerAreFree) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\treturn new Promise<void>((resolve, reject) => waiters.push({ resolve, reject }));\n\t}\n\n\tterminate() {\n\t\tthis.terminated = true;\n\t\tthis.workers.forEach(worker => worker?.terminate());\n\t}\n\n\tprivate get allWorkerAreFree() {\n\t\treturn this.remotes.length === this.size;\n\t}\n\n\tprivate startWorker() {\n\t\tconst worker = this.factory();\n\t\tconst remote = RPC.probeClient(worker);\n\n\t\tconst index = this.size++;\n\t\tthis.remotes.push(remote);\n\t\tthis.workers[index] = worker;\n\t}\n\n\tprivate addJob(job: WorkerJob<T>) {\n\t\tconst { workers, remotes, size } = this;\n\t\tif (remotes.length === 0 && size < workers.length) {\n\t\t\tthis.startWorker();\n\t\t}\n\t\tconst remote = remotes.pop();\n\t\tif (!remote) {\n\t\t\tthis.queue.push(job);\n\t\t} else {\n\t\t\treturn this.runJob(remote, job);\n\t\t}\n\t}\n\n\tprivate async runJob(remote: RPC.Remote<T>, job: WorkerJob<T>): Promise<void> {\n\t\tconst { queue, remotes, waiters } = this;\n\t\tconst { task, resolve, reject } = job;\n\n\t\ttry {\n\t\t\tresolve(await task(remote));\n\t\t} catch (e) {\n\t\t\treject(e);\n\t\t\twaiters.splice(0, waiters.length).forEach(p => p.reject(e));\n\t\t}\n\n\t\tconst next = queue.pop();\n\t\tif (next) {\n\t\t\treturn this.runJob(remote, next);\n\t\t}\n\n\t\tremotes.push(remote);\n\n\t\tif (this.allWorkerAreFree) {\n\t\t\twaiters.splice(0, waiters.length).forEach(p => p.resolve());\n\t\t}\n\t}\n}\n","import type { ImageWorkerApi } from \"./worker.ts\";\nimport { noop, RPC } from \"@kaciras/utilities/browser\";\nimport WorkerPool from \"./WorkerPool.ts\";\n\nexport interface InputImage {\n\treadonly file: File;\n\treadonly raw: ImageData;\n}\n\nexport interface AnalyzeResult {\n\tdata: ImageData;\n\tfile: File;\n\theatMap?: ImageData;\n\tmetrics: Record<string, number>;\n}\n\n/**\n * Create a new object compatible with ImageData type from an ImageData,\n * with convert the data to SharedArrayBuffer.\n *\n * NOTE: the returned value is not an ImageData and can't be put into canvas.\n *\n * @param image original image data\n * @return the image data with shared\n */\nfunction share(image: ImageData): ImageData {\n\tconst { width, height, data } = image;\n\tconst buffer = new SharedArrayBuffer(data.byteLength);\n\tconst uint8Array = new Uint8ClampedArray(buffer);\n\tuint8Array.set(data);\n\treturn { width, height, data: uint8Array } as any;\n}\n\nexport type ImagePool = WorkerPool<ImageWorkerApi>;\n\nexport type ImageWorker = RPC.Remote<ImageWorkerApi>;\n\nexport function workerFactory() {\n\t// @ts-ignore ts-loader will convert the file to ES module.\n\treturn new Worker(new URL(\"./worker\", import.meta.url));\n}\n\nexport function newImagePool(size: number): ImagePool {\n\treturn new WorkerPool<ImageWorkerApi>(workerFactory, size);\n}\n\nexport function setOriginalImage(pool: ImagePool, input: InputImage) {\n\tconst { raw } = input;\n\n\tif (\"SharedArrayBuffer\" in window) {\n\t\tconst shared = share(raw);\n\t\treturn pool.runOnEach(r => r.setOriginal(shared));\n\t} else {\n\t\treturn pool.runOnEach(r => r.setOriginal(raw));\n\t}\n}\n\nclass PooledWorkerHandler<T extends Record<string, any>> implements ProxyHandler<T> {\n\n\tprivate readonly workerPool: WorkerPool<T>;\n\n\tconstructor(workerPool: WorkerPool<T>) {\n\t\tthis.workerPool = workerPool;\n\t}\n\n\tget(target: T, property: string) {\n\t\treturn new Proxy(target, new InvokeHandler(this.workerPool, property));\n\t}\n}\n\nclass InvokeHandler<T extends Record<string, any>> implements ProxyHandler<T> {\n\n\tprivate readonly workerPool: WorkerPool<T>;\n\tprivate readonly method: string;\n\n\tconstructor(workerPool: WorkerPool<T>, method: string) {\n\t\tthis.workerPool = workerPool;\n\t\tthis.method = method;\n\t}\n\n\tapply(_: T, __: unknown, argArray: any[]) {\n\t\tconst { workerPool, method } = this;\n\t\treturn workerPool.run(worker => worker[method](...argArray));\n\t}\n}\n\nexport function getPooledWorker<T>(workerPool: WorkerPool<T>) {\n\n\t// The target must be a function, see https://stackoverflow.com/a/32360219\n\treturn new Proxy(noop as any, new PooledWorkerHandler(workerPool)) as RPC.Remote<T>;\n}\n","/*\n * Copyright 2020 Google Inc. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * Modifications copyright (C) 2020 Kaciras\n */\nimport { RPC } from \"@kaciras/utilities/browser\";\nimport { blobToImg, canDecodeImageType, sniffMimeType } from \"squoosh/src/client/lazy-app/util/index.ts\";\nimport { drawableToImageData } from \"squoosh/src/client/lazy-app/util/canvas.ts\";\nimport { ImageWorkerApi } from \"./worker.ts\";\nimport { ImageWorker, workerFactory } from \"./image-worker.ts\";\n\nasync function decodeImageNative(blob: Blob) {\n\tconst bitmap = \"createImageBitmap\" in self\n\t\t? await createImageBitmap(blob)\n\t\t: await blobToImg(blob);\n\n\tconst canvas = document.createElement(\"canvas\");\n\tconst { width, height } = bitmap;\n\tcanvas.width = width;\n\tcanvas.height = height;\n\n\tconst ctx = canvas.getContext(\"2d\");\n\tif (!ctx) {\n\t\tthrow new Error(\"Canvas not initialized\");\n\t}\n\tctx.drawImage(bitmap, 0, 0);\n\treturn ctx.getImageData(0, 0, width, height);\n}\n\n/**\n * Firefox throws if you try to draw an SVG to canvas that doesn't have width/height.\n * In Chrome it loads, but drawImage behaves weirdly.\n * This function sets width/height if it isn't already set.\n *\n * @param svgXml The SVG image with width/height attributes\n */\nfunction ensureSVGSize(svgXml: string) {\n\tconst parser = new DOMParser();\n\tconst document = parser.parseFromString(svgXml, \"image/svg+xml\");\n\tconst svg = document.documentElement;\n\n\tif (svg.getAttribute(\"width\") && svg.getAttribute(\"height\")) {\n\t\treturn svgXml;\n\t}\n\n\tconst viewBox = svg.getAttribute(\"viewBox\");\n\tif (viewBox === null) {\n\t\tthrow Error(\"SVG must have width/height or viewBox\");\n\t}\n\tconst [, , width, height] = viewBox.split(/\\s+/);\n\tsvg.setAttribute(\"width\", width);\n\tsvg.setAttribute(\"height\", height);\n\n\treturn new XMLSerializer().serializeToString(document);\n}\n\nasync function svgToImageData(svgXml: string) {\n\tsvgXml = ensureSVGSize(svgXml);\n\tconst blob = new Blob([svgXml], { type: \"image/svg+xml\" });\n\treturn drawableToImageData(await blobToImg(blob));\n}\n\nexport async function decode(blob: Blob, worker?: ImageWorker) {\n\tlet { type } = blob;\n\n\tif (!type) {\n\t\ttype = await sniffMimeType(blob);\n\t}\n\tif (type === \"image/svg+xml\") {\n\t\treturn blob.text().then(svgToImageData);\n\t}\n\tif (await canDecodeImageType(type)) {\n\t\treturn decodeImageNative(blob);\n\t}\n\n\tworker ??= RPC.probeClient<ImageWorkerApi>(workerFactory());\n\tconst buffer = await blob.arrayBuffer();\n\tswitch (type) {\n\t\tcase \"image/avif\":\n\t\t\treturn worker.avifDecode(buffer);\n\t\tcase \"image/jxl\":\n\t\t\treturn worker.jxlDecode(buffer);\n\t\tcase \"image/webp2\":\n\t\t\treturn worker.webp2Decode(buffer);\n\t\tdefault:\n\t\t\treturn decodeImageNative(blob);\n\t}\n}\n","/** Replace the contents of a canvas with the given data */\nexport function drawDataToCanvas(canvas: HTMLCanvasElement, data: ImageData) {\n  const ctx = canvas.getContext('2d');\n  if (!ctx) throw Error('Canvas not initialized');\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n  ctx.putImageData(data, 0, 0);\n}\n\n/**\n * Encode some image data in a given format using the browser's encoders\n *\n * @param {ImageData} data\n * @param {string} type A mime type, eg image/jpeg.\n * @param {number} [quality] Between 0-1.\n */\nexport async function canvasEncode(\n  data: ImageData,\n  type: string,\n  quality?: number,\n): Promise<Blob> {\n  const canvas = document.createElement('canvas');\n  canvas.width = data.width;\n  canvas.height = data.height;\n  const ctx = canvas.getContext('2d');\n  if (!ctx) throw Error('Canvas not initialized');\n  ctx.putImageData(data, 0, 0);\n\n  let blob: Blob | null;\n\n  if ('toBlob' in canvas) {\n    blob = await new Promise<Blob | null>((r) =>\n      canvas.toBlob(r, type, quality),\n    );\n  } else {\n    // Welcome to Edge.\n    // TypeScript thinks `canvas` is 'never', so it needs casting.\n    const dataUrl = (canvas as HTMLCanvasElement).toDataURL(type, quality);\n    const result = /data:([^;]+);base64,(.*)$/.exec(dataUrl);\n\n    if (!result) throw Error('Data URL reading failed');\n\n    const outputType = result[1];\n    const binaryStr = atob(result[2]);\n    const data = new Uint8Array(binaryStr.length);\n\n    for (let i = 0; i < data.length; i += 1) {\n      data[i] = binaryStr.charCodeAt(i);\n    }\n\n    blob = new Blob([data], { type: outputType });\n  }\n\n  if (!blob) throw Error('Encoding failed');\n  return blob;\n}\n\ninterface DrawableToImageDataOptions {\n  width?: number;\n  height?: number;\n  sx?: number;\n  sy?: number;\n  sw?: number;\n  sh?: number;\n}\n\nexport function drawableToImageData(\n  drawable: ImageBitmap | HTMLImageElement,\n  opts: DrawableToImageDataOptions = {},\n): ImageData {\n  const {\n    width = drawable.width,\n    height = drawable.height,\n    sx = 0,\n    sy = 0,\n    sw = drawable.width,\n    sh = drawable.height,\n  } = opts;\n\n  // Make canvas same size as image\n  const canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  // Draw image onto canvas\n  const ctx = canvas.getContext('2d');\n  if (!ctx) throw new Error('Could not create canvas context');\n  ctx.drawImage(drawable, sx, sy, sw, sh, 0, 0, width, height);\n  return ctx.getImageData(0, 0, width, height);\n}\n\nexport type BuiltinResizeMethod = 'pixelated' | 'low' | 'medium' | 'high';\n\nexport function builtinResize(\n  data: ImageData,\n  sx: number,\n  sy: number,\n  sw: number,\n  sh: number,\n  dw: number,\n  dh: number,\n  method: BuiltinResizeMethod,\n): ImageData {\n  const canvasSource = document.createElement('canvas');\n  canvasSource.width = data.width;\n  canvasSource.height = data.height;\n  drawDataToCanvas(canvasSource, data);\n\n  const canvasDest = document.createElement('canvas');\n  canvasDest.width = dw;\n  canvasDest.height = dh;\n  const ctx = canvasDest.getContext('2d');\n  if (!ctx) throw new Error('Could not create canvas context');\n\n  if (method === 'pixelated') {\n    ctx.imageSmoothingEnabled = false;\n  } else {\n    ctx.imageSmoothingQuality = method;\n  }\n\n  ctx.drawImage(canvasSource, sx, sy, sw, sh, 0, 0, dw, dh);\n  return ctx.getImageData(0, 0, dw, dh);\n}\n\n/**\n * Test whether <canvas> can encode to a particular type.\n */\nexport async function canvasEncodeTest(mimeType: string): Promise<boolean> {\n  try {\n    const blob = await canvasEncode(new ImageData(1, 1), mimeType);\n    // According to the spec, the blob should be null if the format isn't supported…\n    if (!blob) return false;\n    // …but Safari & Firefox fall back to PNG, so we need to check the mime type.\n    return blob.type === mimeType;\n  } catch (err) {\n    return false;\n  }\n}\n","import * as SSIM from \"ssim.js\";\nimport { ButteraugliOptions } from \"../../lib/diff.js\";\nimport { AnalyzeResult, ImageWorker, InputImage } from \"./image-worker.ts\";\n\ninterface SimpleField {\n\tenabled: boolean;\n}\n\ninterface Field<T> extends SimpleField {\n\toptions: T;\n}\n\nexport interface QualityOptions {\n\tSSIM: Field<SSIM.Options>;\n\tPSNR: SimpleField;\n\tbutteraugli: Field<ButteraugliOptions>;\n}\n\nexport interface MeasureOptions extends QualityOptions {\n\tversion: number;\n\tworkerCount: number;\n\n\tencodeTime: SimpleField;\n}\n\nfunction rgbaToImage(buffer: ArrayBufferLike, width: number, height: number) {\n\tconst channels = buffer.byteLength / width / height;\n\tif (channels !== 4) {\n\t\tthrow new Error(\"Buffer must be a 8-bit depth RGBA array\");\n\t}\n\tconst canvas = document.createElement(\"canvas\");\n\tconst ctx = canvas.getContext(\"2d\");\n\tif (!ctx) {\n\t\tthrow new Error(\"Could not create canvas context\");\n\t}\n\tconst imageData = ctx.createImageData(width, height);\n\timageData.data.set(new Uint8ClampedArray(buffer));\n\treturn imageData;\n}\n\nexport interface MetricMeta {\n\tkey: string;\n\tname: string;\n}\n\n\ninterface MetricsType {\n\tname: string;\n\timmediately?: boolean;\n\n\tcalc(\n\t\tworker: ImageWorker,\n\t\toriginal: InputImage,\n\t\tresult: AnalyzeResult,\n\t\toptions: any\n\t): void | Promise<void>;\n}\n\ninterface BoundCalc {\n\toptions: any;\n\tcalc: MetricsType[\"calc\"];\n}\n\nconst handlers: Record<string, MetricsType> = {\n\tratio: {\n\t\tname: \"Compression Ratio %\",\n\t\timmediately: true,\n\t\tcalc(worker, original, result) {\n\t\t\tconst { metrics, file } = result;\n\t\t\tmetrics.ratio = file.size / original.file.size * 100;\n\t\t},\n\t},\n\tSSIM: {\n\t\tname: \"SSIM %\",\n\t\tasync calc(worker, original, result, options) {\n\t\t\tconst { data, metrics } = result;\n\t\t\tmetrics.SSIM = await worker.calcSSIM(data, options) * 100;\n\t\t},\n\t},\n\tPSNR: {\n\t\tname: \"PSNR (db)\",\n\t\tasync calc(worker, original, result) {\n\t\t\tconst { data, metrics } = result;\n\t\t\tmetrics.PSNR = await worker.calcPSNR(data);\n\t\t},\n\t},\n\tbutteraugli: {\n\t\tname: \"Butteraugli Score\",\n\t\tasync calc(worker, original, result, options) {\n\t\t\tconst { data, metrics } = result;\n\t\t\tconst { width, height } = data;\n\n\t\t\tconst { score, heatMap } = await worker.calcButteraugli(data, options);\n\t\t\tmetrics.butteraugli = score;\n\t\t\tresult.heatMap = rgbaToImage(heatMap, width, height);\n\t\t},\n\t},\n};\n\nexport interface Measurer {\n\tmetrics: MetricMeta[];\n\n\tcalculations: number;\n\n\texecute(original: InputImage, result: AnalyzeResult, onProgress: () => void): Promise<void>;\n}\n\nexport function createMeasurer(config: MeasureOptions, worker: ImageWorker) {\n\tconst metrics = [];\n\tconst used: BoundCalc[] = [];\n\n\tlet calculations = 0;\n\n\tfor (const key of Object.keys(handlers)) {\n\t\tconst { enabled, options } = (config as any)[key] ?? { enabled: true };\n\t\tif (!enabled) {\n\t\t\tcontinue;\n\t\t}\n\t\tconst { name, calc, immediately } = handlers[key];\n\t\tif (!immediately) {\n\t\t\tcalculations++;\n\t\t}\n\t\tused.push({ calc, options });\n\t\tmetrics.push({ key, name });\n\t}\n\n\tfunction execute(original: InputImage, result: AnalyzeResult, onProgress: () => void) {\n\t\tconst tasks = used\n\t\t\t.map(b => b.calc(worker, original, result, b.options))\n\t\t\t.filter(Boolean)\n\n\t\t\t// @ts-ignore\n\t\t\t.map(promise => promise.then(onProgress));\n\n\t\treturn Promise.all(tasks) as unknown as Promise<void>;\n\t}\n\n\treturn { calculations, metrics, execute } as Measurer;\n}\n","import { Dispatch, SetStateAction, useEffect, useState } from \"react\";\n\nexport interface ProgressState {\n\tvalue: number;\n\tmax: number;\n\terror?: string;\n\n\tincrease: () => void;\n\treset: (max: number) => void;\n\tsetError: Dispatch<string>;\n}\n\nexport function useProgress(initialMax = 1): ProgressState {\n\tconst [max, setMax] = useState(initialMax);\n\tconst [value, setValue] = useState(0);\n\tconst [error, setError] = useState<string>();\n\n\tfunction reset(max: number) {\n\t\tsetValue(0);\n\t\tsetMax(max);\n\t\tsetError(undefined);\n\t}\n\n\tfunction increase() {\n\t\tsetValue(v => v + 1);\n\t}\n\n\treturn { value, max, error, increase, reset, setError };\n}\n\n/** Alia of the setter type in React state hook */\nexport type Mutator<T> = Dispatch<SetStateAction<T>>;\n\nexport function deepUpdate<T>(updater: Mutator<T>, path: string, value: any) {\n\tconst parts = path.split(\".\");\n\n\tfunction recurs(current: any, index: number) {\n\t\tconst key = parts[index];\n\t\tlet localValue = value;\n\t\tif (index < parts.length - 1) {\n\t\t\tlocalValue = recurs(current[key], index + 1);\n\t\t}\n\t\treturn { ...current, [key]: localValue };\n\t}\n\n\treturn updater(current => recurs(current, 0));\n}\n\n/**\n * Enhanced mutator, designed to help mutate nested properties of an object.\n *\n * @example\n * const [value, setValue] = useState({ a: { b: { c: 0 } } });\n *\n * // The code that uses mutator:\n *\n * const setA = (newValue) => setValue(prev => ({\n *     ...prev, a: newValue\n * });\n * const setC = (newValue) => setValue(prev => ({\n *     ...prev, a: {\n *         ...prev.a, b: {\n *             ...prev.b, c: newValue\n *         }\n *     }\n * });\n * const memoizedSetA = useCallback(setA, [setValue]);\n * const memoizedSetC = useCallback(setC, [setValue]);\n *\n * // Use merger instead:\n *\n * const memoizedSetA = getMerger(setValue).sub(\"a\");\n * const memoizedSetC = memoizedSetA.sub(\"b\").sub(\"c\");\n */\nexport interface Merger<T> {\n\n\t(value: SetStateAction<T>): void;\n\n\t/**\n\t * Internal usage, keep sub merger references.\n\t */\n\tcache: Map<any, Merger<any>>;\n\n\t/**\n\t * Convenient function to copies properties to current value.\n\t */\n\tmerge(changes: Partial<T>): void;\n\n\t/**\n\t * Convenient function to change a property of current value.\n\t *\n\t * @param key the property name\n\t * @param value the new value\n\t */\n\tset<K extends keyof T>(key: K, value: T[K]): void;\n\n\t/**\n\t * Get the child merger for specified property, when the merger mutate its value,\n\t * the new value will be merged into the parent object recursively.\n\t *\n\t * The child merger is cached, call this function on re-renders always returns the same reference.\n\t *\n\t * @param key the property name\n\t * @return the merger for specified property\n\t */\n\tsub<K extends keyof T>(key: K): Merger<T[K]>;\n}\n\nfunction derive<T>(merger: Merger<T>, key: keyof T) {\n\n\tfunction subSetValue(action: SetStateAction<any>) {\n\t\tif (typeof action !== \"function\") {\n\t\t\treturn merger.set(key, action);\n\t\t}\n\t\tmerger(prev => {\n\t\t\tconst newVal = action(prev[key]);\n\t\t\treturn { ...prev, [key]: newVal };\n\t\t});\n\t}\n\n\treturn getMerger<T[typeof key]>(subSetValue);\n}\n\n/**\n * Convert a mutator to a merger, the mutator identity must be stable and won't change on re-renders.\n */\nexport function getMerger<T>(mutator: Mutator<T>) {\n\tconst merger = mutator as Merger<T>;\n\n\tif (merger.cache) {\n\t\treturn merger;\n\t}\n\tmerger.cache = new Map();\n\n\tmerger.merge = changes => {\n\t\tmerger(prev => ({ ...prev, ...changes }));\n\t};\n\n\tmerger.set = (key, value) => {\n\t\tmerger(prev => ({ ...prev, [key]: value }));\n\t};\n\n\tmerger.sub = key => {\n\t\tlet cachedSetter = merger.cache.get(key);\n\t\tif (!cachedSetter) {\n\t\t\tcachedSetter = derive(merger, key);\n\t\t\tmerger.cache.set(key, cachedSetter);\n\t\t}\n\t\treturn cachedSetter;\n\t};\n\n\treturn merger;\n}\n\ntype LocalStorageState<T> = [T, Mutator<T>, () => void];\n\nexport function useLocalStorage<T>(key: string, processor: (saved?: T) => T) {\n\tconst [value, setValue] = useState(() => {\n\t\tconst v = localStorage.getItem(key);\n\t\treturn processor(v ? JSON.parse(v) : undefined);\n\t});\n\n\tfunction persist() {\n\t\tlocalStorage.setItem(key, JSON.stringify(value));\n\t}\n\n\tuseEffect(() => persist, [value]);\n\n\treturn [value, setValue, persist] as LocalStorageState<T>;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"drop\":\"UGOgT\",\"demoLabel\":\"FpHBy\",\"demo\":\"_CJdE\",\"error\":\"k55Mh\",\"card\":\"IzGvX\",\"demoIcon\":\"dbk9Y\",\"demoDescription\":\"v4CsW\",\"loading\":\"FIQtP\",\"ldsRipple\":\"zzYte\"};","import { fetchFile } from \"@kaciras/utilities/browser\";\nimport { Dispatch, useRef, useState } from \"react\";\nimport photo from \"../assets/demo/photo.jpg\";\nimport photoIcon from \"../assets/demo/photo-icon.jpg\";\nimport artwork from \"../assets/demo/artwork.png\";\nimport artworkIcon from \"../assets/demo/artwork-icon.png\";\nimport colorfulText from \"../assets/demo/colorful-text.png\";\nimport colorfulTextIcon from \"../assets/demo/colorful-text-icon.png\";\nimport { Button, Dialog, FileDrop } from \"../ui/index.ts\";\nimport { decode } from \"../features/decode.ts\";\nimport { InputImage } from \"../features/image-worker.ts\";\nimport styles from \"./SelectFileDialog.scss\";\nimport i18n from \"../i18n.ts\";\n\ninterface DemoButtonProps {\n\tdescription: string;\n\turl: string;\n\ticon: string;\n\tonClick: Dispatch<string>;\n}\n\nfunction DemoButton(props: DemoButtonProps) {\n\tconst { description, url, icon, onClick } = props;\n\n\tconst [loading, setLoading] = useState(false);\n\n\tasync function handleClick() {\n\t\tif (loading) {\n\t\t\treturn;\n\t\t}\n\t\tsetLoading(true);\n\t\ttry {\n\t\t\tawait onClick(url);\n\t\t} finally {\n\t\t\tsetLoading(false);\n\t\t}\n\t}\n\n\treturn (\n\t\t<button key={url} className={styles.card} onClick={handleClick}>\n\t\t\t<img\n\t\t\t\tsrc={icon}\n\t\t\t\talt=\"icon\"\n\t\t\t\tclassName={styles.demoIcon}\n\t\t\t/>\n\t\t\t{loading && <div className={styles.loading}/>}\n\t\t\t<span className={styles.demoDescription}>{description}</span>\n\t\t</button>\n\t);\n}\n\ninterface SelectFileDialogProps {\n\tonCancel: () => void;\n\tonChange: Dispatch<InputImage>;\n}\n\nexport default function SelectFileDialog(props: SelectFileDialogProps) {\n\tconst { onCancel, onChange } = props;\n\n\tconst abortController = useRef(new AbortController());\n\tconst [error, setError] = useState<Error>();\n\n\tfunction accept(file: File) {\n\t\tdecode(file)\n\t\t\t.then(raw => onChange({ file, raw }))\n\t\t\t.catch(setError);\n\t}\n\n\tfunction acceptUpload(files: File[]) {\n\t\taccept(files[0]);\n\t\tabortController.current.abort();\n\t}\n\n\tasync function acceptUrl(url: string) {\n\t\tconst newController = new AbortController();\n\t\tabortController.current.abort();\n\t\tabortController.current = newController;\n\n\t\tconst { signal } = newController;\n\t\ttry {\n\t\t\taccept(await fetchFile(url, { signal }));\n\t\t} catch (e) {\n\t\t\tif (e.name !== \"AbortError\") setError(e);\n\t\t}\n\t}\n\n\treturn (\n\t\t<Dialog onClose={onCancel}>\n\t\t\t<div className=\"dialog-content\">\n\t\t\t\t<FileDrop\n\t\t\t\t\tclassName={styles.drop}\n\t\t\t\t\taccept=\"image/*\"\n\t\t\t\t\tonChange={acceptUpload}\n\t\t\t\t\tonError={setError}\n\t\t\t\t\tonSelectStart={() => setError(undefined)}\n\t\t\t\t/>\n\t\t\t\t<span className={styles.demoLabel}>\n\t\t\t\t\t{i18n(\"OrTryOneOfThese\")}:\n\t\t\t\t</span>\n\t\t\t\t<div className={styles.demo}>\n\t\t\t\t\t<DemoButton\n\t\t\t\t\t\tdescription=\"Large photo (488KB)\"\n\t\t\t\t\t\turl={photo}\n\t\t\t\t\t\ticon={photoIcon}\n\t\t\t\t\t\tonClick={acceptUrl}\n\t\t\t\t\t/>\n\t\t\t\t\t<DemoButton\n\t\t\t\t\t\tdescription=\"Artwork (894KB)\"\n\t\t\t\t\t\turl={artwork}\n\t\t\t\t\t\ticon={artworkIcon}\n\t\t\t\t\t\tonClick={acceptUrl}\n\t\t\t\t\t/>\n\t\t\t\t\t<DemoButton\n\t\t\t\t\t\tdescription=\"Colorful text (68KB)\"\n\t\t\t\t\t\turl={colorfulText}\n\t\t\t\t\t\ticon={colorfulTextIcon}\n\t\t\t\t\t\tonClick={acceptUrl}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"dialog-actions\">\n\t\t\t\t<span className={styles.error}>{error?.message}</span>\n\t\t\t\t<Button className=\"second\" onClick={onCancel}>Back</Button>\n\t\t\t</div>\n\t\t</Dialog>\n\t);\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"dialog\":\"Zg_iv\",\"header\":\"LdDfs\",\"title\":\"L4mIk\",\"tab\":\"bq4uZ\",\"canvas\":\"W6BCk\",\"attributes\":\"l9BSp\"};","import { dataSizeIEC } from \"@kaciras/utilities/browser\";\nimport i18n from \"../i18n.ts\";\nimport { TabPanelBase } from \"../ui/TabSwitch.tsx\";\nimport { drawImage } from \"../utils.ts\";\nimport { InputImage } from \"../features/image-worker.ts\";\nimport styles from \"./ImageInfoPanel.scss\";\n\ninterface ImageInfoPanelProps extends TabPanelBase {\n\tvalue: InputImage;\n}\n\nexport default function ImageInfoPanel(props: ImageInfoPanelProps) {\n\tconst { isActive, value } = props;\n\tconst { file, raw } = value;\n\tconst { width, height, data } = raw;\n\n\tif (isActive === false) {\n\t\treturn null;\n\t}\n\n\tconst ratio = (file.size / data.byteLength * 100).toFixed(2);\n\n\treturn (\n\t\t<div className=\"dialog-content\" role=\"tabpanel\">\n\t\t\t<canvas\n\t\t\t\tclassName={styles.canvas}\n\t\t\t\taria-label={i18n(\"Preview\")}\n\t\t\t\tref={el => drawImage(raw, el)}\n\t\t\t\twidth={width}\n\t\t\t\theight={height}\n\t\t\t/>\n\t\t\t<dl className={styles.attributes}>\n\t\t\t\t<dt>{i18n(\"FileName\")}:</dt>\n\t\t\t\t<dd>{file.name}</dd>\n\n\t\t\t\t<dt>{i18n(\"FileType\")}:</dt>\n\t\t\t\t<dd>{file.type}</dd>\n\n\t\t\t\t<dt>{i18n(\"Resolution\")}:</dt>\n\t\t\t\t<dd>{width} x {height}</dd>\n\n\t\t\t\t<dt>{i18n(\"RawSize\")}:</dt>\n\t\t\t\t<dd>{dataSizeIEC.formatDiv(data.byteLength)}</dd>\n\n\t\t\t\t<dt>{i18n(\"FileSizeAndRatio\")}:</dt>\n\t\t\t\t<dd>{dataSizeIEC.formatDiv(file.size)} ({ratio}%)</dd>\n\t\t\t</dl>\n\t\t</div>\n\t);\n}\n","import ssim, { Options } from \"ssim.js\";\nimport metrics, { ButteraugliDiff, ButteraugliOptions, MetricsModule } from \"./diff.js\";\n\nexport type SSIMOptions = Partial<Options>;\nexport type { ButteraugliOptions };\n\nexport const defaultButteraugliOptions: ButteraugliOptions = {\n\thfAsymmetry: 1.0,\n\tgoodQualitySeek: 1.5,\n\tbadQualitySeek: 0.5,\n};\n\nlet loadPromise: Promise<void> | undefined;\n\nlet wasmModule: MetricsModule;\n\n/**\n * Initialize WebAssembly module, you must call this function before butteraugli()\n *\n * @param wasmUrl Url of metrics.wasm, If omitted, use the file in the same directory.\n */\nexport function initWasmModule(wasmUrl?: string) {\n\tif (loadPromise) {\n\t\treturn loadPromise;\n\t}\n\tconst init = wasmUrl ? metrics({ locateFile: () => wasmUrl }) : metrics();\n\treturn loadPromise = init.then(m => { wasmModule = m; });\n}\n\nfunction check(image0: ImageData, image1: ImageData) {\n\tconst len0 = image0.data.byteLength;\n\tconst len1 = image1.data.byteLength;\n\n\tif (len0 !== len1) {\n\t\tthrow new Error(`Image data have different length ${len0} vs. ${len1}`);\n\t}\n\n\tconst channels = len0 / image0.width / image0.height;\n\tif (channels !== 3 && channels !== 4) {\n\t\tthrow new Error(\"Image must be RGB or RGBA in colors\");\n\t}\n\n\tif (image0.width !== image1.width) {\n\t\tthrow new Error(`Image have different width ${image0.width} vs. ${image1.width}`);\n\t}\n\tif (image0.height !== image1.height) {\n\t\tthrow new Error(`Image have different width ${image0.height} vs. ${image1.height}`);\n\t}\n}\n\nexport class Butteraugli {\n\n\tprivate readonly native: ButteraugliDiff;\n\tprivate readonly reference: ImageData;\n\n\tconstructor(image: ImageData) {\n\t\tthis.reference = image;\n\t\tthis.native = new wasmModule.ButteraugliDiff(image);\n\t}\n\n\tclose() {\n\t\tthis.native.delete();\n\t}\n\n\tdiff(image: ImageData, options?: Partial<ButteraugliOptions>) {\n\t\tif (!loadPromise) {\n\t\t\tthrow new Error(\"Wasm module not load\");\n\t\t}\n\t\tcheck(this.reference, image);\n\n\t\tconst merged = { ...defaultButteraugliOptions, ...options };\n\n\t\tif (merged.badQualitySeek < 0 || merged.badQualitySeek >= 2) {\n\t\t\tthrow new Error(\"badQualitySeek must between 0, 2\");\n\t\t}\n\t\tif (merged.goodQualitySeek < 0 || merged.goodQualitySeek >= 2) {\n\t\t\tthrow new Error(\"goodQualitySeek must between 0, 2\");\n\t\t}\n\n\t\treturn this.native.Diff(image.data, merged);\n\t}\n}\n\nexport function getPSNR(image0: ImageData, image1: ImageData) {\n\tif (!wasmModule) {\n\t\tthrow new Error(\"Wasm module not loaded\");\n\t}\n\tcheck(image0, image1);\n\n\tconst dataA = image0.data;\n\tconst dataB = image1.data;\n\tconst { length } = dataA;\n\n\tlet sse = 0;\n\tfor (let i = 0; i < length; i++) {\n\t\tconst e = dataA[i] - dataB[i];\n\t\tsse += e * e;\n\t}\n\treturn 10 * Math.log10(255 * 255 / sse * length);\n}\n\nexport function getSSIM(image0: ImageData, image1: ImageData, options?: SSIMOptions) {\n\treturn ssim(image0, image1, options).mssim;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"form\":\"ythjm dialog-content\",\"subfields\":\"pqrw6\",\"field\":\"wUeLr\",\"inlineLabel\":\"QQbNk\",\"label\":\"Uafzz\",\"select\":\"mBcvZ\"};","import { ChangeEvent, ReactNode, useCallback } from \"react\";\nimport * as ssimJs from \"ssim.js\";\nimport { defaultButteraugliOptions } from \"../../lib/similarity.ts\";\nimport { CheckBox, NumberInput } from \"../ui/index.ts\";\nimport { TabPanelBase } from \"../ui/TabSwitch.tsx\";\nimport { MeasureOptions } from \"../features/measurement.ts\";\nimport styles from \"./MeasurePanel.scss\";\nimport i18n from \"../i18n.ts\";\nimport { deepUpdate, Mutator } from \"../hooks.ts\";\n\nexport function getMeasureOptions(saved?: MeasureOptions) {\n\tif (saved) {\n\t\treturn saved;\n\t}\n\treturn {\n\t\tversion: 1,\n\t\tworkerCount: navigator.hardwareConcurrency,\n\n\t\tencodeTime: {\n\t\t\tenabled: false,\n\t\t},\n\t\tSSIM: {\n\t\t\tenabled: true,\n\t\t\toptions: ssimJs.getOptions(),\n\t\t},\n\t\tPSNR: {\n\t\t\tenabled: false,\n\t\t},\n\t\tbutteraugli: {\n\t\t\tenabled: false,\n\t\t\toptions: defaultButteraugliOptions,\n\t\t},\n\t};\n}\n\ninterface LabelWrapperProps {\n\tlabel: string;\n\tchildren: ReactNode;\n}\n\nfunction LabelWrapper(props: LabelWrapperProps) {\n\tconst { label, children } = props;\n\treturn (\n\t\t<label className={styles.field}>\n\t\t\t<span className={styles.label}>\n\t\t\t\t{label}\n\t\t\t</span>\n\t\t\t{children}\n\t\t</label>\n\t);\n}\n\ntype InputTypes = HTMLInputElement | HTMLSelectElement;\n\n// Cannot use InputTypes for el as `Element.tagName` is not a literal.\nfunction detectInputValue(el: any) {\n\tswitch (el.tagName) {\n\t\tcase \"SELECT\":\n\t\t\treturn el.value;\n\t}\n\tswitch (el.type) {\n\t\tcase \"number\":\n\t\t\treturn el.valueAsNumber;\n\t\tcase \"checkbox\":\n\t\t\treturn el.checked;\n\t\tdefault:\n\t\t\treturn el.value;\n\t}\n}\n\nexport interface MeasurePanelProps extends TabPanelBase {\n\thasEncodePhase?: boolean;\n\tvalue: MeasureOptions;\n\tonChange: Mutator<MeasureOptions>;\n}\n\nexport default function MeasurePanel(props: MeasurePanelProps) {\n\tconst { isActive, hasEncodePhase, value, onChange } = props;\n\tconst { workerCount, encodeTime, SSIM, PSNR, butteraugli } = value;\n\n\tlet handleChange = (event: ChangeEvent<InputTypes>) => {\n\t\tconst { currentTarget } = event;\n\t\tconst newValue = detectInputValue(currentTarget);\n\t\tdeepUpdate(onChange, currentTarget.name, newValue);\n\t};\n\n\thandleChange = useCallback(handleChange, []);\n\n\tif (isActive === false) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<form className={styles.form} role=\"tabpanel\">\n\t\t\t<label>\n\t\t\t\t<span className={styles.inlineLabel}>\n\t\t\t\t\t{i18n(\"ThreadCount\")}:\n\t\t\t\t</span>\n\t\t\t\t<NumberInput\n\t\t\t\t\tname=\"workerCount\"\n\t\t\t\t\tvalue={workerCount}\n\t\t\t\t\tmin={1}\n\t\t\t\t\tstep={1}\n\t\t\t\t\tonChange={handleChange}\n\t\t\t\t/>\n\t\t\t</label>\n\n\t\t\t{\n\t\t\t\thasEncodePhase &&\n\t\t\t\t<CheckBox\n\t\t\t\t\tchecked={encodeTime.enabled}\n\t\t\t\t\tname=\"encodeTime.enabled\"\n\t\t\t\t\tonChange={handleChange}\n\t\t\t\t>\n\t\t\t\t\t{i18n(\"MeasureEncodeTime\")}:\n\t\t\t\t</CheckBox>\n\t\t\t}\n\n\t\t\t<CheckBox\n\t\t\t\tchecked={PSNR.enabled}\n\t\t\t\tname=\"PSNR.enabled\"\n\t\t\t\tonChange={handleChange}\n\t\t\t>\n\t\t\t\t{i18n(\"MeasurePSNR\")}\n\t\t\t</CheckBox>\n\n\t\t\t<CheckBox\n\t\t\t\tchecked={SSIM.enabled}\n\t\t\t\tname=\"SSIM.enabled\"\n\t\t\t\tonChange={handleChange}\n\t\t\t>\n\t\t\t\t{i18n(\"MeasureSSIM\")}\n\t\t\t</CheckBox>\n\t\t\t<fieldset className={styles.subfields}>\n\t\t\t\t<LabelWrapper label=\"Algorithm\">\n\t\t\t\t\t<select\n\t\t\t\t\t\tname=\"SSIM.options.ssim\"\n\t\t\t\t\t\tvalue={SSIM.options.ssim}\n\t\t\t\t\t\tclassName={styles.select}\n\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t>\n\t\t\t\t\t\t<option>fast</option>\n\t\t\t\t\t\t<option>original</option>\n\t\t\t\t\t\t<option>bezkrovny</option>\n\t\t\t\t\t\t<option>weber</option>\n\t\t\t\t\t</select>\n\t\t\t\t</LabelWrapper>\n\t\t\t\t<LabelWrapper label=\"k1\">\n\t\t\t\t\t<NumberInput\n\t\t\t\t\t\tname=\"SSIM.options.k1\"\n\t\t\t\t\t\tvalue={SSIM.options.k1}\n\t\t\t\t\t\tmin={0}\n\t\t\t\t\t\tstep={0.01}\n\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t/>\n\t\t\t\t</LabelWrapper>\n\t\t\t\t<LabelWrapper label=\"k2\">\n\t\t\t\t\t<NumberInput\n\t\t\t\t\t\tname=\"SSIM.options.k2\"\n\t\t\t\t\t\tvalue={SSIM.options.k2}\n\t\t\t\t\t\tmin={0}\n\t\t\t\t\t\tstep={0.01}\n\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t/>\n\t\t\t\t</LabelWrapper>\n\t\t\t\t<LabelWrapper label=\"window size\">\n\t\t\t\t\t<NumberInput\n\t\t\t\t\t\tname=\"SSIM.options.windowSize\"\n\t\t\t\t\t\tvalue={SSIM.options.windowSize}\n\t\t\t\t\t\tmin={1}\n\t\t\t\t\t\tstep={1}\n\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t/>\n\t\t\t\t</LabelWrapper>\n\t\t\t</fieldset>\n\n\t\t\t<CheckBox\n\t\t\t\tname=\"butteraugli.enabled\"\n\t\t\t\tchecked={butteraugli.enabled}\n\t\t\t\tonChange={handleChange}\n\t\t\t>\n\t\t\t\tButteraugli\n\t\t\t</CheckBox>\n\t\t\t<fieldset className={styles.subfields}>\n\t\t\t\t<LabelWrapper label=\"hf-asymmetry\">\n\t\t\t\t\t<NumberInput\n\t\t\t\t\t\tname=\"butteraugli.options.hfAsymmetry\"\n\t\t\t\t\t\tvalue={butteraugli.options.hfAsymmetry}\n\t\t\t\t\t\tmin={0}\n\t\t\t\t\t\tmax={2}\n\t\t\t\t\t\tstep={0.1}\n\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t/>\n\t\t\t\t</LabelWrapper>\n\t\t\t\t<LabelWrapper label=\"goodQualitySeek\">\n\t\t\t\t\t<NumberInput\n\t\t\t\t\t\tname=\"butteraugli.options.goodQualitySeek\"\n\t\t\t\t\t\tvalue={butteraugli.options.goodQualitySeek}\n\t\t\t\t\t\tmin={0}\n\t\t\t\t\t\tmax={2}\n\t\t\t\t\t\tstep={0.1}\n\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t/>\n\t\t\t\t</LabelWrapper>\n\t\t\t\t<LabelWrapper label=\"badQualitySeek\">\n\t\t\t\t\t<NumberInput\n\t\t\t\t\t\tname=\"butteraugli.options.badQualitySeek\"\n\t\t\t\t\t\tvalue={butteraugli.options.badQualitySeek}\n\t\t\t\t\t\tmin={0}\n\t\t\t\t\t\tmax={2}\n\t\t\t\t\t\tstep={0.1}\n\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t/>\n\t\t\t\t</LabelWrapper>\n\t\t\t</fieldset>\n\t\t</form>\n\t);\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"L_iEW dialog-content\",\"tablist\":\"KeoMs\",\"tab\":\"klA_i\",\"active\":\"KrAuU\",\"name\":\"eQrOv\",\"form\":\"JFomU\"};","// extracted by mini-css-extract-plugin\nexport default {\"form\":\"cDgD4\",\"default\":\"OkYG8\",\"constant\":\"HTzgE OkYG8\",\"variable\":\"A9apK OkYG8\"};","import { memo, ReactNode } from \"react\";\nimport clsx from \"clsx\";\nimport { BsSliders, BsType } from \"react-icons/bs\";\nimport { OptionState, OptionStateMap, OptionType } from \"./index.ts\";\nimport { Button } from \"../ui/index.ts\";\nimport { Merger } from \"../hooks.ts\";\nimport styles from \"./OptionsForm.scss\";\n\ninterface OptionProps {\n\ttemplate: OptionType;\n\tstate: OptionState;\n\tonChange: Merger<OptionState>;\n}\n\nconst Option = memo((props: OptionProps) => {\n\tconst { template, state, onChange } = props;\n\tconst { isVariable } = state;\n\tconst { OptionField } = template;\n\n\tlet title: string;\n\tlet clazz: string;\n\tlet iconChildren: ReactNode;\n\n\tif (isVariable) {\n\t\tclazz = styles.variable;\n\t\ttitle = \"Range Mode\";\n\t\ticonChildren = <BsSliders/>;\n\t} else {\n\t\tclazz = styles.constant;\n\t\ttitle = \"Constant Mode\";\n\t\ticonChildren = <BsType/>;\n\t}\n\n\tfunction toggle() {\n\t\tonChange.set(\"isVariable\", !isVariable);\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<Button\n\t\t\t\tclassName={clazz}\n\t\t\t\ttitle={title}\n\t\t\t\ttype=\"text\"\n\t\t\t\tonClick={toggle}\n\t\t\t>\n\t\t\t\t{iconChildren}\n\t\t\t</Button>\n\t\t\t<OptionField\n\t\t\t\t{...state}\n\t\t\t\tonValueChange={onChange.sub(\"value\")}\n\t\t\t\tonRangeChange={onChange.sub(\"range\")}\n\t\t\t/>\n\t\t</>\n\t);\n});\n\nOption.displayName = \"Option\";\n\nexport interface OptionsFormProps {\n\tclassName?: string;\n\ttemplates: OptionType[];\n\tstate: OptionStateMap;\n\tonChange: Merger<OptionStateMap>;\n}\n\nexport default function OptionsForm(props: OptionsFormProps) {\n\tconst { templates, className, state, onChange } = props;\n\n\tconst items = templates.map(template => {\n\t\tconst { id } = template;\n\n\t\treturn (\n\t\t\t<Option\n\t\t\t\ttemplate={template}\n\t\t\t\tkey={id}\n\t\t\t\tstate={state[id]}\n\t\t\t\tonChange={onChange.sub(id)}\n\t\t\t/>\n\t\t);\n\t});\n\n\treturn <form className={clsx(styles.form, className)}>{items}</form>;\n}\n","import React, { useState } from \"react\";\nimport clsx from \"clsx\";\nimport { TabPanelBase } from \"../ui/TabSwitch.tsx\";\nimport { CheckBox } from \"../ui/index.ts\";\nimport { stopPropagation } from \"../utils.ts\";\nimport { OptionStateMap } from \"../form/index.ts\";\nimport { ENCODER_MAP, ENCODERS, ImageEncoder } from \"../codecs/index.ts\";\nimport styles from \"./EncoderPanel.scss\";\nimport OptionsForm from \"../form/OptionsForm.tsx\";\nimport { Merger } from \"../hooks.ts\";\n\nexport interface EncoderConfig {\n\tenable: boolean;\n\tstate: OptionStateMap;\n}\n\nexport type EncodingOptions = Record<string, EncoderConfig>;\n\nfunction newState(encoder: ImageEncoder) {\n\tconst state: OptionStateMap = {};\n\n\tfor (const t of encoder.templates) {\n\t\tconst [value, range] = t.createState();\n\t\tstate[t.id] = { value, range, isVariable: false };\n\t}\n\treturn state;\n}\n\nexport function getEncodingOptions(saved?: EncodingOptions) {\n\tconst config = saved ?? {};\n\n\tfor (const encoder of ENCODERS) {\n\t\tconfig[encoder.name] ??= {\n\t\t\tenable: false,\n\t\t\tstate: newState(encoder),\n\t\t};\n\t}\n\tif (!saved) {\n\t\tconst { quality } = config.WebP.state;\n\t\tconfig.WebP.enable = true;\n\t\tquality.range.step = 5;\n\t\tquality.isVariable = true;\n\t}\n\treturn config;\n}\n\nexport interface EncoderPanelProps extends TabPanelBase {\n\tvalue: EncodingOptions;\n\tonChange: Merger<EncodingOptions>;\n}\n\nfunction EncoderPanel(props: EncoderPanelProps) {\n\tconst { isActive, value, onChange } = props;\n\n\tconst [current, setCurrent] = useState(\"WebP\");\n\n\tconst tabs = ENCODERS.map(({ name }) => {\n\t\tconst classes = clsx(\n\t\t\tstyles.tab,\n\t\t\tname === current && styles.active,\n\t\t);\n\n\t\tconst handleEnableChange = onChange.sub(name).sub(\"enable\");\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\tclassName={classes}\n\t\t\t\tkey={name}\n\t\t\t\ttype=\"button\"\n\t\t\t\tonClick={() => setCurrent(name)}\n\t\t\t>\n\t\t\t\t<CheckBox\n\t\t\t\t\tchecked={value[name].enable}\n\t\t\t\t\tonClick={stopPropagation}\n\t\t\t\t\tonCheckedChange={handleEnableChange}\n\t\t\t\t/>\n\t\t\t\t<span className={styles.name}>{name}</span>\n\t\t\t</button>\n\t\t);\n\t});\n\n\t// EncoderPanel is expensive to render, so we just hide it when inactive.\n\tconst classes = clsx(\n\t\tstyles.container,\n\t\tisActive === false && \"hidden\",\n\t);\n\n\treturn (\n\t\t<div className={classes} role=\"tabpanel\">\n\t\t\t<div className={styles.tablist}>\n\t\t\t\t{tabs}\n\t\t\t</div>\n\t\t\t<OptionsForm\n\t\t\t\ttemplates={ENCODER_MAP[current].templates}\n\t\t\t\tclassName={styles.form}\n\t\t\t\tstate={value[current].state}\n\t\t\t\tonChange={onChange.sub(current).sub(\"state\")}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n\nexport default React.memo(EncoderPanel);\n","// extracted by mini-css-extract-plugin\nexport default {\"dialog\":\"Hfe29\",\"header\":\"S_q85\",\"title\":\"jzzhN\",\"tab\":\"EiM0W\"};","import { Dispatch, useState } from \"react\";\nimport { MeasureOptions } from \"../features/measurement.ts\";\nimport { InputImage } from \"../features/image-worker.ts\";\nimport { getMerger, useLocalStorage } from \"../hooks.ts\";\nimport { Button, Dialog, TabList, TabSwitch } from \"../ui/index.ts\";\nimport ImageInfoPanel from \"./ImageInfoPanel.tsx\";\nimport MeasurePanel, { getMeasureOptions } from \"./MeasurePanel.tsx\";\nimport EncoderPanel, { EncodingOptions, getEncodingOptions } from \"./EncoderPanel.tsx\";\nimport styles from \"./CompressConfigDialog.scss\";\nimport i18n from \"../i18n.ts\";\n\nexport interface AnalyzeConfig {\n\tencoding: EncodingOptions;\n\tmeasurement: MeasureOptions;\n}\n\nexport interface CompressConfigDialogProps {\n\timage: InputImage;\n\tonStart: Dispatch<AnalyzeConfig>;\n\tonClose: () => void;\n\tonSelectFile: () => void;\n}\n\nexport default function CompressConfigDialog(props: CompressConfigDialogProps) {\n\tconst { image, onStart, onClose, onSelectFile } = props;\n\n\tconst [index, setIndex] = useState(0);\n\tconst [encoding, setEncoding] = useLocalStorage(\"Encoding\", getEncodingOptions);\n\tconst [measurement, setMeasurement] = useLocalStorage(\"Measure\", getMeasureOptions);\n\n\tfunction start() {\n\t\tonStart({ encoding, measurement });\n\t}\n\n\tconst ready = image && Object.values(encoding).some(e => e.enable);\n\n\treturn (\n\t\t<Dialog\n\t\t\tname={i18n(\"AnalysisConfig\")}\n\t\t\tclassName={styles.dialog}\n\t\t\tonClose={onClose}\n\t\t>\n\t\t\t<TabList\n\t\t\t\tclassName={styles.header}\n\t\t\t\tindex={index}\n\t\t\t\tonChange={setIndex}\n\t\t\t>\n\t\t\t\t<button type=\"button\" className={styles.tab}>{i18n(\"Information\")}</button>\n\t\t\t\t<button type=\"button\" className={styles.tab}>{i18n(\"Encoders\")}</button>\n\t\t\t\t<button type=\"button\" className={styles.tab}>{i18n(\"Analysis\")}</button>\n\t\t\t</TabList>\n\n\t\t\t<TabSwitch index={index}>\n\t\t\t\t<ImageInfoPanel\n\t\t\t\t\tvalue={image}\n\t\t\t\t/>\n\t\t\t\t<EncoderPanel\n\t\t\t\t\tvalue={encoding}\n\t\t\t\t\tonChange={getMerger(setEncoding)}\n\t\t\t\t/>\n\t\t\t\t<MeasurePanel\n\t\t\t\t\thasEncodePhase={true}\n\t\t\t\t\tvalue={measurement}\n\t\t\t\t\tonChange={setMeasurement}\n\t\t\t\t/>\n\t\t\t</TabSwitch>\n\n\t\t\t<div className=\"dialog-actions\">\n\t\t\t\t<Button onClick={onSelectFile}>{i18n(\"SelectFile\")}...</Button>\n\t\t\t\t<Button className=\"second\" onClick={onClose}>{i18n(\"Cancel\")}</Button>\n\t\t\t\t<Button disabled={!ready} onClick={start}>{i18n(\"Start\")}</Button>\n\t\t\t</div>\n\t\t</Dialog>\n\t);\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"content\":\"TPOjK dialog-content\",\"text\":\"u_6aN\",\"error\":\"J6RrZ\",\"progress\":\"PrOo_\",\"buttons\":\"KregG dialog-actions\"};","import { useEffect, useRef, useState } from \"react\";\nimport i18n from \"../i18n.ts\";\nimport { Button, Dialog } from \"../ui/index.ts\";\nimport styles from \"./ProgressDialog.scss\";\n\ninterface ProgressDialogProps {\n\terror?: string;\n\tmax: number;\n\tvalue: number;\n\tonCancel: () => void;\n}\n\nexport default function ProgressDialog(props: ProgressDialogProps) {\n\tconst { value, max, error, onCancel } = props;\n\n\tconst startTime = useRef(performance.now());\n\tconst timer = useRef(0);\n\tconst [timeUsage, setTimeUsage] = useState(\"--:--:--\");\n\n\tfunction scheduleTimer() {\n\n\t\tfunction refresh() {\n\t\t\tconst ms = performance.now() - startTime.current;\n\t\t\tconst date = new Date(ms);\n\t\t\tsetTimeUsage(date.toISOString().substr(11, 8));\n\t\t}\n\n\t\ttimer.current = window.setInterval(refresh, 1000);\n\t\treturn () => window.clearInterval(timer.current);\n\t}\n\n\tfunction interruptOnError() {\n\t\tif (error) {\n\t\t\twindow.clearInterval(timer.current);\n\t\t}\n\t}\n\n\tuseEffect(scheduleTimer, []);\n\tuseEffect(interruptOnError, [error]);\n\n\treturn (\n\t\t<Dialog onClose={onCancel}>\n\t\t\t<div className={styles.content}>\n\t\t\t\t<h1>{i18n(\"Encoding\")}...</h1>\n\n\t\t\t\t{error && <p className={styles.error}>{i18n(\"Error\")}: {error}</p>}\n\n\t\t\t\t<div className={styles.text}>\n\t\t\t\t\t<span>{value} / {max}</span>\n\t\t\t\t\t<span>{i18n(\"ElapsedTime\")}: {timeUsage}</span>\n\t\t\t\t</div>\n\n\t\t\t\t<progress\n\t\t\t\t\tvalue={value}\n\t\t\t\t\tmax={max}\n\t\t\t\t\tclassName={styles.progress}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div className={styles.buttons}>\n\t\t\t\t<Button className=\"second\" onClick={onCancel}>{i18n(\"Cancel\")}</Button>\n\t\t\t</div>\n\t\t</Dialog>\n\t);\n}\n","import { cartesianObject, noop } from \"@kaciras/utilities/browser\";\nimport { Dispatch, useState } from \"react\";\nimport { buildProfiles, ENCODERS, ImageEncoder } from \"../codecs/index.ts\";\nimport { decode } from \"../features/decode.ts\";\nimport {\n\tAnalyzeResult,\n\tgetPooledWorker,\n\tImagePool,\n\tImageWorker,\n\tInputImage,\n\tnewImagePool,\n\tsetOriginalImage,\n} from \"../features/image-worker.ts\";\nimport { createMeasurer, Measurer } from \"../features/measurement.ts\";\nimport { useProgress } from \"../hooks.ts\";\nimport { AnalyzeContext } from \"./index.tsx\";\nimport SelectFileDialog from \"./SelectFileDialog.tsx\";\nimport CompressConfigDialog, { AnalyzeConfig } from \"./CompressConfigDialog.tsx\";\nimport ProgressDialog from \"./ProgressDialog.tsx\";\nimport i18n from \"../i18n.ts\";\n\ninterface EncodeTask {\n\tencoder: ImageEncoder;\n\tprofile: any;\n}\n\nclass EncodeAnalyzer {\n\n\tprivate readonly worker: ImageWorker;\n\n\tprivate readonly taskQueue: EncodeTask[] = [];\n\tprivate readonly measurer: Measurer;\n\n\treadonly outputSize: number;\n\n\tonProgress = noop;\n\n\tconstructor(config: AnalyzeConfig, worker: ImageWorker) {\n\t\tthis.worker = worker;\n\n\t\tthis.outputSize = 0;\n\t\tthis.measurer = createMeasurer(config.measurement, worker);\n\n\t\tif (config.measurement.encodeTime.enabled) {\n\t\t\tthis.measurer.metrics.push({ key: \"time\", name: i18n(\"EncodeTimeSecond\") });\n\t\t}\n\n\t\tfor (const encoder of ENCODERS) {\n\t\t\tconst { name } = encoder;\n\t\t\tconst { enable, state } = config.encoding[name];\n\t\t\tif (!enable) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst profile = buildProfiles(encoder, state);\n\t\t\tthis.outputSize += profile.size;\n\t\t\tthis.taskQueue.push({ encoder, profile });\n\t\t}\n\t}\n\n\tget TaskCount() {\n\t\treturn this.outputSize * (1 + this.measurer.calculations);\n\t}\n\n\tasync run(input: InputImage) {\n\t\tconst { measurer, taskQueue } = this;\n\n\t\tconst tasks = [];\n\t\tconst weightMap = new Map<string, number[]>();\n\t\tconst offsetMap = new Map<string, number>();\n\t\tconst controlsMap = Object.create(null);\n\n\t\tfor (const { encoder, profile } of taskQueue) {\n\t\t\tconst { variables, constants, controls, weights } = profile;\n\n\t\t\tcontrolsMap[encoder.name] = controls;\n\t\t\toffsetMap.set(encoder.name, tasks.length);\n\t\t\tweightMap.set(encoder.name, weights);\n\n\t\t\tfor (const mutation of cartesianObject(variables)) {\n\t\t\t\tconst options = { ...constants, ...mutation };\n\t\t\t\ttasks.push(this.process(input, encoder, options));\n\t\t\t}\n\t\t}\n\n\t\tconst seriesMeta = measurer.metrics;\n\t\tconst outputs = await Promise.all(tasks);\n\t\treturn { input, seriesMeta, controlsMap, outputs, offsetMap, weightMap };\n\t}\n\n\tprivate async process(input: InputImage, encoder: ImageEncoder, options: any) {\n\t\tconst { worker, measurer } = this;\n\t\tconst { extension, mimeType } = encoder;\n\n\t\tconst { buffer, time } = await encoder.encode(options, worker);\n\t\tthis.onProgress();\n\n\t\tconst filename = input.file.name.replace(/.[^.]*$/, `.${extension}`);\n\t\tconst file = new File([buffer], filename, { type: mimeType });\n\n\t\tconst output: AnalyzeResult = {\n\t\t\tfile,\n\t\t\tdata: await decode(file, worker),\n\t\t\tmetrics: { time },\n\t\t};\n\t\tawait measurer.execute(input, output, this.onProgress);\n\t\treturn output;\n\t}\n}\n\ninterface CompressSessionProps {\n\tisOpen: boolean;\n\tonChange: Dispatch<AnalyzeContext>;\n\tonClose: () => void;\n}\n\nexport default function CompressSession(props: CompressSessionProps) {\n\tconst { isOpen, onClose, onChange } = props;\n\n\tconst [selectFile, setSelectFile] = useState(true);\n\tconst [input, setInput] = useState<InputImage>();\n\tconst [imagePool, setImagePool] = useState<ImagePool>();\n\n\tconst progress = useProgress();\n\n\tfunction cancelSelectFile() {\n\t\tinput ? setSelectFile(false) : onClose();\n\t}\n\n\tasync function handleInputChange(image: InputImage) {\n\t\tsetInput(image);\n\t\tsetSelectFile(false);\n\t}\n\n\tasync function handleStart(config: AnalyzeConfig) {\n\t\tif (!input) {\n\t\t\tthrow new Error(\"File is null\");\n\t\t}\n\t\tconst { measurement } = config;\n\n\t\tconst imagePool = newImagePool(measurement.workerCount);\n\t\tconst worker = getPooledWorker(imagePool);\n\t\tconst analyzer = new EncodeAnalyzer(config, worker);\n\n\t\tprogress.reset(analyzer.TaskCount);\n\t\tanalyzer.onProgress = progress.increase;\n\t\tsetImagePool(imagePool);\n\n\t\ttry {\n\t\t\tawait setOriginalImage(imagePool, input);\n\t\t\tonChange(await analyzer.run(input));\n\t\t\tsetImagePool(undefined);\n\t\t} catch (e) {\n\t\t\t// Some browsers will crash the page on OOM.\n\t\t\tconsole.error(e);\n\t\t\tprogress.setError(e.message);\n\t\t} finally {\n\t\t\timagePool.terminate();\n\t\t}\n\t}\n\n\tfunction stop() {\n\t\timagePool!.terminate();\n\t\tsetImagePool(undefined);\n\t}\n\n\tif (!isOpen) {\n\t\treturn null;\n\t}\n\n\tif (imagePool) {\n\t\treturn (\n\t\t\t<ProgressDialog\n\t\t\t\tvalue={progress.value}\n\t\t\t\tmax={progress.max}\n\t\t\t\terror={progress.error}\n\t\t\t\tonCancel={stop}\n\t\t\t/>\n\t\t);\n\t} else if (selectFile) {\n\t\treturn (\n\t\t\t<SelectFileDialog\n\t\t\t\tonCancel={cancelSelectFile}\n\t\t\t\tonChange={handleInputChange}\n\t\t\t/>\n\t\t);\n\t} else {\n\t\treturn (\n\t\t\t<CompressConfigDialog\n\t\t\t\timage={input!}\n\t\t\t\tonStart={handleStart}\n\t\t\t\tonClose={onClose}\n\t\t\t\tonSelectFile={() => setSelectFile(true)}\n\t\t\t/>\n\t\t);\n\t}\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"header\":\"yJKBD\",\"banner\":\"L1TiO\",\"title\":\"_p6qL\",\"subTitle\":\"ESl2O\",\"bigButton\":\"vDu8Z\",\"github\":\"_6hzZZ\",\"unsplash\":\"y8Kpk\",\"link\":\"dzg8y\",\"section\":\"jH_ql\",\"links\":\"hzS8p jH_ql\",\"card\":\"oPIj1\"};","import clsx from \"clsx\";\nimport { TbBrandGithub } from \"react-icons/tb\";\nimport banner from \"../assets/intro-banner.png\";\nimport { Button } from \"../ui/index.ts\";\nimport styles from \"./IntroPage.scss\";\nimport i18n from \"../i18n.ts\";\n\ninterface IntroPageProps {\n\tonEncode: () => void;\n\tonCompare: () => void;\n}\n\nexport default function IntroPage(props: IntroPageProps) {\n\tconst { onEncode, onCompare } = props;\n\n\treturn (\n\t\t<>\n\t\t\t<section className={styles.header}>\n\t\t\t\t<img className={styles.banner} alt=\"banner\" src={banner}/>\n\n\t\t\t\t<div>\n\t\t\t\t\t<h1 className={styles.title}>\n\t\t\t\t\t\tICAnalyzer\n\t\t\t\t\t</h1>\n\t\t\t\t\t<h2 className={styles.subTitle}>\n\t\t\t\t\t\t{i18n(\"ICAnalyzerIntro\")}\n\t\t\t\t\t</h2>\n\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName={styles.bigButton}\n\t\t\t\t\t\ttype=\"outline\"\n\t\t\t\t\t\tonClick={onEncode}\n\t\t\t\t\t>\n\t\t\t\t\t\tConvert\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName={styles.bigButton}\n\t\t\t\t\t\ttype=\"outline\"\n\t\t\t\t\t\tonClick={onCompare}\n\t\t\t\t\t>\n\t\t\t\t\t\tCompare\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName={clsx(styles.bigButton, \"second\")}\n\t\t\t\t\t\ttype=\"outline\"\n\t\t\t\t\t\thref=\"https://github.com/Kaciras/ICAnalyzer\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<TbBrandGithub className={styles.github}/>\n\t\t\t\t\t\t{i18n(\"SourceCode\")}\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\n\t\t\t\t<div className={styles.unsplash}>\n\t\t\t\t\tPhoto by\n\t\t\t\t\t<a\n\t\t\t\t\t\tclassName={styles.link}\n\t\t\t\t\t\thref=\"https://unsplash.com/@veverkolog?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText\"\n\t\t\t\t\t>\n\t\t\t\t\t\tDušan veverkolog\n\t\t\t\t\t</a>\n\t\t\t\t\ton\n\t\t\t\t\t<a\n\t\t\t\t\t\tclassName={styles.link}\n\t\t\t\t\t\thref=\"https://unsplash.com/s/photos/eagle?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText\"\n\t\t\t\t\t>\n\t\t\t\t\t\tUnsplash\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t\t<section className={styles.links}>\n\t\t\t\t<div className={styles.card}>\n\t\t\t\t\t<h2>Documents</h2>\n\t\t\t\t\t<a href=\"https://github.com/Kaciras/ICAnalyzer/wiki/Tutorial-(Chinese)\">Tutorial (Chinese)</a>\n\t\t\t\t</div>\n\t\t\t\t<div className={styles.card}>\n\t\t\t\t\t<h2>Articles</h2>\n\t\t\t\t\t<a href=\"https://blog.kaciras.com/article/24/analyze-WebP-encode-options\">WebP 参数分析</a>\n\t\t\t\t\t<a href=\"https://blog.kaciras.com/article/23/icanalyzer-development-log\">ICAnalyzer 开发小记</a>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t</>\n\t);\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"darkNumberInput\":\"uy3Os\"};","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"whtRc\",\"tabPanel\":\"qJPp5 controls\",\"option\":\"TkDnU\",\"icon\":\"YQqTa\",\"main\":\"lJ0_5\",\"wrapper\":\"neMG8\",\"canvas\":\"CLvOQ\",\"controls\":\"vSPoB\",\"separator\":\"XSXEu\"};","import { MouseEvent, useEffect, useRef, useState } from \"react\";\nimport clsx from \"clsx\";\nimport { BsBrightnessHigh, BsEyedropper } from \"react-icons/bs\";\nimport { ButtonProps } from \"../ui/Button.tsx\";\nimport { PinchZoomState } from \"../ui/PinchZoom.tsx\";\nimport { Button, ColorPicker, NumberInput, PinchZoom, SwitchButton, ZoomControl } from \"../ui/index.ts\";\nimport { AnalyzeResult, InputImage } from \"../features/image-worker.ts\";\nimport theme from \"../theme.module.scss\";\nimport styles from \"./ImageView.scss\";\nimport { dragHandler, drawImage } from \"../utils.ts\";\nimport i18n from \"../i18n.ts\";\n\nexport enum ViewType {\n\tSplit,\n\tInput,\n\tOutput,\n\tDiff,\n\tHeatMap,\n}\n\nconst viewTypeNames = [\n\ti18n(\"SplitView\"),\n\ti18n(\"InputView\"),\n\ti18n(\"OutputView\"),\n\ti18n(\"DiffView\"),\n\ti18n(\"HeatMapView\"),\n];\n\ninterface ImageViewTabProps extends ButtonProps {\n\ttarget: string;\n}\n\nconst pinchZoomInit: PinchZoomState = {\n\tx: 0,\n\ty: 0,\n\tscale: 1,\n};\n\nexport interface ImageViewProps {\n\tclassName?: string;\n\toriginal: InputImage;\n\toutput: AnalyzeResult;\n}\n\nexport default function ImageView(props: ImageViewProps) {\n\tconst { original, output, className } = props;\n\tconst { width, height } = original.raw;\n\tconst { heatMap } = output;\n\n\tconst [pinchZoom, setPinchZoom] = useState(pinchZoomInit);\n\tconst [type, setType] = useState(ViewType.Output);\n\tconst [brightness, setBrightness] = useState(1);\n\tconst [picking, setPicking] = useState(false);\n\tconst [inRegion, setInRegion] = useState(false);\n\tconst [mousePos, setMousePos] = useState({ clientX: 0, clientY: 0 });\n\tconst [splitPoint, setSplitPoint] = useState(window.innerWidth / 2);\n\n\tconst backCanvas = useRef<HTMLCanvasElement>(null);\n\tconst topCanvas = useRef<HTMLCanvasElement>(null);\n\n\tconst topImage = (type === ViewType.HeatMap) ? heatMap! : output.data;\n\n\tfunction refreshBottomCanvas() {\n\t\tsetPinchZoom(pinchZoomInit);\n\t\tdrawImage(original.raw, backCanvas.current);\n\t}\n\n\tfunction refreshTopCanvas() {\n\t\tdrawImage(topImage, topCanvas.current);\n\t}\n\n\tuseEffect(refreshBottomCanvas, [original]);\n\tuseEffect(refreshTopCanvas, [topImage]);\n\n\tfunction handlePointerMove(event: MouseEvent) {\n\t\tconst { clientX, clientY } = event;\n\t\tsetMousePos({ clientX, clientY });\n\t}\n\n\tconst tabData = viewTypeNames.map<ImageViewTabProps>(target => ({ target }));\n\n\tif (!heatMap) {\n\t\ttabData[4].disabled = true;\n\t\ttabData[4].title = i18n(\"RequireButteraugli\");\n\t}\n\n\tconst imageViewTabs = tabData.map((data, index) => {\n\t\tconst { target, disabled, title } = data;\n\t\treturn (\n\t\t\t<Button\n\t\t\t\tkey={index}\n\t\t\t\tclassName=\"dark\"\n\t\t\t\ttype=\"text\"\n\t\t\t\tactive={type === index}\n\t\t\t\tdisabled={disabled}\n\t\t\t\ttitle={title}\n\t\t\t\tonClick={() => setType(index)}\n\t\t\t>\n\t\t\t\t{target}\n\t\t\t</Button>\n\t\t);\n\t});\n\n\tlet mixBlendMode = undefined;\n\tlet brightnessVal = 1;\n\tif (type === ViewType.Diff) {\n\t\tmixBlendMode = \"difference\" as const;\n\t\tbrightnessVal = brightness;\n\t}\n\n\tconst wrapperCSS = {\n\t\twidth, height,\n\t\t\"--scale\": pinchZoom.scale,\n\t\t\"--x\": pinchZoom.x + \"px\",\n\t\t\"--y\": pinchZoom.y + \"px\",\n\t\t\"--brightness\": `${brightnessVal}`,\n\t};\n\n\tconst splitCSS: any = type === ViewType.Split\n\t\t? { \"--split\": `${splitPoint}px` }\n\t\t: undefined;\n\n\tconst { clientX, clientY } = mousePos;\n\tconst px = Math.floor((clientX - pinchZoom.x - (window.innerWidth - width * pinchZoom.scale) / 2) / pinchZoom.scale);\n\tconst py = Math.floor((clientY - pinchZoom.y - (window.innerHeight - height * pinchZoom.scale) / 2) / pinchZoom.scale);\n\n\tconst pickerCSS = {\n\t\ttop: clientY,\n\t\tleft: clientX,\n\t};\n\n\tconst onPointerDown = dragHandler(e => {\n\t\tconst p = e.pageX;\n\t\tif (p > 0 && p < window.innerWidth) {\n\t\t\tsetSplitPoint(p); // Prevent move to out of window.\n\t\t}\n\t});\n\n\treturn (\n\t\t<div className={clsx(styles.container, className)} style={splitCSS}>\n\t\t\t<PinchZoom\n\t\t\t\tclassName={styles.main}\n\t\t\t\tstate={pinchZoom}\n\t\t\t\t// Can't zoom by mouse wheel if scale = 0\n\t\t\t\tonChange={v => v.scale > 0.01 && setPinchZoom(v)}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclassName={styles.wrapper}\n\t\t\t\t\tstyle={wrapperCSS}\n\t\t\t\t\tonPointerOver={() => setInRegion(true)}\n\t\t\t\t\tonPointerMove={handlePointerMove}\n\t\t\t\t\tonPointerOut={() => setInRegion(false)}\n\t\t\t\t>\n\t\t\t\t\t<canvas\n\t\t\t\t\t\tclassName={styles.canvas}\n\t\t\t\t\t\tref={backCanvas}\n\t\t\t\t\t\twidth={width}\n\t\t\t\t\t\theight={height}\n\t\t\t\t\t/>\n\t\t\t\t\t<canvas\n\t\t\t\t\t\tclassName={styles.canvas}\n\t\t\t\t\t\tref={topCanvas}\n\t\t\t\t\t\twidth={width}\n\t\t\t\t\t\theight={height}\n\t\t\t\t\t\tstyle={{ mixBlendMode }}\n\t\t\t\t\t\thidden={type === ViewType.Input}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</PinchZoom>\n\n\t\t\t<div\n\t\t\t\thidden={type !== ViewType.Split}\n\t\t\t\tclassName={styles.separator}\n\t\t\t\tonPointerDown={onPointerDown}\n\t\t\t/>\n\n\t\t\t<div className={styles.tabPanel}>\n\t\t\t\t<div>{imageViewTabs}</div>\n\n\t\t\t\t<div\n\t\t\t\t\tclassName={styles.option}\n\t\t\t\t\ttitle={i18n(\"PickColor\")}\n\t\t\t\t>\n\t\t\t\t\t<BsEyedropper className={styles.icon}/>\n\t\t\t\t\t<SwitchButton\n\t\t\t\t\t\tchecked={picking}\n\t\t\t\t\t\tonCheckedChange={setPicking}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t{\n\t\t\t\t\ttype === ViewType.Diff &&\n\t\t\t\t\t<label\n\t\t\t\t\t\tclassName={styles.option}\n\t\t\t\t\t\ttitle={i18n(\"Brightness\")}\n\t\t\t\t\t>\n\t\t\t\t\t\t<BsBrightnessHigh className={styles.icon}/>\n\t\t\t\t\t\t<NumberInput\n\t\t\t\t\t\t\tvalue={brightness}\n\t\t\t\t\t\t\tmin={1}\n\t\t\t\t\t\t\tmax={255}\n\t\t\t\t\t\t\tstep={1}\n\t\t\t\t\t\t\tminMaxButton={true}\n\t\t\t\t\t\t\tclassName={theme.darkNumberInput}\n\t\t\t\t\t\t\tonValueChange={setBrightness}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</label>\n\t\t\t\t}\n\t\t\t</div>\n\n\t\t\t<ZoomControl\n\t\t\t\tclassName={styles.controls}\n\t\t\t\tdefaultValue={pinchZoomInit}\n\t\t\t\tvalue={pinchZoom}\n\t\t\t\tonChange={setPinchZoom}\n\t\t\t/>\n\n\t\t\t{\n\t\t\t\tpicking && inRegion &&\n\t\t\t\t<ColorPicker\n\t\t\t\t\tstyle={pickerCSS}\n\t\t\t\t\tx={px}\n\t\t\t\t\ty={py}\n\t\t\t\t\timageA={original.raw}\n\t\t\t\t\timageB={output.data}\n\t\t\t\t/>\n\t\t\t}\n\t\t</div>\n\t);\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"OaOPZ controls\",\"chart\":\"wcsI3\",\"lock\":\"X8mfJ dark\"};","import { useEffect, useState } from \"react\";\nimport clsx from \"clsx\";\nimport Highcharts, { Chart, Options, SeriesLineOptions, YAxisOptions } from \"highcharts\";\nimport Export from \"highcharts/modules/exporting\";\nimport ExportOffline from \"highcharts/modules/offline-exporting\";\nimport { TbLockFilled } from \"react-icons/tb\";\nimport { Button } from \"../ui/index.ts\";\nimport { MetricMeta } from \"../features/measurement.ts\";\nimport { AnalyzeResult } from \"../features/image-worker.ts\";\nimport styles from \"./ChartPanel.scss\";\nimport i18n from \"../i18n.ts\";\n\nExport(Highcharts);\nExportOffline(Highcharts);\n\ndeclare module \"highcharts\" {\n\n\tinterface Options {\n\t\txLabel?: string;\n\t}\n}\n\nconst baseOptions: Options = {\n\taccessibility: {\n\t\tenabled: false,\n\t},\n\tchart: {\n\t\tstyledMode: true,\n\t\tanimation: false,\n\t},\n\ttitle: {\n\t\ttext: \"\",\n\t},\n\ttooltip: {\n\t\tborderRadius: 0,\n\t},\n\tlegend: {\n\t\tverticalAlign: \"top\",\n\t\twidth: 450,\n\n\t\t// Since legend item vary widely in width, disable align to use space more efficiently\n\t\talignColumns: false,\n\t},\n\txAxis: {\n\t\t// Avoid layout shift on Y axis changes\n\t\twidth: 430,\n\t},\n\tlang: {\n\t\tdownloadSVG: i18n(\"DownloadSVG\"),\n\t},\n\texporting: {\n\t\tmenuItemDefinitions: {\n\t\t\tdownloadExpand: {\n\t\t\t\ttext: i18n(\"DownloadFullAxis\"),\n\t\t\t\tonclick() {\n\t\t\t\t\tconst yAxis = new Array(this.yAxis.length);\n\t\t\t\t\tyAxis.fill({ visible: true });\n\n\t\t\t\t\tconst optionsMixin = {\n\t\t\t\t\t\tyAxis,\n\t\t\t\t\t\txAxis: {\n\t\t\t\t\t\t\ttitle: {\n\t\t\t\t\t\t\t\ttext: this.options.xLabel,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tplotLines: [],\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlegend: {\n\t\t\t\t\t\t\tlabelFormat: \"{name}\",\n\t\t\t\t\t\t\tlabelFormatter: undefined,\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\tthis.exportChartLocal({ type: \"image/svg+xml\" }, optionsMixin);\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tbuttons: {\n\t\t\tcontextButton: {\n\t\t\t\ty: 5,\n\t\t\t\tx: -5,\n\t\t\t\theight: 32,\n\t\t\t\twidth: 32,\n\t\t\t\tsymbolSize: 16,\n\t\t\t\tsymbolX: 17,\n\t\t\t\tsymbolY: 16,\n\t\t\t\tmenuItems: [\n\t\t\t\t\t\"downloadSVG\",\n\t\t\t\t\t\"downloadExpand\",\n\t\t\t\t],\n\t\t\t},\n\t\t},\n\t\tsourceWidth: 720,\n\t\tsourceHeight: 405,\n\t\tchartOptions: {\n\t\t\tlegend: {\n\t\t\t\t// @ts-ignore According to the document, null is acceptable\n\t\t\t\twidth: null,\n\t\t\t},\n\t\t\t// @ts-ignore According to the document, null is acceptable\n\t\t\txAxis: {\n\t\t\t\twidth: null,\n\t\t\t},\n\t\t\tchart: {\n\t\t\t\tclassName: \"exporting_chart_class\",\n\t\t\t},\n\t\t},\n\t},\n};\n\nfunction switchYAxis(chart: Chart, i: number) {\n\tconst { yAxis } = chart;\n\tfor (let j = 1; j < yAxis.length; j++) {\n\t\tyAxis[j].update({ visible: i === j }, false);\n\t}\n\tchart.redraw();\n}\n\nfunction addSeriesListener(chart: Chart) {\n\tconst { series } = chart;\n\tfor (let i = 1; i < series.length; i++) {\n\t\tseries[i].onMouseOver = () => switchYAxis(chart, i);\n\t}\n}\n\nfunction addLegendListener(chart: Chart) {\n\tconst { series } = chart;\n\n\tfor (let i = 1; i < series.length; i++) {\n\t\tconst { element } = (series[i] as any).legendItem.group;\n\t\telement.onmouseenter = () => switchYAxis(chart, i);\n\t}\n}\n\nexport interface ChartProps {\n\tclassName?: string;\n\tvisible: boolean;\n\n\tseriesMeta: MetricMeta[];\n\tindex: number;\n\txLabel: string;\n\tvalues: string[];\n\toutputs: AnalyzeResult[];\n}\n\nfunction toChartData(props: ChartProps) {\n\tconst { seriesMeta, outputs, values, xLabel } = props;\n\n\tconst { length } = seriesMeta;\n\tconst series = new Array<SeriesLineOptions>(length);\n\tconst yAxis = new Array<YAxisOptions>(length);\n\n\tfor (let i = 0; i < length; i++) {\n\t\tconst { key, name } = seriesMeta[i];\n\t\tyAxis[i] = {\n\t\t\ttitle: {\n\t\t\t\ttext: name,\n\t\t\t},\n\t\t\tvisible: false,\n\t\t\topposite: true,\n\t\t};\n\t\tseries[i] = {\n\t\t\tname,\n\t\t\ttype: \"line\",\n\t\t\tyAxis: i,\n\t\t\tdata: outputs.map(o => o.metrics[key]),\n\t\t};\n\t}\n\n\tconst [left, initialRight] = yAxis;\n\tleft.visible = true;\n\tleft.opposite = false;\n\tif (initialRight) {\n\t\tinitialRight.visible = true;\n\t}\n\n\tconst xAxis = {\n\t\tcategories: values,\n\t};\n\n\treturn { series, yAxis, xAxis, xLabel } as Options;\n}\n\nexport default function ChartPanel(props: ChartProps) {\n\tconst { className, visible, seriesMeta, outputs, index, xLabel, values } = props;\n\n\tconst [chart, setChart] = useState<Chart>();\n\tconst [locked, setLocked] = useState(false);\n\n\tfunction initHighcharts(el: HTMLDivElement | null) {\n\t\tif (!el || chart) {\n\t\t\treturn;\n\t\t}\n\t\tconst dataPart = toChartData(props);\n\t\tconst options = Highcharts.merge(baseOptions, dataPart);\n\n\t\tconst newChart = Highcharts.chart(el, options);\n\t\tsetChart(newChart);\n\t\taddSeriesListener(newChart);\n\t\taddLegendListener(newChart);\n\t}\n\n\tfunction updateSeriesData(chart: Chart) {\n\t\tchart.options.xLabel = xLabel;\n\t\tchart.xAxis[0].setCategories(values, false);\n\n\t\tchart.series.forEach((s, i) => {\n\t\t\tconst { key } = seriesMeta[i];\n\t\t\ts.setData(outputs.map(output => output.metrics[key]), false);\n\t\t});\n\t}\n\n\tfunction updatePlotLine(chart: Chart) {\n\t\tconst [xAxis] = chart.xAxis;\n\t\txAxis.removePlotLine(\"MarkLine\");\n\t\txAxis.addPlotLine({\n\t\t\tid: \"MarkLine\",\n\t\t\tvalue: index,\n\t\t\tdashStyle: \"Dash\",\n\t\t});\n\t\tchart.legend.update({\n\t\t\tlabelFormatter() {\n\t\t\t\tconst { name, options } = this as any;\n\t\t\t\tconst value = options.data[index];\n\t\t\t\tlet displayValue;\n\n\t\t\t\tswitch (value) {\n\t\t\t\t\tcase +Infinity:\n\t\t\t\t\t\tdisplayValue = \"∞\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase -Infinity:\n\t\t\t\t\t\tdisplayValue = \"-∞\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tdisplayValue = value.toFixed(2);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\treturn `${name}: <b>${displayValue}</b>`;\n\t\t\t},\n\t\t});\n\t\taddLegendListener(chart);\n\t}\n\n\tuseEffect(() => chart && updateSeriesData(chart), [outputs]);\n\tuseEffect(() => chart && updatePlotLine(chart));\n\n\tfunction handleLockChange() {\n\t\tif (locked) {\n\t\t\tconst clear = { min: null, max: null };\n\t\t\tchart!.yAxis.forEach(y => y.update(clear, false));\n\t\t\tsetLocked(false);\n\t\t} else {\n\t\t\tsetLocked(true);\n\t\t\tchart!.yAxis.forEach(y => y.update({ min: y.min, max: y.max }), false);\n\t\t}\n\t\tchart!.redraw();\n\t}\n\n\t// High cost of rendering chart, so keep the element\n\tconst display = visible ? undefined : { display: \"none\" };\n\n\treturn (\n\t\t<section\n\t\t\tclassName={clsx(styles.container, className)}\n\t\t\tstyle={display}\n\t\t>\n\t\t\t<Button\n\t\t\t\ttitle={i18n(\"LockYAxis\")}\n\t\t\t\ttype=\"text\"\n\t\t\t\tclassName={styles.lock}\n\t\t\t\tactive={locked}\n\t\t\t\tonClick={handleLockChange}\n\t\t\t>\n\t\t\t\t<TbLockFilled/>\n\t\t\t</Button>\n\t\t\t<div className={styles.chart} ref={initHighcharts}/>\n\t\t</section>\n\t);\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"XXq7Z controls\",\"field\":\"yHhVc\",\"active\":\"msmSz\",\"radioButtonGroup\":\"fkwjk\"};","import { Dispatch, ReactNode } from \"react\";\nimport clsx from \"clsx\";\nimport { SelectBox } from \"../ui/index.ts\";\nimport i18n from \"../i18n.ts\";\nimport { getEncoderNames } from \"../codecs/index.ts\";\nimport { Merger } from \"../hooks.ts\";\nimport { ControlsMap } from \"./index.ts\";\nimport { ControlState, VariableType } from \"./AnalyzePage.tsx\";\nimport styles from \"./ControlPanel.scss\";\n\ninterface FieldWrapperProps {\n\ttype: VariableType;\n\ttargetType: VariableType;\n\tid: string;\n\ttargetId: string;\n\n\tchildren?: ReactNode;\n\n\tonChange: Dispatch<Partial<ControlState>>;\n}\n\nfunction FieldWrapper(props: FieldWrapperProps) {\n\tconst { type, id, targetType, targetId, children, onChange } = props;\n\n\tfunction handleClick() {\n\t\tonChange({ varType: targetType, varId: targetId });\n\t}\n\n\tconst clazz = clsx(\n\t\tstyles.field,\n\t\t{ [styles.active]: targetType === type && targetId === id },\n\t);\n\n\treturn <div className={clazz} onClick={handleClick}>{children}</div>;\n}\n\nexport interface ControlPanelProps {\n\tcontrolsMap: ControlsMap;\n\tvalue: ControlState;\n\tonChange: Merger<ControlState>;\n}\n\nexport default function ControlPanel(props: ControlPanelProps) {\n\tconst { controlsMap, value, onChange } = props;\n\tconst { varType, varId, codec, stateMap } = value;\n\n\tif (varType === VariableType.None) {\n\t\treturn null;\n\t}\n\n\tconst state = stateMap[codec];\n\tconst setState = onChange.sub(\"stateMap\").sub(codec);\n\n\tconst controls = controlsMap[codec].map(({ id, Input }, i) =>\n\t\t<FieldWrapper\n\t\t\tkey={id}\n\t\t\ttype={varType}\n\t\t\tid={varId}\n\t\t\ttargetType={VariableType.Option}\n\t\t\ttargetId={id}\n\t\t\tonChange={onChange.merge}\n\t\t>\n\t\t\t<Input\n\t\t\t\tvalue={state[i]}\n\t\t\t\tonChange={setState.sub(i)}\n\t\t\t/>\n\t\t</FieldWrapper>,\n\t);\n\n\tconst selectOptions = getEncoderNames(controlsMap)\n\t\t.map(name => <option key={name} value={name}>{name}</option>);\n\n\tif (selectOptions.length > 1) {\n\t\tcontrols.push(\n\t\t\t<FieldWrapper\n\t\t\t\tkey=\"codec\"\n\t\t\t\ttype={varType}\n\t\t\t\tid={varId}\n\t\t\t\ttargetType={VariableType.Encoder}\n\t\t\t\ttargetId=\"\"\n\t\t\t\tonChange={onChange.merge}\n\t\t\t>\n\t\t\t\t<SelectBox\n\t\t\t\t\ttitle={i18n(\"Codec\")}\n\t\t\t\t\tvalue={codec}\n\t\t\t\t\tonValueChange={onChange.sub(\"codec\")}\n\t\t\t\t>\n\t\t\t\t\t{selectOptions}\n\t\t\t\t</SelectBox>\n\t\t\t</FieldWrapper>,\n\t\t);\n\t}\n\n\treturn <form className={styles.container}>{controls}</form>;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"buttonPanel\":\"xoSIJ controls\",\"iconButton\":\"UdC8r dark\",\"imageView\":\"Pe9Kx\",\"metricsPanel\":\"BTorj\",\"simple\":\"OrDdk controls BTorj\"};","import { useMemo, useState } from \"react\";\nimport { TbChartHistogram, TbDownload, TbUpload, TbX } from \"react-icons/tb\";\nimport i18n from \"../i18n.ts\";\nimport { Button, DownloadButton } from \"../ui/index.ts\";\nimport { AnalyzeContext, ControlsMap } from \"./index\";\nimport { ControlType } from \"../form/index.ts\";\nimport { getEncoderNames } from \"../codecs/index.ts\";\nimport { MetricMeta } from \"../features/measurement.tsx\";\nimport ImageView from \"./ImageView.tsx\";\nimport ChartPanel from \"./ChartPanel.tsx\";\nimport ControlPanel from \"./ControlPanel.tsx\";\nimport { AnalyzeResult } from \"../features/image-worker.tsx\";\nimport styles from \"./AnalyzePage.scss\";\nimport { getMerger } from \"../hooks.ts\";\n\ninterface SimplePanelProps {\n\tvisible: boolean;\n\tmetas: MetricMeta[];\n\tmetrics: Record<string, number>;\n}\n\nfunction SimplePanel(props: SimplePanelProps) {\n\tconst { visible, metas, metrics } = props;\n\n\tif (!visible) {\n\t\treturn null;\n\t}\n\n\tconst items = [];\n\tfor (const { key, name } of metas) {\n\t\tconst value = metrics[key].toFixed(3);\n\t\titems.push(<dt key={name}>{name}:</dt>);\n\t\titems.push(<dd key={key}>{value}</dd>);\n\t}\n\n\treturn <dl className={styles.simple}>{items}</dl>;\n}\n\nexport enum VariableType {\n\tNone,\n\tEncoder,\n\tOption,\n}\n\ntype StateMap = Record<string, any[]>;\n\nexport interface ControlState {\n\tvarType: VariableType;\n\tvarId: string;\n\tcodec: string;\n\tstateMap: StateMap;\n}\n\nfunction createControlState(controlsMap: ControlsMap): ControlState {\n\tlet varType = VariableType.None;\n\tlet varId = \"\";\n\n\tconst kvs = Object.entries(controlsMap);\n\tif (kvs.length > 1) {\n\t\tvarType = VariableType.Encoder;\n\t\tvarId = \"\";\n\t}\n\n\tconst [codec, controls] = kvs[0];\n\tif (controls.length > 0) {\n\t\tvarType = VariableType.Option;\n\t\tvarId = controls[0].id;\n\t}\n\n\tconst stateMap: StateMap = {};\n\tfor (const [enc, v] of kvs) {\n\t\tconst selected = [];\n\t\tfor (const c of v) {\n\t\t\tselected.push(c.createState()[0]);\n\t\t}\n\t\tstateMap[enc] = selected;\n\t}\n\n\treturn { varType, varId, codec, stateMap };\n}\n\nfunction getIndex(controls: ControlType[], weights: number[], state: any[]) {\n\tlet index = 0;\n\tfor (let i = 0; i < controls.length; i++) {\n\t\tconst control = controls[i];\n\t\tconst k = control.indexOf(state[i]);\n\t\tindex += weights[i] * k;\n\t}\n\treturn index;\n}\n\nfunction getSeries(result: AnalyzeContext, state: ControlState) {\n\tconst { controlsMap, offsetMap, outputs, weightMap } = result;\n\tconst { varType, varId, codec, stateMap } = state;\n\n\tlet labels: string[];\n\tlet series: AnalyzeResult[];\n\tlet output: AnalyzeResult;\n\tlet varName: string;\n\n\tif (varType === VariableType.None) {\n\t\tlabels = [\"\"];\n\t\tseries = outputs;\n\t\tvarName = \"\";\n\t\toutput = series[0];\n\t} else if (varType === VariableType.Encoder) {\n\t\tlabels = getEncoderNames(stateMap);\n\t\tseries = labels.map(v => {\n\t\t\tconst offset = offsetMap.get(v)!;\n\t\t\tconst controls = controlsMap[v];\n\t\t\tconst state = stateMap[v];\n\t\t\tconst weights = weightMap.get(v)!;\n\t\t\treturn outputs[offset + getIndex(controls, weights, state)];\n\t\t});\n\t\toutput = series[labels.indexOf(codec)];\n\t\tvarName = \"Encoding\";\n\t} else if (varType === VariableType.Option) {\n\t\tconst controls = controlsMap[codec];\n\t\tconst i = controls.findIndex(c => c.id === varId)!;\n\t\tconst values = controls[i].createState();\n\n\t\tconst state = stateMap[codec];\n\t\tconst weights = weightMap.get(codec)!;\n\t\tconst offset = offsetMap.get(codec)!;\n\n\t\tconst w = weights[i];\n\t\tconst c = offset + getIndex(controls, weights, state);\n\t\tconst base = c - controls[i].indexOf(state[i]) * w;\n\n\t\tlabels = values.map(v => v.toString());\n\t\toutput = outputs[c];\n\t\tseries = values.map((_, i) => outputs[base + w * i]);\n\t\tvarName = controls[i].label;\n\t} else {\n\t\tthrow new Error(\"Missing handle of variable type: \" + varType);\n\t}\n\n\treturn { output, labels, series, varName };\n}\n\nexport interface AnalyzePageProps {\n\tresult: AnalyzeContext;\n\tonStart: () => void;\n\tonClose: () => void;\n}\n\nexport default function AnalyzePage(props: AnalyzePageProps) {\n\tconst { result, onStart, onClose } = props;\n\tconst { input, controlsMap, seriesMeta } = result;\n\n\tconst [showChart, setShowChart] = useState(true);\n\tconst [state, setState] = useState(() => createControlState(controlsMap));\n\n\tconst { labels, series, output, varName } = useMemo(() => getSeries(result, state), [result, state]);\n\n\tconst index = series.indexOf(output);\n\tif (index < 0) {\n\t\tthrow new Error(\"Can't find current index in series\");\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<ImageView\n\t\t\t\tclassName={styles.imageView}\n\t\t\t\toriginal={input}\n\t\t\t\toutput={output}\n\t\t\t/>\n\n\t\t\t{\n\t\t\t\tresult.outputs.length === 1 ?\n\t\t\t\t\t<SimplePanel\n\t\t\t\t\t\tvisible={showChart}\n\t\t\t\t\t\tmetas={seriesMeta}\n\t\t\t\t\t\tmetrics={output.metrics}\n\t\t\t\t\t/>\n\t\t\t\t\t:\n\t\t\t\t\t<ChartPanel\n\t\t\t\t\t\tclassName={styles.metricsPanel}\n\t\t\t\t\t\tvisible={showChart}\n\t\t\t\t\t\tseriesMeta={seriesMeta}\n\t\t\t\t\t\tindex={index}\n\t\t\t\t\t\txLabel={varName}\n\t\t\t\t\t\tvalues={labels}\n\t\t\t\t\t\toutputs={series}\n\t\t\t\t\t/>\n\t\t\t}\n\n\t\t\t<div className={styles.buttonPanel}>\n\t\t\t\t<Button\n\t\t\t\t\ttitle={i18n(\"Back\")}\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tclassName={styles.iconButton}\n\t\t\t\t\tonClick={onClose}\n\t\t\t\t>\n\t\t\t\t\t<TbX/>\n\t\t\t\t</Button>\n\t\t\t\t<Button\n\t\t\t\t\ttitle={i18n(\"SelectFile\")}\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tclassName={styles.iconButton}\n\t\t\t\t\tonClick={onStart}\n\t\t\t\t>\n\t\t\t\t\t<TbUpload/>\n\t\t\t\t</Button>\n\t\t\t\t<Button\n\t\t\t\t\ttitle={i18n(\"ShowMetrics\")}\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tclassName={styles.iconButton}\n\t\t\t\t\tactive={showChart}\n\t\t\t\t\tonClick={() => setShowChart(!showChart)}\n\t\t\t\t>\n\t\t\t\t\t<TbChartHistogram/>\n\t\t\t\t</Button>\n\t\t\t\t<DownloadButton\n\t\t\t\t\ttitle={i18n(\"DownloadOutput\")}\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tclassName={styles.iconButton}\n\t\t\t\t\tfile={output.file}\n\t\t\t\t>\n\t\t\t\t\t<TbDownload/>\n\t\t\t\t</DownloadButton>\n\t\t\t</div>\n\n\t\t\t<ControlPanel\n\t\t\t\tcontrolsMap={controlsMap}\n\t\t\t\tvalue={state}\n\t\t\t\tonChange={getMerger(setState)}\n\t\t\t/>\n\t\t</>\n\t);\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"dialog\":\"VoT92\",\"list\":\"ViILv\",\"placeholder\":\"KQ202 ViILv\",\"listitem\":\"va1tQ\",\"dragging\":\"JzKW7\",\"canvas\":\"wP4OW\",\"attrLine\":\"Y3AB9\",\"filename\":\"EsDQb\",\"reset\":\"XqnDt\",\"mime\":\"BZ6nn\",\"right\":\"NTr6z\",\"fileDrop\":\"RIyze\",\"error\":\"D3F6B\",\"actions\":\"QJgkG dialog-actions\"};","import { Dispatch, ForwardedRef, forwardRef, useEffect, useRef, useState } from \"react\";\nimport clsx from \"clsx\";\nimport { TbX } from \"react-icons/tb\";\nimport { DragDropContext, Draggable, Droppable, DropResult } from \"react-beautiful-dnd\";\nimport { dataSizeIEC, uniqueId } from \"@kaciras/utilities/browser\";\nimport { Button, Dialog, FileDrop } from \"../ui/index.ts\";\nimport { drawImage } from \"../utils.ts\";\nimport { decode } from \"../features/decode.ts\";\nimport { getPooledWorker, ImageWorker, InputImage, newImagePool } from \"../features/image-worker.ts\";\nimport { CompareData } from \"./CompareSession.tsx\";\nimport styles from \"./CompareFileDialog.scss\";\nimport i18n from \"../i18n.ts\";\n\ninterface InputWithId extends InputImage {\n\tid: number;\n}\n\ninterface PreviewBoxProps {\n\tvalue: InputImage;\n\tindex: number;\n\tisDragging: boolean;\n\tonRemove: () => void;\n}\n\nconst PreviewBox = forwardRef((props: PreviewBoxProps, ref: ForwardedRef<HTMLLIElement>) => {\n\tconst { value, index, isDragging, onRemove, ...others } = props;\n\tconst { file, raw } = value;\n\tconst { type, size } = file;\n\tconst { width, height } = raw;\n\n\tconst canvas = useRef<HTMLCanvasElement>(null);\n\n\tuseEffect(() => drawImage(raw, canvas.current), [raw]);\n\n\tconst clazz = clsx(\n\t\tstyles.listitem,\n\t\tisDragging && styles.dragging,\n\t);\n\n\treturn (\n\t\t<li {...others} className={clazz} ref={ref}>\n\t\t\t<canvas\n\t\t\t\tclassName={styles.canvas}\n\t\t\t\tref={canvas}\n\t\t\t\twidth={width}\n\t\t\t\theight={height}\n\t\t\t/>\n\t\t\t<div className={styles.attrLine}>\n\t\t\t\t{\n\t\t\t\t\tindex === 0\n\t\t\t\t\t\t? <span>Original</span>\n\t\t\t\t\t\t: <span># {index - 1}</span>\n\t\t\t\t}\n\t\t\t\t<Button\n\t\t\t\t\tclassName={styles.reset}\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\ttitle={i18n(\"Remove\")}\n\t\t\t\t\tonClick={onRemove}\n\t\t\t\t>\n\t\t\t\t\t<TbX/>\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t\t<div className={styles.filename}>\n\t\t\t\t{file.name}\n\t\t\t</div>\n\t\t\t<div className={styles.attrLine}>\n\t\t\t\t<span className={styles.mime}>{type}</span>\n\t\t\t\t({width} x {height}, {dataSizeIEC.formatDiv(size)})\n\t\t\t</div>\n\t\t</li>\n\t);\n});\n\nPreviewBox.displayName = \"PreviewBox\";\n\ninterface PreviewListProps {\n\tvalue: InputWithId[];\n\tonChange: Dispatch<InputWithId[]>;\n}\n\nfunction PreviewList(props: PreviewListProps) {\n\tconst { value, onChange } = props;\n\n\tfunction removeAt(index: number) {\n\t\tconst copy = Array.from(value);\n\t\tcopy.splice(index, 1);\n\t\tonChange(copy);\n\t}\n\n\tfunction dragSort(result: DropResult) {\n\t\tconst { source, destination } = result;\n\t\tif (!destination) {\n\t\t\treturn;\n\t\t}\n\t\tconst newValue = [...value];\n\t\tconst [remove] = newValue.splice(source.index, 1);\n\t\tnewValue.splice(destination.index, 0, remove);\n\t\tonChange(newValue);\n\t}\n\n\tconst items = value.map((v, i) => (\n\t\t<Draggable\n\t\t\tkey={v.id}\n\t\t\tdraggableId={v.id.toString()}\n\t\t\tindex={i}\n\t\t>\n\t\t\t{(provided, snapshot) => (\n\t\t\t\t<PreviewBox\n\t\t\t\t\t{...provided.draggableProps}\n\t\t\t\t\t{...provided.dragHandleProps}\n\t\t\t\t\tref={provided.innerRef}\n\t\t\t\t\tisDragging={snapshot.isDragging}\n\t\t\t\t\tvalue={v}\n\t\t\t\t\tindex={i}\n\t\t\t\t\tonRemove={() => removeAt(i)}\n\t\t\t\t/>\n\t\t\t)}\n\t\t</Draggable>\n\t));\n\n\treturn (\n\t\t<DragDropContext onDragEnd={dragSort}>\n\t\t\t<Droppable droppableId=\"compare\">\n\t\t\t\t{provided =>\n\t\t\t\t\t<ol\n\t\t\t\t\t\tclassName={styles.list}\n\t\t\t\t\t\tref={provided.innerRef}\n\t\t\t\t\t\t{...provided.droppableProps}\n\t\t\t\t\t>\n\t\t\t\t\t\t{items}\n\t\t\t\t\t\t{provided.placeholder}\n\t\t\t\t\t</ol>\n\t\t\t\t}\n\t\t\t</Droppable>\n\t\t</DragDropContext>\n\t);\n}\n\nexport interface CompareFileDialogProps {\n\tdata?: CompareData;\n\tonAccept: Dispatch<CompareData>;\n\tonCancel: () => void;\n}\n\nexport default function CompareFileDialog(props: CompareFileDialogProps) {\n\tconst { data, onAccept, onCancel } = props;\n\n\tconst [images, setImages] = useState<InputWithId[]>(() => {\n\t\treturn data ? ([data.original, ...data.changed] as InputWithId[]) : [];\n\t});\n\tconst imageWorker = useRef<ImageWorker>();\n\tconst [error, setError] = useState<Error>();\n\n\tuseEffect(initImagePool, []);\n\n\tfunction initImagePool() {\n\t\tconst imagePool = newImagePool(navigator.hardwareConcurrency);\n\t\timageWorker.current = getPooledWorker(imagePool);\n\t\treturn () => imagePool.terminate();\n\t}\n\n\tfunction handleFileChange(files: File[]) {\n\t\tconst tasks = [];\n\t\tfor (const file of files) {\n\t\t\ttasks.push(decode(file, imageWorker.current).then(raw => ({ file, raw, id: uniqueId() })));\n\t\t}\n\t\tPromise.all(tasks)\n\t\t\t.then(v => setImages([...images, ...v]))\n\t\t\t.catch(setError);\n\t}\n\n\tfunction handleAccept() {\n\t\tonAccept({ original: images[0], changed: images.slice(1) });\n\t}\n\n\tconst isInvalid = images.length < 2 || Boolean(error);\n\n\treturn (\n\t\t<Dialog className={styles.dialog} onClose={onCancel}>\n\t\t\t{\n\t\t\t\timages.length > 0 ?\n\t\t\t\t\t<PreviewList value={images} onChange={setImages}/>\n\t\t\t\t\t:\n\t\t\t\t\t<div className={styles.placeholder}>\n\t\t\t\t\t\t<p>{i18n(\"AddAtLeast2Images\")}</p>\n\t\t\t\t\t\t<p>{i18n(\"FirstIsTheOriginal\")}</p>\n\t\t\t\t\t\t<p>{i18n(\"DndToReorder\")}</p>\n\t\t\t\t\t</div>\n\t\t\t}\n\t\t\t<div className={styles.right}>\n\t\t\t\t<FileDrop\n\t\t\t\t\tclassName={styles.fileDrop}\n\t\t\t\t\taccept=\"image/*\"\n\t\t\t\t\tmultiple={true}\n\t\t\t\t\tonChange={handleFileChange}\n\t\t\t\t\tonError={setError}\n\t\t\t\t\tonSelectStart={() => setError(undefined)}\n\t\t\t\t/>\n\t\t\t\t<div className={styles.error}>{error?.message}</div>\n\t\t\t\t<div className={styles.actions}>\n\t\t\t\t\t<Button className=\"second\" onClick={onCancel}>Back</Button>\n\t\t\t\t\t<Button disabled={isInvalid} onClick={handleAccept}>Next</Button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Dialog>\n\t);\n}\n","import { Dispatch } from \"react\";\nimport { useLocalStorage } from \"../hooks.ts\";\nimport i18n from \"../i18n.ts\";\nimport { Button, Dialog } from \"../ui/index.ts\";\nimport MeasurePanel, { getMeasureOptions } from \"./MeasurePanel.tsx\";\nimport { MeasureOptions } from \"../features/measurement.ts\";\nimport styles from \"./CompressConfigDialog.scss\";\n\ninterface CompareConfigDialogProps {\n\tonClose: () => void;\n\tonStart: Dispatch<MeasureOptions>;\n\tonSelectFile: () => void;\n}\n\nexport default function CompareConfigDialog(props: CompareConfigDialogProps) {\n\tconst { onStart, onClose, onSelectFile } = props;\n\n\tconst [options, setOptions] = useLocalStorage(\"Measure\", getMeasureOptions);\n\n\treturn (\n\t\t<Dialog name={i18n(\"MeasureOptions\")} className={styles.dialog} onClose={onClose}>\n\t\t\t<h2 className={styles.title}>\n\t\t\t\t{i18n(\"MeasureOptions\")}\n\t\t\t</h2>\n\t\t\t<MeasurePanel\n\t\t\t\tvalue={options}\n\t\t\t\tonChange={setOptions}\n\t\t\t/>\n\t\t\t<div className=\"dialog-actions\">\n\t\t\t\t<Button onClick={onSelectFile}>Select files...</Button>\n\t\t\t\t<Button className=\"second\" onClick={onClose}>Cancel</Button>\n\t\t\t\t<Button onClick={() => onStart(options)}>Next</Button>\n\t\t\t</div>\n\t\t</Dialog>\n\t);\n}\n","import { Dispatch, useState } from \"react\";\nimport { builtinResize } from \"squoosh/src/client/lazy-app/util/canvas.ts\";\nimport { AnalyzeContext } from \"./index.ts\";\nimport RangeControl from \"../form/control/RangeControl.tsx\";\nimport {\n\tAnalyzeResult,\n\tgetPooledWorker,\n\tImagePool,\n\tInputImage,\n\tnewImagePool,\n\tsetOriginalImage,\n} from \"../features/image-worker.ts\";\nimport { createMeasurer, MeasureOptions } from \"../features/measurement.ts\";\nimport { useProgress } from \"../hooks.ts\";\nimport ProgressDialog from \"./ProgressDialog.tsx\";\nimport CompareFileDialog from \"./CompareFileDialog.tsx\";\nimport CompareConfigDialog from \"./CompareConfigDialog.tsx\";\n\nexport interface CompareData {\n\toriginal: InputImage;\n\tchanged: InputImage[];\n}\n\nfunction resizeToFit(image: ImageData, target: ImageData) {\n\tconst { width: w0, height: h0 } = image;\n\tconst { width: w1, height: h1 } = target;\n\n\tif (w0 === w1 && h0 === h1) {\n\t\treturn image;\n\t}\n\treturn builtinResize(image, 0, 0, w0, h0, w1, h1, \"high\");\n}\n\ninterface CompareSessionProps {\n\tisOpen: boolean;\n\tonChange: Dispatch<AnalyzeContext>;\n\tonClose: () => void;\n}\n\nexport default function CompareSession(props: CompareSessionProps) {\n\tconst { isOpen, onChange, onClose } = props;\n\n\tconst [selectFile, setSelectFile] = useState(true);\n\tconst [data, setData] = useState<CompareData>();\n\tconst [imagePool, setImagePool] = useState<ImagePool>();\n\n\tconst progress = useProgress();\n\n\tfunction handleAccept(data: CompareData) {\n\t\tsetData(data);\n\t\tsetSelectFile(false);\n\t}\n\n\tfunction handleSelectCancel() {\n\t\tdata ? setSelectFile(false) : onClose();\n\t}\n\n\tasync function handleStart(measureOptions: MeasureOptions) {\n\t\tif (!data || !measureOptions) {\n\t\t\tthrow new Error(\"Missing required data\");\n\t\t}\n\t\tconst { original, changed } = data;\n\n\t\tconst control = new RangeControl({\n\t\t\tid: \"i\",\n\t\t\tlabel: \"Index\",\n\t\t\tmin: 0,\n\t\t\tstep: 1,\n\t\t\tmax: data.changed.length - 1,\n\t\t});\n\n\t\tconst controlsMap = { _: [control] };\n\n\t\tconst imagePool = newImagePool(measureOptions.workerCount);\n\t\tconst worker = getPooledWorker(imagePool);\n\t\tconst measurer = createMeasurer(measureOptions, worker);\n\n\t\tsetImagePool(imagePool);\n\t\tawait setOriginalImage(imagePool, original);\n\n\t\tconst outputs = [];\n\t\tfor (let i = 0; i < changed.length; i++) {\n\t\t\tconst { raw, file } = changed[i];\n\t\t\tconst imageB = resizeToFit(raw, original.raw);\n\n\t\t\tconst output: AnalyzeResult = {\n\t\t\t\tfile,\n\t\t\t\tdata: imageB,\n\t\t\t\tmetrics: {},\n\t\t\t};\n\t\t\toutputs.push(output);\n\n\t\t\t// noinspection ES6MissingAwait\n\t\t\tmeasurer.execute(original, output, progress.increase);\n\t\t}\n\n\t\tprogress.reset(changed.length * (1 + measurer.calculations));\n\t\ttry {\n\t\t\tawait imagePool.join();\n\t\t\tsetImagePool(undefined);\n\t\t\tonChange({\n\t\t\t\tinput: original,\n\t\t\t\toutputs,\n\t\t\t\toffsetMap: new Map<string, number>([[\"_\", 0]]),\n\t\t\t\tweightMap: new Map<string, number[]>([[\"_\", [1]]]),\n\t\t\t\tseriesMeta: measurer.metrics,\n\t\t\t\tcontrolsMap,\n\t\t\t});\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t\tprogress.setError(e.message);\n\t\t} finally {\n\t\t\timagePool.terminate();\n\t\t}\n\t}\n\n\tfunction stop() {\n\t\timagePool!.terminate();\n\t\tsetImagePool(undefined);\n\t}\n\n\tif (!isOpen) {\n\t\treturn null;\n\t}\n\n\tif (selectFile) {\n\t\treturn <CompareFileDialog\n\t\t\tdata={data}\n\t\t\tonAccept={handleAccept}\n\t\t\tonCancel={handleSelectCancel}\n\t\t/>;\n\t}\n\n\tif (imagePool) {\n\t\treturn (\n\t\t\t<ProgressDialog\n\t\t\t\tvalue={progress.value}\n\t\t\t\tmax={progress.max}\n\t\t\t\terror={progress.error}\n\t\t\t\tonCancel={stop}\n\t\t\t/>\n\t\t);\n\t}\n\n\treturn (\n\t\t<CompareConfigDialog\n\t\t\tonStart={handleStart}\n\t\t\tonClose={onClose}\n\t\t\tonSelectFile={() => setSelectFile(true)}\n\t\t/>\n\t);\n}\n","import { useState } from \"react\";\nimport CompressSession from \"./CompressSession.tsx\";\nimport IntroPage from \"./IntroPage.tsx\";\nimport AnalyzePage from \"./AnalyzePage.tsx\";\nimport CompareSession from \"./CompareSession.tsx\";\nimport { ControlType } from \"../form/index.ts\";\nimport { MetricMeta } from \"../features/measurement.ts\";\nimport { AnalyzeResult, InputImage } from \"../features/image-worker.ts\";\n\nexport type ControlsMap = Record<string, ControlType[]>;\n\nexport interface AnalyzeContext {\n\tinput: InputImage;\n\tseriesMeta: MetricMeta[];\n\toutputs: AnalyzeResult[];\n\n\tcontrolsMap: ControlsMap;\n\tweightMap: Map<string, number[]>;\n\toffsetMap: Map<string, number>;\n}\n\ninterface ContextWithId extends AnalyzeContext {\n\tid: number;\n}\n\nenum Mode {\n\tNone,\n\tCompress,\n\tCompare,\n}\n\nexport default function App() {\n\tconst [mode, setMode] = useState(Mode.None);\n\tconst [isOpen, setOpen] = useState(true);\n\tconst [result, setResult] = useState<ContextWithId>();\n\n\tfunction handleChange(value: AnalyzeContext) {\n\t\tsetOpen(false);\n\t\t(value as ContextWithId).id = (result?.id || 1) + 1;\n\t\tsetResult(value as ContextWithId);\n\t}\n\n\tfunction createSession(mode: Mode) {\n\t\tsetMode(mode);\n\t\tsetOpen(true);\n\t}\n\n\tlet Session: any;\n\n\tswitch (mode) {\n\t\tcase Mode.Compare:\n\t\t\tSession = CompareSession;\n\t\t\tbreak;\n\t\tcase Mode.Compress:\n\t\t\tSession = CompressSession;\n\t\t\tbreak;\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t{result ?\n\t\t\t\t<AnalyzePage\n\t\t\t\t\tkey={result.id} // avoid reuse of control state\n\t\t\t\t\tresult={result}\n\t\t\t\t\tonStart={() => setOpen(true)}\n\t\t\t\t\tonClose={() => setResult(undefined)}\n\t\t\t\t/>\n\t\t\t\t:\n\t\t\t\t<IntroPage\n\t\t\t\t\tonEncode={() => createSession(Mode.Compress)}\n\t\t\t\t\tonCompare={() => createSession(Mode.Compare)}\n\t\t\t\t/>\n\t\t\t}\n\t\t\t{\n\t\t\t\tSession && <Session\n\t\t\t\t\tisOpen={isOpen}\n\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\tonClose={() => setOpen(false)}\n\t\t\t\t/>\n\t\t\t}\n\t\t</>\n\t);\n}\n","import { createRoot } from \"react-dom/client\";\nimport * as Sentry from \"@sentry/react\";\nimport packageJson from \"../package.json\";\nimport \"./index.scss\";\nimport App from \"./app/index.tsx\";\n\n// SENTRY_DSN is defined on the CI.\nif (window.__isSupport__ && process.env.SENTRY_DSN !== null) {\n\tSentry.init({\n\t\tdsn: process.env.SENTRY_DSN,\n\t\tintegrations: [\n\t\t\tSentry.browserTracingIntegration(),\n\t\t],\n\t\ttracesSampleRate: 1.0,\n\t\trelease: `${packageJson.name}@${packageJson.version}`,\n\t});\n}\n\ncreateRoot(document.getElementById(\"root\")!).render(<App/>);\n"],"names":["CheckBoxBase","props","className","type","Icon","IconChecked","name","value","checked","disabled","onClick","onSelected","noop","onChange","onCheckedChange","children","clazz","clsx","styles","container","label","input","e","currentTarget","CheckMark","mark","span","Slider","min","max","step","onValueChange","percent","cssVariables","div","style","valueAsNumber","thumbRegion","thumb","Button","href","active","rest","nativeProps","undefined","ButtonTag","DownloadButton","file","others","url","useRef","useEffect","URL","revokeObjectURL","current","newUrl","createObjectURL","a","document","createElement","download","click","React","inputId","title","minMaxButton","Number","MAX_SAFE_INTEGER","increment","inputRef","updateValue","dispatchEvent","Event","bubbles","cancelable","handlePointerDown","event","diff","button","timer","q","Math","pow","getPrecision","s","toString","d","indexOf","length","next","n","round","newValue","window","setTimeout","addEventListener","onPointerUp","clearTimeout","removeEventListener","tabIndex","TbArrowDown","onPointerDown","TbMinus","shapeRendering","id","ref","TbPlus","TbArrowUp","Dialog","onClose","handleKeyUp","key","stopImmediatePropagation","reactNode","dimmer","role","aria-label","dialog","createPortal","body","stopPropagation","drawImage","data","el","ctx","getContext","putImageData","dragHandler","listener","initEvent","nativeEvent","handleMove","preventDefault","handleEnd","PinchZoom","state","init","pageX","pageY","initX","initY","x","y","scale","touchAction","onWheel","ctrlKey","deltaMode","clientX","clientY","deltaY","scaleDiff","rect","firstElementChild","getBoundingClientRect","dx","left","width","dy","top","height","SelectBox","select","BsFillCaretDownFill","icon","SwitchButton","translations","en","ICAnalyzerIntro","SourceCode","Back","SelectFile","ShowMetrics","DownloadOutput","LockYAxis","DownloadSVG","DownloadFullAxis","MeasureOptions","Remove","AddAtLeast2Images","FirstIsTheOriginal","DndToReorder","AnalysisConfig","EncodeTimeSecond","Codec","Preview","FileName","FileType","Resolution","RawSize","FileSizeAndRatio","SplitView","InputView","OutputView","DiffView","HeatMapView","RequireButteraugli","PickColor","Brightness","ThreadCount","MeasureEncodeTime","MeasurePSNR","MeasureSSIM","Encoding","ElapsedTime","Cancel","Error","OrTryOneOfThese","DropAFile","OrSelectFile","ZoomScale","ResetPinchZoom","Information","Encoders","Analysis","Start","zh","resources","localStorage","getItem","navigator","language","split","FileDrop","accept","multiple","onSelectStart","onError","boundary","useBoundaryCounter","isInArea","setInArea","useState","counter","enter","leave","reset","dragStarted","classes","fileDropBox","dragging","onDragEnter","handleDragEnd","onDragOver","onDrop","items","dataTransfer","files","Array","from","map","getAsFile","filter","Boolean","onDragLeave","TbPhoto","text","fileInput","getPixel","image","i","slice","ColorItem","color","pixel","reduce","toUpperCase","substring","ColorPicker","imageA","imageB","pixelA","pixelB","pixelDiff","abs","TabList","index","localRef","tabButtons","Children","child","isValidElement","selected","cloneElement","count","onKeyDown","focus","TabSwitch","tabPanels","node","isActive","Fragment","RadioGroup","radioBoxes","radioValue","defaultValue","otherProps","NumberInput","zoomInput","prev","BsArrowCounterclockwise","CheckBox","memo","MdCheckBoxOutlineBlank","MdCheckBox","RadioBox","MdOutlineRadioButtonUnchecked","MdOutlineRadioButtonChecked","displayName","SwitchControl","Input","bind","createState","control","BoolOption","OptionField","createControl","populate","options","isVariable","strong","EnumControl","names","radios","item","EnumOption","enumObject","range","onRangeChange","handleChangeV","newVariables","push","v","handleChangeC","Object","keys","includes","fieldset","tempValue","setTempValue","header","required","target","checkValidity","RangeControl","sequence","ceil","_","NumberField","RangePart","spinner","numberInput","NumberOption","VariableMode","ConstMode","reachableMax","floor","base","legend","initEmscriptenModule","moduleFactory","noInitialRun","wasmEncodeFn","loader","loadModuleTask","module","start","performance","now","output","encode","end","result","time","buffer","RPC","transfer","wasmDecodeFn","decode","ColorSpace","GRAYSCALE","RGB","YCbCr","Quantization","defaultOptions","quality","baseline","arithmetic","progressive","optimize_coding","smoothing","color_space","quant_table","ImageMagick","trellis_multipass","trellis_opt_zero","trellis_opt_table","trellis_loops","auto_subsample","chroma_subsample","separate_chroma_quality","chroma_quality","default","mimeType","extension","templates","worker","mozjpegEncode","effort","epf","lossyPalette","decodingSpeedTier","photonNoiseIso","lossyModular","jxlEncode","target_size","target_PSNR","method","sns_strength","filter_strength","filter_sharpness","filter_type","partitions","segments","pass","show_compressed","preprocessing","autofilter","partition_limit","alpha_compression","alpha_filtering","alpha_quality","lossless","exact","image_hint","emulate_jpeg_size","thread_level","low_memory","near_lossless","use_delta_palette","use_sharp_yuv","webpEncoder","Preprocess","losslessPresets","assign","webpEncode","Subsampling","YUV400","YUV420","YUV422","YUV444","cqLevel","cqAlphaLevel","denoiseLevel","tileColsLog2","tileRowsLog2","speed","subsample","chromaDeltaQ","sharpness","tune","AVIFTune","Auto","PSNR","SSIM","avifEncode","Subsample","Csp","YCoCg","YIQ","sns","uv_mode","csp_type","error_diffusion","use_random_matrix","webp2Encode","ENCODERS","MozJPEG","JXL","WebP","AVIF","WebP2","ENCODER_MAP","fromEntries","getEncoderNames","object","decodeImage","img","Image","decoding","src","loaded","Promise","resolve","reject","onload","onerror","catch","test","userAgent","canDecodeCache","Map","magicNumberToMimeType","sniffMimeType","blob","firstChunkString","Uint8Array","Response","arrayBuffer","String","fromCodePoint","join","detector","blobToImg","WorkerPool","factory","workers","remotes","queue","waiters","size","terminated","maxSize","runOnEach","action","startWorker","all","run","task","addJob","allWorkerAreFree","terminate","forEach","remote","probeClient","job","pop","runJob","splice","p","workerFactory","Worker","newImagePool","setOriginalImage","pool","raw","r","setOriginal","shared","share","uint8Array","Uint8ClampedArray","SharedArrayBuffer","byteLength","set","PooledWorkerHandler","workerPool","get","property","Proxy","InvokeHandler","apply","__","argArray","getPooledWorker","decodeImageNative","bitmap","self","createImageBitmap","canvas","getImageData","svgToImageData","svgXml","Blob","ensureSVGSize","parser","DOMParser","parseFromString","svg","documentElement","getAttribute","viewBox","setAttribute","XMLSerializer","serializeToString","drawableToImageData","drawable","opts","sx","sy","sw","sh","then","canDecodeImageType","has","resultPromise","picture","source","srcset","append","currentSrc","avifDecode","jxlDecode","webp2Decode","handlers","ratio","immediately","calc","original","metrics","calcSSIM","calcPSNR","butteraugli","score","heatMap","calcButteraugli","rgbaToImage","channels","imageData","createImageData","createMeasurer","config","used","calculations","enabled","execute","onProgress","b","promise","useProgress","initialMax","setMax","setValue","error","setError","increase","getMerger","mutator","merger","cache","merge","changes","sub","cachedSetter","newVal","useLocalStorage","processor","JSON","parse","persist","setItem","stringify","DemoButton","description","loading","setLoading","handleClick","card","alt","demoIcon","demoDescription","SelectFileDialog","onCancel","abortController","AbortController","acceptUrl","newController","abort","signal","fetchFile","drop","demoLabel","demo","photo","photoIcon","artwork","artworkIcon","colorfulText","colorfulTextIcon","message","ImageInfoPanel","toFixed","dl","attributes","dt","dd","dataSizeIEC","formatDiv","defaultButteraugliOptions","hfAsymmetry","goodQualitySeek","badQualitySeek","getMeasureOptions","saved","version","workerCount","hardwareConcurrency","encodeTime","ssimJs","LabelWrapper","field","MeasurePanel","hasEncodePhase","handleChange","detectInputValue","tagName","deepUpdate","updater","path","parts","recurs","localValue","useCallback","form","inlineLabel","subfields","ssim","option","k1","k2","windowSize","Option","iconChildren","template","variable","BsSliders","constant","BsType","OptionsForm","getEncodingOptions","encoder","enable","newState","t","setCurrent","tabs","tab","handleEnableChange","tablist","CompressConfigDialog","onStart","onSelectFile","setIndex","encoding","setEncoding","measurement","setMeasurement","ready","values","some","EncoderPanel","ProgressDialog","startTime","timeUsage","setTimeUsage","setInterval","date","Date","toISOString","substr","clearInterval","content","h1","progress","buttons","EncodeAnalyzer","taskQueue","measurer","outputSize","profile","buildProfiles","variables","constants","controls","weights","weight","TaskCount","tasks","weightMap","offsetMap","controlsMap","create","mutation","cartesianObject","process","seriesMeta","outputs","File","replace","CompressSession","isOpen","selectFile","setSelectFile","setInput","imagePool","setImagePool","handleInputChange","handleStart","analyzer","console","IntroPage","onEncode","onCompare","section","banner","h2","subTitle","bigButton","TbBrandGithub","github","unsplash","link","links","ViewType","viewTypeNames","pinchZoomInit","ImageView","mixBlendMode","pinchZoom","setPinchZoom","setType","brightness","setBrightness","picking","setPicking","inRegion","setInRegion","mousePos","setMousePos","splitPoint","setSplitPoint","innerWidth","backCanvas","topCanvas","topImage","tabData","imageViewTabs","brightnessVal","wrapperCSS","splitCSS","px","py","innerHeight","main","wrapper","onPointerOver","onPointerMove","onPointerOut","hidden","separator","tabPanel","BsEyedropper","BsBrightnessHigh","theme","darkNumberInput","ZoomControl","Export","Highcharts","ExportOffline","baseOptions","accessibility","chart","styledMode","animation","tooltip","borderRadius","verticalAlign","alignColumns","xAxis","lang","downloadSVG","exporting","menuItemDefinitions","downloadExpand","onclick","yAxis","fill","visible","optionsMixin","xLabel","plotLines","labelFormat","labelFormatter","exportChartLocal","contextButton","symbolSize","symbolX","symbolY","menuItems","sourceWidth","sourceHeight","chartOptions","switchYAxis","j","update","redraw","addLegendListener","series","element","legendItem","group","onmouseenter","ChartPanel","setChart","locked","setLocked","setCategories","setData","updatePlotLine","removePlotLine","addPlotLine","dashStyle","displayValue","Infinity","display","lock","clear","TbLockFilled","dataPart","toChartData","opposite","o","initialRight","categories","newChart","addSeriesListener","onMouseOver","FieldWrapper","targetType","targetId","varType","varId","ControlPanel","codec","stateMap","VariableType","None","setState","selectOptions","Encoder","SimplePanel","metas","simple","getIndex","k","AnalyzePage","showChart","setShowChart","createControlState","kvs","entries","enc","c","labels","varName","useMemo","getSeries","offset","findIndex","w","imageView","metricsPanel","buttonPanel","iconButton","TbX","TbUpload","TbChartHistogram","TbDownload","PreviewBox","forwardRef","isDragging","onRemove","listitem","li","attrLine","filename","mime","PreviewList","Draggable","draggableId","provided","snapshot","draggableProps","dragHandleProps","innerRef","removeAt","copy","DragDropContext","onDragEnd","destination","remove","Droppable","droppableId","ol","list","droppableProps","placeholder","CompareFileDialog","onAccept","images","setImages","changed","imageWorker","isInvalid","right","fileDrop","uniqueId","actions","CompareConfigDialog","setOptions","CompareSession","measureOptions","resizeToFit","w0","h0","w1","builtinResize","dw","dh","canvasSource","drawDataToCanvas","clearRect","canvasDest","imageSmoothingEnabled","imageSmoothingQuality","Mode","__isSupport__","Sentry","dsn","integrations","tracesSampleRate","release","packageJson","createRoot","getElementById","render","Session","mode","setMode","setOpen","setResult","App"],"sourceRoot":""}